{"version":3,"sources":["angular-d3-charts.js"],"names":["angular","module","directive","$log","d3Helpers","svgHelpers","barHelpers","barDefaults","restrict","replace","scope","options","data","template","controller","$scope","info","link","element","attrs","jQuery","container","type","classPrefix","isDefined","setDefaults","id","setSize","setXScale","setYScale","zoom","addZoomBehaviour","zoomBehaviour","addSVG","get","width","containerWidth","height","containerHeight","addAxis","updateStyles","$watch","updateData","error","x","orient","addOneAxis","pieHelpers","pieDefaults","w","margin","left","right","legend","show","size","svg","attr","addArc","lineHelpers","lineDefaults","factory","isEmpty","value","Object","keys","length","isUndefinedOrEmpty","isUndefined","isNumber","isString","isArray","isObject","isFunction","equals","o1","o2","safeApply","fn","phase","$root","$$phase","$eval","$apply","getCommonDefaults","idKey","heigth","top","bottom","gap","timeFormat","fontFamily","fontSize","tooltipSize","axis","stroke","color","label","fontWeight","showDefaultData","locale","animations","time","ease","d3","easeCubic","newDefaults","userDefaults","this","colorKey","extend","h","isNaN","css","setColors","userColors","defaultColors","colors","scaleOrdinal","schemePaired","range","getDataFromScope","defaultData","getRandomString","chars","string_length","randomstring","i","rnum","Math","floor","random","substring","getRandomColor","r","g","b","rgb","obtainEffectiveChartId","d","chartId","hasOwnProperty","tree","defaults","getDefaults","scopeId","barId","getCreationDefaults","commonDefaults","series","bar","path","subcolors","colorInterpolator","tickFormat","tickSize","position","key","ticks","tickSubdivide","y","scale","direction","minFromZero","guidePosition","showValues","valuesColor","showPercent","percentColor","tooltip","pieId","pie","radius","borderColor","pieAnimation","lineId","addXAxis","addYAxis","addSubdivideTicks","yl","yAxis","ylTopOffset","guide","append","xlLeftOffset","style","scaleBand","xAxis","warn","domain","map","rangeRound","paddingInner","scaleLog","clamp","scaleSqrt","scaleTime","scaleLinear","dy","round","log","LN10","multi","getMilliseconds","getSeconds","getMinutes","getHours","getDay","getDate","getMonth","_idFunction","debug","formatTime","mapFunction","e","parentId","xl","call","totals","max","v","Date","parse","push","min","undefined","abs","nice","yMaxPoints","x0","bandwidth","barsContainer","select","empty","idClip","updateBars","bars","update","transition","duration","attrTween","a","percentH","trans","inp","interpolateString","t","selectAll","darker","parentNode","percentW","format","fill","styleTween","brighter","returnColor","interpolateRgb","remove","text","barGroups","each","barGroup","enter","exit","interrupt","findNeighborArc","data0","data1","obj","m","k","j","findPreceding","copy","startAngle","endAngle","n","findFollowing","pathAnim","dir","easeBounce","arc","outerRadius","midAngle","outerArc","innerRadius","sort","filter","arcTween","$this","start","PI","_current","interpolate","_tweenPie","removeTooltip","lines","onTooltip","d2","pos","centroid","html","wrap","slices","dataSlices","pieData","arcs","on","narc","_previous","idx","previous","interpolateObject","setStyles","createLegend","percentFormat","total","sum","items","item","currentX","currentY","iy","oldY","oldX","clientRect","node","getBoundingClientRect","legendRect","wrapLabels","rect","behavior","scaleExtent","classed","word","words","split","reverse","line","lineNumber","parseFloat","dx","tspan","pop","join","getComputedTextLength","getTranslation","transform","document","createElementNS","setAttributeNS","matrix","baseVal","consolidate","f"],"mappings":"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","file":"angular-d3-charts.min.js","sourcesContent":["(function() {\n\n\"use strict\";\n\nangular.module('angular-d3-charts', []).directive('a3bar', function ($log, d3Helpers, svgHelpers, barHelpers, barDefaults) {\n\treturn {\n\t\trestrict: 'EA',\n\t\treplace: true,\n\t\tscope: {\n\t\t\toptions: '=options',\n\t\t\tdata: '=data'\n\t\t},\n\t\ttemplate: '<div class=\"angular-a3bar\"></div>',\n\t\tcontroller: function($scope) {\n\t\t\t$log.info('[Angular - D3] Bar scope controller', $scope);\n\t\t},\n\t\tlink: function(scope, element, attrs) {\n\t\t\tif(!jQuery) {\n\t\t\t\t$log.error('JQuery is not loaded');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.container = element;\n\t\t\tscope.type = 'bar';\n\t\t\tscope.classPrefix = 'a3bar';\n\t\t\tvar isDefined = d3Helpers.isDefined,\n\t\t\t\toptions = barDefaults.setDefaults(scope.options, attrs.id);\n\n\t\t\td3Helpers.setSize(element, options, attrs);\n\n\t\t\tbarHelpers.setXScale(scope, options);\n\t\t\tbarHelpers.setYScale(scope, options);\n\t\t\tif(isDefined(options.zoom) && options.zoom) {\n\t\t\t\tsvgHelpers.addZoomBehaviour(scope, barHelpers.zoomBehaviour);\n\t\t\t}\n\t\t\tsvgHelpers.addSVG(scope, element.get(0), options);\n\n\t\t\telement.width(options.containerWidth);\n\t\t\telement.height(options.containerHeight);\n\n\t\t\tbarHelpers.addAxis(scope, options);\n\t\t\tsvgHelpers.updateStyles(scope, options);\n\n\t\t\tscope.$watch('data', function() {\n\t\t\t\tbarHelpers.updateData(scope, options);\n\t\t\t});\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').directive('a3oabar', function ($log, d3Helpers, svgHelpers, barHelpers, barDefaults) {\n\treturn {\n\t\trestrict: 'EA',\n\t\treplace: true,\n\t\tscope: {\n\t\t\toptions: '=options',\n\t\t\tdata: '=data'\n\t\t},\n\t\ttemplate: '<div class=\"angular-a3oabar\"></div>',\n\t\tcontroller: function($scope) {\n\t\t\t$log.info('[Angular - D3] One Axis Bar scope controller', $scope);\n\t\t},\n\t\tlink: function(scope, element, attrs) {\n\t\t\tif(!jQuery) {\n\t\t\t\t$log.error('JQuery is not loaded');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.container = element;\n\t\t\tscope.type = 'oneAxisBar';\n\t\t\tscope.classPrefix = 'a3oabar';\n\t\t\tvar isDefined = d3Helpers.isDefined,\n\t\t\t\toptions = barDefaults.setDefaults(scope.options, attrs.id);\n\n\t\t\td3Helpers.setSize(element, options, attrs);\n\n\t\t\t// Orient option disabled for this chart.\n\t\t\toptions.x.orient = 'axisBottom';\n\n\t\t\tbarHelpers.setXScale(scope, options);\n\t\t\tbarHelpers.setYScale(scope, options);\n\t\t\tif(isDefined(options.zoom) && options.zoom) {\n\t\t\t\tsvgHelpers.addZoomBehaviour(scope, barHelpers.zoomBehaviour);\n\t\t\t}\n\t\t\tsvgHelpers.addSVG(scope, element.get(0), options);\n\n\t\t\telement.width(options.containerWidth);\n\t\t\telement.height(options.containerHeight);\n\n\t\t\tbarHelpers.addOneAxis(scope, options);\n\t\t\tsvgHelpers.updateStyles(scope, options);\n\n\t\t\tscope.$watch('data', function() {\n\t\t\t\tbarHelpers.updateData(scope, options);\n\t\t\t});\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').directive('a3pie', function ($log, d3Helpers, svgHelpers, pieHelpers, pieDefaults) {\n\treturn {\n\t\trestrict: 'EA',\n\t\treplace: true,\n\t\tscope: {\n\t\t\toptions: '=options',\n\t\t\tdata: '=data'\n\t\t},\n\t\ttemplate: '<div class=\"angular-a3pie\"></div>',\n\t\tcontroller: function($scope) {\n\t\t\t$log.info('[Angular - D3] Pie scope controller', $scope);\n\t\t},\n\t\tlink: function(scope, element, attrs) {\n\t\t\tif(!jQuery) {\n\t\t\t\t$log.error('JQuery is not loaded');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.container = element;\n\t\t\tscope.type = 'pie';\n\t\t\tscope.classPrefix = 'a3pie';\n\t\t\tvar options = pieDefaults.setDefaults(scope.options, attrs.id);\n\n\t\t\td3Helpers.setSize(element, options, attrs);\n\n\t\t\tsvgHelpers.addSVG(scope, element.get(0), options);\n\t\t\tvar w = options.width + options.margin.left + options.margin.right;\n\t\t\tw -= options.legend.show && options.legend.type === 'vertical'? options.legend.size:0;\n\t\t\tscope.svg.attr('transform', 'translate(' + w / 2 + ',' + options.height / 2 + ')');\n\n\t\t\tpieHelpers.addArc(scope, options);\n\t\t\t//svgHelpers.updateStyles(scope, options);\n\n\t\t\t//pieHelpers.updateData(scope, options);\n\n\t\t\tscope.$watch('data', function() {\n\t\t\t\tpieHelpers.updateData(scope, options);\n\t\t\t});\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').directive('a3line', function ($log, d3Helpers, svgHelpers, lineHelpers, lineDefaults) {\n\treturn {\n\t\trestrict: 'EA',\n\t\treplace: true,\n\t\tscope: {\n\t\t\toptions: '=options',\n\t\t\tdata: '=data'\n\t\t},\n\t\ttemplate: '<div class=\"angular-a3line\"></div>',\n\t\tcontroller: function($scope) {\n\t\t\t$log.info('[Angular - D3] Line scope controller', $scope);\n\t\t},\n\t\tlink: function(scope, element, attrs) {\n\t\t\tif(!jQuery) {\n\t\t\t\t$log.error('JQuery is not loaded');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.container = element;\n\t\t\tscope.type = 'line';\n\t\t\tscope.classPrefix = 'a3line';\n\n\t\t\tvar options = lineDefaults.setDefaults(scope.options, attrs.id);\n\n\t\t\td3Helpers.setSize(element, options, attrs);\n\n\t\t\tsvgHelpers.addSVG(scope, element.get(0), options);\n\n\t\t\telement.width(options.containerWidth);\n\t\t\telement.height(options.containerHeight);\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('d3Helpers', function ($log) {\n\tfunction _obtainEffectiveChartId(d, chartId) {\n\t\tvar id, i;\n\t\tif (!angular.isDefined(chartId)) {\n\t\t\tif (Object.keys(d).length === 1) {\n\t\t\t\tfor (i in d) {\n\t\t\t\t\tif (d.hasOwnProperty(i)) {\n\t\t\t\t\t\tid = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (Object.keys(d).length === 0) {\n\t\t\t\tid = 'main';\n\t\t\t} else {\n\t\t\t\t$log.error('[AngularJS - D3] - You have more than 1 object on the DOM, you must provide the object ID');\n\t\t\t}\n\t\t} else {\n\t\t\tid = chartId;\n\t\t}\n\n\t\treturn id;\n\t}\n\n\tfunction _getCommonDefaults() {\n\t\treturn {\n\t\t\tidKey: 'id',\n\t\t\twidth: 300,\n\t\t\theigth: 250,\n\t\t\tzoom: true,\n\t\t\tmargin: {\n\t\t\t\tleft: 10,\n\t\t\t\tright: 10,\n\t\t\t\ttop: 10,\n\t\t\t\tbottom: 10\n\t\t\t},\n\t\t\tlegend: {\n\t\t\t\tshow: true,\n\t\t\t\tsize: 120,\n\t\t\t\ttype: 'vertical',\n\t\t\t\tgap: 20\n\t\t\t},\n\t\t\ttimeFormat: '%d-%m-%Y',\n\t\t\tfontFamily: 'Arial',\n\t\t\tfontSize: '0.75em',\n\t\t\ttooltipSize: 120,\n\t\t\taxis: {\n\t\t\t\tshow: true,\n\t\t\t\tstroke: '#000',\n\t\t\t\tcolor: '#000',\n\t\t\t\tlabel: {\n\t\t\t\t\tcolor: '#000',\n\t\t\t\t\tfontWeight: 'bold'\n\t\t\t\t},\n\t\t\t\tfontWeight: 'normal'\n\t\t\t},\n\t\t\tshowDefaultData: true,\n\t\t\tlocale: null,\n\t\t\tanimations: {\n\t\t\t\ttime: 750,\n\t\t\t\tease: d3.easeCubic\n\t\t\t}\n\t\t};\n\t}\n\n\treturn {\n\t\t//Determine if a reference is {}\n\t\tisEmpty: function(value) {\n\t\t\treturn Object.keys(value).length === 0;\n\t\t},\n\n\t\t//Determine if a reference is undefined or {}\n\t\tisUndefinedOrEmpty: function (value) {\n\t\t\treturn (angular.isUndefined(value) || value === null) || Object.keys(value).length === 0;\n\t\t},\n\n\t\t// Determine if a reference is defined\n\t\tisDefined: function(value) {\n\t\t\treturn angular.isDefined(value) && value !== null;\n\t\t},\n\n\t\t// Determine if a reference is a number\n\t\tisNumber: function(value) {\n\t\t\treturn angular.isNumber(value);\n\t\t},\n\n\t\t// Determine if a reference is a string\n\t\tisString: function(value) {\n\t\t\treturn angular.isString(value);\n\t\t},\n\n\t\t// Determine if a reference is an array\n\t\tisArray: function(value) {\n\t\t\treturn angular.isArray(value);\n\t\t},\n\n\t\t// Determine if a reference is an object\n\t\tisObject: function(value) {\n\t\t\treturn angular.isObject(value);\n\t\t},\n\n\t\t// Determine if a reference is a function.\n\t\tisFunction: function(value) {\n\t\t\treturn angular.isFunction(value);\n\t\t},\n\n\t\t// Determine if two objects have the same properties\n\t\tequals: function(o1, o2) {\n\t\t\treturn angular.equals(o1, o2);\n\t\t},\n\n\t\tsafeApply: function($scope, fn) {\n\t\t\tvar phase = $scope.$root.$$phase;\n\t\t\tif (phase === '$apply' || phase === '$digest') {\n\t\t\t\t$scope.$eval(fn);\n\t\t\t} else {\n\t\t\t\t$scope.$apply(fn);\n\t\t\t}\n\t\t},\n\n\t\tgetCommonDefaults: _getCommonDefaults,\n\n\t\tsetDefaults: function(newDefaults, userDefaults) {\n\t\t\tif (this.isDefined(userDefaults)) {\n\t\t\t\tnewDefaults.idKey = this.isDefined(userDefaults.idKey) ?  userDefaults.idKey : newDefaults.idKey;\n\t\t\t\tnewDefaults.colorKey = this.isDefined(userDefaults.colorKey) ?  userDefaults.colorKey : newDefaults.colorKey;\n\t\t\t\tnewDefaults.width = this.isDefined(userDefaults.width) ?  userDefaults.width : newDefaults.width;\n\t\t\t\tnewDefaults.heigth = this.isDefined(userDefaults.heigth) ?  userDefaults.heigth : newDefaults.heigth;\n\t\t\t\tnewDefaults.zoom = this.isDefined(userDefaults.zoom) ?  userDefaults.zoom : newDefaults.zoom;\n\t\t\t\tnewDefaults.timeFormat = this.isDefined(userDefaults.timeFormat) ?  userDefaults.timeFormat : newDefaults.timeFormat;\n\t\t\t\tnewDefaults.fontFamily = this.isDefined(userDefaults.fontFamily) ?  userDefaults.fontFamily : newDefaults.fontFamily;\n\t\t\t\tnewDefaults.fontSize = this.isDefined(userDefaults.fontSize) ?  userDefaults.fontSize : newDefaults.fontSize;\n\t\t\t\tnewDefaults.tooltipSize = this.isDefined(userDefaults.tooltipSize) ?  userDefaults.tooltipSize : newDefaults.tooltipSize;\n\t\t\t\tnewDefaults.showDefaultData = this.isDefined(userDefaults.showDefaultData) ?  userDefaults.showDefaultData : newDefaults.showDefaultData;\n\t\t\t\tnewDefaults.locale = this.isDefined(userDefaults.locale) ?  userDefaults.locale : newDefaults.locale;\n\n\t\t\t\tif(this.isDefined(userDefaults.margin)) {\n\t\t\t\t\tangular.extend(newDefaults.margin, userDefaults.margin);\n\t\t\t\t}\n\t\t\t\tif(this.isDefined(userDefaults.legend)) {\n\t\t\t\t\tangular.extend(newDefaults.legend, userDefaults.legend);\n\t\t\t\t}\n\n\t\t\t\tif(this.isDefined(userDefaults.axis)) {\n\t\t\t\t\tangular.extend(newDefaults.axis, userDefaults.axis);\n\t\t\t\t}\n\n\t\t\t\tif(this.isDefined(userDefaults.animations)) {\n\t\t\t\t\tangular.extend(newDefaults.animations, userDefaults.animations);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tsetSize: function(element, options, attrs) {\n\t\t\t// Set width and height if they are defined\n\t\t\tvar w = this.isDefined(attrs.width)? attrs.width:options.width,\n\t\t\t\th = this.isDefined(attrs.height)? attrs.height:options.height;\n\n\t\t\tif (isNaN(w)) {\n\t\t\t\telement.css('width', w);\n\t\t\t} else {\n\t\t\t\telement.css('width', w + 'px');\n\t\t\t}\n\n\t\t\tif (isNaN(h)) {\n\t\t\t\telement.css('height', h);\n\t\t\t} else {\n\t\t\t\telement.css('height', h + 'px');\n\t\t\t}\n\n\t\t\toptions.width = element.width();\n\t\t\toptions.height = element.height();\n\t\t},\n\n\t\tsetColors: function(userColors, defaultColors) {\n\t\t\tvar colors = defaultColors || d3.scaleOrdinal(d3.schemePaired);\n\t\t\tif(this.isDefined(userColors)) {\n\t\t\t\tcolors = this.isArray(userColors)? d3.scaleOrdinal().range(userColors):colors;\n\t\t\t\tcolors = this.isString(userColors)? d3.scaleOrdinal().range([userColors]):colors;\n\t\t\t\tcolors = this.isFunction(userColors)? userColors:colors;\n\t\t\t}\n\t\t\treturn colors;\n\t\t},\n\n\t\tgetDataFromScope: function(scope, options) {\n\t\t\tvar data = null;\n\t\t\tif(this.isUndefinedOrEmpty(scope.data) && options.showDefaultData &&\n\t\t\t\t!this.isUndefinedOrEmpty(options.defaultData)) {\n\t\t\t\tdata = options.defaultData;\n\t\t\t} else if(this.isString(scope.data)) {\n\n\t\t\t} else {\n\t\t\t\tdata = scope.data;\n\t\t\t}\n\t\t\treturn data;\n\t\t},\n\n\t\tgetRandomString: function(length) {\n\t\t\tvar chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz';\n\t\t\tvar string_length = length || 8;\n\t\t\tvar randomstring = '';\n\t\t\tfor (var i = 0; i < string_length; i++) {\n\t\t\t\tvar rnum = Math.floor(Math.random() * chars.length);\n\t\t\t\trandomstring += chars.substring(rnum, rnum+1);\n\t\t\t}\n\t\t\treturn randomstring;\n    },\n\n    getRandomColor: function() {\n\t\t\t// random values between 0 and 255, these are the 3 colour values\n\t\t\tvar r = Math.floor(Math.random()*256);\n\t\t\tvar g = Math.floor(Math.random()*256);\n\t\t\tvar b = Math.floor(Math.random()*256);\n\n\t\t\t// puts the hex value inside this element (e is a jquery object)\n\t\t\treturn d3.rgb(r,g,b);\n\t\t},\n\n\t\tobtainEffectiveChartId: _obtainEffectiveChartId\n\t};\n});\n\nangular.module('angular-d3-charts').factory('iconHelpers', function () {\r\n\treturn {\r\n\t\ttree:\r\n\t\t\t'm 101.56082,48.552288 c -0.88364,1.27999 -1.603384,1.357043 -1.562119,2.826786 0.119189,0.64172 0.977609,0.392162 1.562119,0.471514 -0.0333,0.66932 -0.0665,1.33634 0.38968,1.414543 -1.161,1.423742 -2.082459,3.140743 -3.903601,3.769812 -0.119195,1.472044 1.12661,-1.198336 1.170161,0.471515 -0.406863,1.233987 -1.23778,1.959658 -1.952943,2.827935 0.978764,1.02008 3.413063,0.279458 3.515063,2.356419 -2.258944,-0.36916 -3.338565,0.684272 -5.468005,0.470364 1.844064,2.005661 -0.857278,2.099964 0,4.242478 -0.382796,0.760173 -1.041799,1.083332 -1.562127,0.471514 0.248703,1.028132 -1.10598,1.499646 0.389673,1.413393 -1.12088,0.35651 -2.484731,2.260967 -3.124251,0.471515 -0.5868,3.530605 -3.027979,4.827843 -5.856537,5.654718 1.218297,1.723902 0.324344,2.316169 0,4.713992 -1.350098,-0.372612 -1.648082,0.524416 -2.342615,0.943028 0.46646,0.680821 1.923145,0.714171 0.389672,1.413393 0.08939,0.600318 1.167869,0.616418 1.173599,0 1.132341,1.247787 -1.445223,1.99991 -2.73687,1.884906 -1.123172,-3.471954 -3.542575,0.549717 -4.684084,1.414542 -2.230298,-2.450723 -6.107531,-0.125354 -7.80948,2.355271 -0.991372,-0.247258 -2.82512,-0.661269 -1.954089,0.471514 -0.375918,1.167284 -1.500237,-0.648619 -2.732286,0 0.467605,-0.618719 0.152429,-0.741772 0,-1.413392 -2.525991,1.966558 -3.633117,2.903837 -7.030138,1.413392 -0.79195,0.957979 -1.810827,1.304139 -1.170161,2.827935 -0.61889,0.04025 -1.492214,-0.226557 -1.560979,0.471514 -1.128902,-0.211606 -0.924897,-2.028661 -1.954089,-2.356421 -0.456146,7.30157 -2.178724,20.025552 3.90474,22.623472 4.99009,2.13102 12.584104,-1.49159 16.79256,2.82679 -14.971418,0 -29.939397,0 -44.909668,0 0.116901,-0.95798 0.781635,-1.25468 1.171307,-1.88491 5.748804,-1.38693 10.138342,0.37491 13.668309,-1.41338 4.826199,-2.44612 3.203331,-16.080939 1.170162,-21.680458 -2.269265,-1.474345 -3.32711,-4.01477 -6.247356,-2.357571 0.166184,-0.984429 -0.268185,-1.247787 -0.390818,-1.884906 -4.370053,0.923479 -6.35394,-1.949309 -11.716512,-1.887207 0.161599,-1.133934 -0.71287,-1.02353 -0.390817,-2.356421 -1.542643,-0.753271 -4.592397,1.529547 -6.638174,-0.470363 2.143196,-1.411093 -1.711117,-0.30706 -0.390817,-1.887207 -1.329469,0.828024 -1.454393,-0.150654 -1.951797,-1.413392 -1.22632,0.729122 -2.177578,0.301309 -3.124251,-0.471513 0.207443,-0.379512 0.406864,-0.765924 0.390817,-1.413394 -0.710578,0.100053 -1.421155,-1.02123 -3.125395,-0.943027 -0.649835,-0.936128 0.03553,-0.599169 0,-1.884907 -2.3437613,0.103502 -0.838941,1.444442 -3.1242509,0 0.2028585,-0.695771 0.5787771,-1.186836 0.7816356,-1.886057 -0.6314974,0.809625 -1.6343292,1.171886 -3.1242505,0.943029 0.2028585,-2.196566 1.1518238,-2.086163 0,-3.770964 1.9449205,0.675071 1.2412191,0.392162 0.7804896,-1.413391 0.7014092,-0.0598 0.824041,0.577317 1.5621253,0.471513 C 7.1651335,64.353762 4.4557688,61.621281 6.6631446,59.386763 5.0425687,59.348813 4.4798368,57.975672 2.7584045,57.030343 3.1515145,56.404724 3.1274466,55.27654 3.9297119,55.144287 3.7085159,54.704974 2.8443616,54.431265 3.5388941,54.202408 c -0.2567249,-1.413392 -0.835502,0.451964 -1.5621252,0 0.221196,-1.148885 0.3346593,-2.424272 1.5621252,-2.357571 -0.4389537,-1.354739 -0.8206028,-2.780782 -1.5621252,-3.769811 0.075642,1.060331 -0.1615992,1.085631 0,2.827934 -2.04692278,0.05405 0.085957,-2.202317 -1.95179703,-2.356421 C 0.81348409,47.110145 -0.47014047,46.095816 0.41922798,44.781326 1.622626,44.429415 0.89485677,46.407474 2.371025,45.724354 2.9119811,45.193038 1.5469838,42.973472 1.5905355,41.483027 3.4598137,42.89872 3.7853042,40.623952 3.5423323,38.184728 5.4631849,37.357853 6.1806393,35.083085 8.2287082,34.413766 7.920409,33.941101 6.8637109,34.589721 6.2757651,33.471887 6.8442274,27.875819 9.3495874,25.063986 11.743777,20.745606 c 0.22578,2.141363 2.386166,0.901627 2.34376,2.356421 1.250389,-0.915427 1.747793,-1.346691 3.513922,-2.356421 -0.881345,1.820504 0.664735,1.932057 2.342615,1.887207 0.649835,0.934978 -0.03438,0.599168 0,1.884905 2.100789,-0.67852 3.111644,-0.555466 5.077193,-1.884905 -0.355287,-1.711252 -1.152969,-0.288659 -2.343759,-0.471514 0.606282,-1.182237 1.585046,-1.578998 0.782781,-3.300599 2.67842,0.02645 1.131195,-1.720452 1.560978,-2.827935 2.158095,0.0713 1.391358,1.216735 3.125398,0 -0.257872,-1.411093 -0.835502,0.450813 -1.563271,0 0.720892,-2.66463 0.605137,-3.408703 1.563271,-5.65472 2.644037,0.302458 4.757433,-1.6986009 5.466865,0.940728 0.127216,-1.7929037 2.577563,-2.5542265 3.513922,-1.8849063 0.354143,-1.1776354 3.234276,-3.6881606 3.513923,-1.8860567 0.881345,-0.3519105 0.153575,-2.6427792 0.390817,-3.7709629 0.676195,-1.2247868 3.222815,-0.1943559 3.124251,-2.3552706 1.045237,0.4657638 2.059529,0.970629 3.515068,0.9430282 -0.09053,1.8044041 0.720893,2.0643118 0.390818,3.2982988 0.312884,0.2058562 1.605677,0.6026181 2.342616,0 -1.594217,-2.4829244 1.054405,0.3082092 0,-2.8290847 1.465852,0.3576606 1.321444,-1.232837 1.951796,-1.88490656 1.426887,0.96832896 1.753523,-0.21275637 2.734579,-0.94302826 2.28531,2.86128582 3.982674,0.44851345 6.638173,1.88720652 0.216611,0.1173035 -1.014294,0.7912239 -1.170162,0.4715142 1.110565,2.2839684 5.575744,2.0562616 6.247355,5.1832053 0.954696,-1.1592346 1.693926,0.3496106 3.125396,0 0.108879,0.7613229 -0.369042,0.8119244 -0.391964,1.4133925 2.011394,-1.0246808 1.355829,1.1350845 3.515069,0.9430282 -0.168476,0.7406213 -1.228612,0.4025113 -0.781636,1.8849063 0.344974,0.371461 2.656644,-0.08166 2.733433,1.886057 1.611407,0.08395 1.160992,-1.591649 1.563271,-1.886057 0.397695,3.207446 4.105307,2.404722 5.46572,5.185506 1.05899,-0.584217 0.971887,-1.820505 2.344906,-0.943029 -2.052652,2.232218 1.596509,5.055551 2.341469,8.013441 -0.31403,-0.250708 -0.63379,-0.491065 -1.170161,-0.471515 1.951797,1.871106 -0.985641,4.271229 2.343761,4.713992 0.578777,-0.207007 -0.155869,-0.603768 0,-1.414542 1.33176,-0.351911 0.495113,1.914807 1.950651,1.414542 -1.313423,4.180375 0.330075,8.257247 1.954089,11.311738 -1.410841,-1.107482 -2.162679,-0.608368 -3.125397,0.941879 1.658397,1.336341 3.762625,1.772203 5.46572,0 -0.824042,1.883757 2.371267,-0.359961 2.735725,1.887207 0.882492,-0.263358 -0.473337,-0.736023 0.389671,-1.414542 1.133486,1.461694 1.550665,3.784763 3.124251,4.713989 -0.33007,1.381193 -1.257265,-0.280607 -1.951798,0 0.09512,0.829176 0.672758,1.074134 1.562118,0.940729 -0.755267,1.170736 0.38166,1.680201 -0.781627,2.358722 0.865307,1.754952 1.044087,-1.199487 2.341467,-0.474966 z M 6.6665829,50.908709 c -0.010314,1.245487 0.3644576,2.95444 -1.1701614,2.357572 -0.2693319,1.266188 0.8068499,0.910827 1.1701614,1.413392 0.033236,-2.672681 1.5162815,-1.179936 3.1253966,-2.829085 -1.4899214,0.604918 -1.2079825,-2.254067 -1.1713074,-0.941879 -0.331221,1.382342 -1.2584105,-0.281758 -1.9540892,0 z'\r\n\t};\r\n});\r\n\nangular.module('angular-d3-charts').factory('barDefaults', function (d3Helpers) {\n\tfunction _getDefaults() {\n\t\tvar commonDefaults = d3Helpers.getCommonDefaults();\n\t\tangular.extend(commonDefaults, {\n\t\t\tseries: ['A', 'B', 'C', 'D'],\n\t\t\tbar: {\n\t\t\t\tgap: 0.2,\n\t\t\t\tpath: null,\n\t\t\t\tcolors: d3.scaleOrdinal(d3.schemePaired),\n\t\t\t\tsubcolors: null,\n\t\t\t\t// Possible Values [d3.interpolateRgb, d3.interpolateHsl, d3.interpolateLab, d3.interpolateHcl]\n\t\t\t\tcolorInterpolator: null\n\t\t\t},\n\t\t\tx: {\n\t\t\t\ttickFormat: null,\n\t\t\t\ttickSize: 6,\n\t\t\t\torient: 'axisBottom',\n\t\t\t\tposition: 'bottom',\n\t\t\t\tkey: 'x',\n\t\t\t\tlabel: 'x',\n\t\t\t\tticks: 5,\n\t\t\t\ttickSubdivide: 4\n\t\t\t},\n\t\t\ty: {\n\t\t\t\tscale: 'linear',\n\t\t\t\ttickFormat: null,\n\t\t\t\ttickSize: 6,\n\t\t\t\torient: 'axisLeft',\n\t\t\t\tposition: 'left',\n\t\t\t\t// Possible Values ['ttb', 'btt'] => ['top to bottom', 'bottom to top']\n\t\t\t\tdirection: 'ttb',\n\t\t\t\tkey: 'y',\n\t\t\t\tlabel: 'y',\n\t\t\t\tticks: 5,\n\t\t\t\ttickSubdivide: 4,\n\t\t\t\tminFromZero: true\n\t\t\t},\n\t\t\taxis: {\n\t\t\t\t// Possible Values ['bottom', 'top']\n\t\t\t\tguidePosition: 'top',\n\t\t\t\tshowValues: true,\n\t\t\t\tvaluesColor: '#000',\n\t\t\t\tshowPercent: true,\n\t\t\t\tpercentColor: '#000',\n\t\t\t\tlabel: {\n\t\t\t\t\tcolor: '#000',\n\t\t\t\t\tfontWeight: 'bold'\n\t\t\t\t},\n\t\t\t\tshow: true\n\t\t\t},\n\t\t\tdefaultData: [{\n\t\t\t\tid: 1,\n\t\t\t\tx: 'Fruits',\n\t\t\t\ty: [ 54, 0, 879 ],\n\t\t\t\ttooltip: 'Fruits tooltip'\n\t\t\t}, {\n\t\t\t\tid: 2,\n\t\t\t\tx: 'Vegetables',\n\t\t\t\ty: [ 12, 34, 15 ],\n\t\t\t\ttooltip: 'Vegetables tooltip'\n\t\t\t}, {\n\t\t\t\tid: 3,\n\t\t\t\tx: 'Meet',\n\t\t\t\ty: [ 154, 432, 234 ],\n\t\t\t\ttooltip: 'Meet tooltip'\n\t\t\t}]\n\t\t});\n\t\treturn commonDefaults;\n\t}\n\n\tvar isDefined = d3Helpers.isDefined,\n\t\tobtainEffectiveChartId = d3Helpers.obtainEffectiveChartId,\n\t\tdefaults = {};\n\n\treturn {\n\t\tgetDefaults: function (scopeId) {\n\t\t\tvar barId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\treturn defaults[barId];\n\t\t},\n\n\t\tgetCreationDefaults: function (scopeId) {\n\t\t\tvar d = this.getDefaults(scopeId);\n\n\t\t\tvar barDefaults = {};\n\t\t\tangular.extend(barDefaults, d);\n\t\t\treturn barDefaults;\n\t\t},\n\n\t\tsetDefaults: function(userDefaults, scopeId) {\n\t\t\tvar newDefaults = _getDefaults();\n\n\t\t\tif (isDefined(userDefaults)) {\n\t\t\t\td3Helpers.setDefaults(newDefaults, userDefaults);\n\n\t\t\t\tif(isDefined(userDefaults.bar)) {\n\t\t\t\t\tangular.extend(newDefaults.bar, userDefaults.bar);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.x)) {\n\t\t\t\t\tangular.extend(newDefaults.x, userDefaults.x);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.y)) {\n\t\t\t\t\tangular.extend(newDefaults.y, userDefaults.y);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(newDefaults.defaultData)) {\n\t\t\t\t\tangular.extend(newDefaults.defaultData, newDefaults.defaultData);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar barId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\tdefaults[barId] = newDefaults;\n\t\t\treturn newDefaults;\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('pieDefaults', function (d3Helpers) {\n\tfunction _getDefaults() {\n\t\tvar commonDefaults = d3Helpers.getCommonDefaults();\n\t\tangular.extend(commonDefaults, {\n\t\t\tpie: {\n\t\t\t\tcolors: d3.scaleOrdinal(d3.schemePaired)\n\t\t\t},\n\t\t\tradius: 0,\n\t\t\tx: {\n\t\t\t\tkey: 'x',\n\t\t\t\tlabel: 'x',\n\t\t\t\tshow: true\n\t\t\t},\n\t\t\ty: {\n\t\t\t\tkey: 'y',\n\t\t\t\tlabel: 'y'\n\t\t\t},\n\t\t\tdefaultData: [{\n\t\t\t\tid: 1,\n\t\t\t\tx: 'Fruits',\n\t\t\t\ty: 54,\n\t\t\t\ttooltip: 'Fruits tooltip'\n\t\t\t}, {\n\t\t\t\tid: 2,\n\t\t\t\tx: 'Vegetables',\n\t\t\t\ty: 23,\n\t\t\t\ttooltip: 'Vegetables tooltip'\n\t\t\t}, {\n\t\t\t\tid: 3,\n\t\t\t\tx: 'Meet',\n\t\t\t\ty: 41,\n\t\t\t\ttooltip: 'Meet tooltip'\n\t\t\t}],\n\t\t\tshowPercent: false,\n\t\t\tborderColor: '#FFF',\n\t\t\tpieAnimation: 'normal'\n\t\t});\n\t\treturn commonDefaults;\n\t}\n\n\tvar isDefined = d3Helpers.isDefined,\n\t\tobtainEffectiveChartId = d3Helpers.obtainEffectiveChartId,\n\t\tdefaults = {};\n\n\treturn {\n\t\tgetDefaults: function (scopeId) {\n\t\t\tvar pieId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\treturn defaults[pieId];\n\t\t},\n\n\t\tgetCreationDefaults: function (scopeId) {\n\t\t\tvar d = this.getDefaults(scopeId);\n\n\t\t\tvar pieDefaults = {};\n\t\t\tangular.extend(pieDefaults, d);\n\t\t\treturn pieDefaults;\n\t\t},\n\n\t\tsetDefaults: function(userDefaults, scopeId) {\n\t\t\tvar newDefaults = _getDefaults();\n\n\t\t\tif (isDefined(userDefaults)) {\n\t\t\t\td3Helpers.setDefaults(newDefaults, userDefaults);\n\n\t\t\t\tnewDefaults.radius = d3Helpers.isDefined(userDefaults.radius)?  userDefaults.radius:newDefaults.radius;\n\t\t\t\tnewDefaults.showPercent = d3Helpers.isDefined(userDefaults.showPercent)?  userDefaults.showPercent:newDefaults.showPercent;\n\t\t\t\tnewDefaults.borderColor = d3Helpers.isDefined(userDefaults.borderColor)?  userDefaults.borderColor:newDefaults.borderColor;\n\t\t\t\tnewDefaults.pieAnimation = d3Helpers.isDefined(userDefaults.pieAnimation)?  userDefaults.pieAnimation:newDefaults.pieAnimation;\n\n\t\t\t\tif(isDefined(userDefaults.pie)) {\n\t\t\t\t\tangular.extend(newDefaults.pie, userDefaults.pie);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.x)) {\n\t\t\t\t\tangular.extend(newDefaults.x, userDefaults.x);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.y)) {\n\t\t\t\t\tangular.extend(newDefaults.y, userDefaults.y);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(newDefaults.defaultData)) {\n\t\t\t\t\tangular.extend(newDefaults.defaultData, newDefaults.defaultData);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar pieId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\tdefaults[pieId] = newDefaults;\n\t\t\treturn newDefaults;\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('lineDefaults', function (d3Helpers) {\n\tfunction _getDefaults() {\n\t\tvar commonDefaults = d3Helpers.getCommonDefaults();\n\t\tangular.extend(commonDefaults, {\n\t\t\tseries: ['A', 'B', 'C', 'D'],\n\t\t\tx: {\n\t\t\t\tscale: 'linear',\n\t\t\t\ttickFormat: null,\n\t\t\t\ttickSize: 6,\n\t\t\t\torient: 'bottom',\n\t\t\t\tposition: 'bottom',\n\t\t\t\tkey: 'x',\n\t\t\t\tlabel: 'x',\n\t\t\t\tticks: 5,\n\t\t\t\ttickSubdivide: 4\n\t\t\t},\n\t\t\ty: {\n\t\t\t\tscale: 'linear',\n\t\t\t\ttickFormat: null,\n\t\t\t\ttickSize: 6,\n\t\t\t\torient: 'left',\n\t\t\t\tposition: 'left',\n\t\t\t\tkey: 'y',\n\t\t\t\tlabel: 'y',\n\t\t\t\tticks: 5,\n\t\t\t\ttickSubdivide: 4\n\t\t\t},\n\t\t\taxis: {\n\t\t\t\tvaluesColor: '#000',\n\t\t\t\tpercentColor: '#000',\n\t\t\t\tlabel: {\n\t\t\t\t\tcolor: '#000',\n\t\t\t\t\tfontWeight: 'bold'\n\t\t\t\t}\n\t\t\t},\n\t\t\tdefaultData: [{\n\t\t\t\tid: 1,\n\t\t\t\tx: 'Fruits',\n\t\t\t\ty: [ 54, 0, 879 ],\n\t\t\t\ttooltip: 'Fruits tooltip'\n\t\t\t}, {\n\t\t\t\tid: 2,\n\t\t\t\tx: 'Vegetables',\n\t\t\t\ty: [ 12, 34, 15 ],\n\t\t\t\ttooltip: 'Vegetables tooltip'\n\t\t\t}, {\n\t\t\t\tid: 3,\n\t\t\t\tx: 'Meet',\n\t\t\t\ty: [ 154, 432, 234 ],\n\t\t\t\ttooltip: 'Meet tooltip'\n\t\t\t}]\n\t\t});\n\t\treturn commonDefaults;\n\t}\n\n\tvar isDefined = d3Helpers.isDefined,\n\t\tobtainEffectiveChartId = d3Helpers.obtainEffectiveChartId,\n\t\tdefaults = {};\n\n\treturn {\n\t\tgetDefaults: function (scopeId) {\n\t\t\tvar lineId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\treturn defaults[lineId];\n\t\t},\n\n\t\tgetCreationDefaults: function (scopeId) {\n\t\t\tvar d = this.getDefaults(scopeId);\n\n\t\t\tvar lineDefaults = {};\n\t\t\tangular.extend(lineDefaults, d);\n\t\t\treturn lineDefaults;\n\t\t},\n\n\t\tsetDefaults: function(userDefaults, scopeId) {\n\t\t\tvar newDefaults = _getDefaults();\n\n\t\t\tif (isDefined(userDefaults)) {\n\t\t\t\td3Helpers.setDefaults(newDefaults, userDefaults);\n\n\t\t\t\tif(isDefined(userDefaults.x)) {\n\t\t\t\t\tangular.extend(newDefaults.x, userDefaults.x);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.y)) {\n\t\t\t\t\tangular.extend(newDefaults.y, userDefaults.y);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(newDefaults.defaultData)) {\n\t\t\t\t\tangular.extend(newDefaults.defaultData, newDefaults.defaultData);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar lineId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\tdefaults[lineId] = newDefaults;\n\t\t\treturn newDefaults;\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('barHelpers', function ($log, d3Helpers, svgHelpers) {\n\t/*\n\tvar wrap = function (text, width) {\n\t\ttext.each(function() {\n\t\t\tvar text = d3.select(this),\n\t\t\t\twords = text.text().split(/\\s+/).reverse(),\n\t\t\t\tword,\n\t\t\t\tline = [],\n\t\t\t\tlineNumber = 0,\n\t\t\t\tlineHeight = 1.1, // ems\n\t\t\t\ty = text.attr('y'),\n\t\t\t\tdy = parseFloat(text.attr('dy')),\n\t\t\t\ttspan = text.text(null).append('tspan').attr('x', 0).attr('y', y).attr('dy', dy + 'em');\n\t\t\twhile (word = words.pop()) {\n\t\t\t\tline.push(word);\n\t\t\t\ttspan.text(line.join(' '));\n\t\t\t\tif (tspan.node().getComputedTextLength() > width) {\n\t\t\t\t\tline.pop();\n\t\t\t\t\ttspan.text(line.join(' '));\n\t\t\t\t\tline = [word];\n\t\t\t\t\ttspan = text.append('tspan').attr('x', 0).attr('y', y).attr('dy', ++lineNumber * lineHeight + dy + 'em').text(word);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\t*/\n\n\treturn {\n\t\taddAxis: function(scope, options) {\n\t\t\tsvgHelpers.addXAxis(scope, options);\n\t\t\tsvgHelpers.addYAxis(scope, options);\n\t\t\tsvgHelpers.addSubdivideTicks(scope.yl, scope.y, scope.yAxis, options.y);\n\t\t},\n\n\t\taddOneAxis: function(scope, options) {\n\t\t\tsvgHelpers.addXAxis(scope, options);\n\t\t\tscope.ylTopOffset = options.x.position === 'top'? options.height*0.125:options.height*0.2;\n\n\t\t\tscope.guide = scope.svg.append('g')\n\t\t\t\t.attr('class', 'guide');\n\n\t\t\tvar guidePosition =\n\t\t\t\toptions.axis.guidePosition === 'bottom'? options.height*1:(scope.ylTopOffset - options.height*0.03);\n\t\t\tscope.guide\n\t\t\t\t.append('line')\n\t\t\t\t.attr('x1', scope.xlLeftOffset)\n\t\t\t\t.attr('x2', options.width + scope.xlLeftOffset)\n\t\t\t\t.attr('y1', guidePosition)\n\t\t\t\t.attr('y2', guidePosition)\n\t\t\t\t.style('stroke', '#BBB')\n\t\t\t\t.style('stroke-width', 1)\n\t\t\t\t.style('shape-rendering', 'crispEdges');\n\t\t},\n\n\t\tsetXScale: function(scope, options) {\n\t\t\tscope.x = d3.scaleBand();\n\t\t\tscope.x\n\t\t\t\t.range([0, options.width]);\n\n\t\t\tif(!d3Helpers.isDefined(scope.xAxis)) {\n\t\t\t\tif(!d3Helpers.isDefined(options.x.orient) || !d3Helpers.isString(options.x.orient) ||\n\t\t\t\t\t(options.x.orient !== 'axisBottom' && options.x.orient !== 'axisTop')) {\n\t\t\t\t\t$log.warn('[Angular - D3] Tick orient must be a string. Setting default value \"axisBottom\"');\n\t\t\t\t\toptions.x.orient = 'axisBottom';\n\t\t\t\t}\n\t\t\t\tscope.xAxis = d3[options.x.orient](scope.x);\n\t\t\t} else {\n\t\t\t\tscope.xAxis.scale(scope.x);\n\t\t\t}\n\n\t\t\tif(d3Helpers.isDefined(options.x.tickSize) && d3Helpers.isNumber(options.x.tickSize)) {\n\t\t\t\tscope.xAxis.tickSize(options.x.tickSize);\n\t\t\t} else {\n\t\t\t\t$log.warn('[Angular - D3] Ticksize must be a number. Setting default value 6');\n\t\t\t\toptions.x.tickSize = 6;\n\t\t\t\tscope.xAxis.tickSize(options.x.tickSize);\n\t\t\t}\n\n\t\t\tvar data  = d3Helpers.getDataFromScope(scope, options);\n\t\t\tscope.x\n\t\t\t\t.domain(data.map(function(d) { return d[options.x.key]; }))\n\t\t\t\t.rangeRound([0, options.width])\n\t\t\t\t.paddingInner(options.bar.gap);\n\t\t\tscope.xAxis.tickFormat(options.x.tickFormat);\n\t\t\tif(d3Helpers.isDefined(scope.data)) {\n\t\t\t\tthis.updateData(scope.data, options);\n\t\t\t}\n\t\t},\n\n\t\tsetYScale: function(scope, options) {\n\t\t\tswitch(options.y.scale) {\n\t\t\t\tcase 'log':\n\t\t\t\t\tscope.y = d3.scaleLog().clamp(true);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'sqrt':\n\t\t\t\t\tscope.y = d3.scaleSqrt();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'time':\n\t\t\t\t\tscope.y = d3.scaleTime();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif(options.y.scale !== 'linear') {\n\t\t\t\t\t\t$log.warn('[Angular - D3] Ticksize must be a string and [\"linear\", \"log\", \"time\", \"sqrt\"]. Setting default value \"linear\"');\n\t\t\t\t\t\toptions.y.scale = 'linear';\n\t\t\t\t\t}\n\t\t\t\t\tscope.y = d3.scaleLinear();\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvar dy = 0;\n\t\t\tif(scope.type === 'oneAxisBar') {\n\t\t\t\tdy = options.height*0.2;\n\n\t\t\t\tif(options.axis.guidePosition === 'bottom') {\n\t\t\t\t\tdy += options.height*0.05;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(options.y.direction === 'btt') {\n\t\t\t\tscope.y.range([options.height - dy, 0]);\n\t\t\t} else {\n\t\t\t\tscope.y.range([0, options.height - dy]);\n\t\t\t}\n\t\t\tif(!d3Helpers.isDefined(scope.yAxis)) {\n\t\t\t\tif(!d3Helpers.isDefined(options.y.orient) || !d3Helpers.isString(options.y.orient)) {\n\t\t\t\t\t$log.warn('[Angular - D3] Tick orient must be a string. Setting default value \"left\"');\n\t\t\t\t\toptions.y.orient = 'axisLeft';\n\t\t\t\t}\n\t\t\t\tscope.yAxis = d3[options.y.orient](scope.y);\n\t\t\t} else {\n\t\t\t\tscope.yAxis.scale(scope.y);\n\t\t\t}\n\n\t\t\tif(d3Helpers.isDefined(options.y.tickSize) && d3Helpers.isNumber(options.y.tickSize)) {\n\t\t\t\tscope.yAxis.tickSize(options.y.tickSize);\n\t\t\t} else {\n\t\t\t\t$log.warn('[Angular - D3] Ticksize must be a number. Setting default value 6');\n\t\t\t\toptions.y.tickSize = 6;\n\t\t\t\tscope.yAxis.tickSize(options.y.tickSize);\n\t\t\t}\n\n\t\t\tswitch(options.y.scale) {\n\t\t\t\tcase 'log':\n\t\t\t\t\tif(!d3Helpers.isDefined(options.y.tickFormat)) {\n\t\t\t\t\t\toptions.y.tickFormat = function(d) {\n\t\t\t\t\t\t\tvar base = d3.round(Math.log(d)/Math.LN10, 3);\n\t\t\t\t\t\t\treturn base%1 === 0? d:'';\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tscope.yAxis.ticks(options.y.ticks);\n\t\t\t\t\tscope.y.domain([0.1, 1000]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'time':\n\t\t\t\t\tif(!d3Helpers.isDefined(options.y.tickFormat)) {\n\t\t\t\t\t\tvar locale = d3Helpers.isDefined(options.locale)? options.locale.timeFormat:d3.timeFormat;\n\t\t\t\t\t\toptions.y.tickFormat = locale.multi([\n\t\t\t\t\t\t\t['.%L', function(d) { return d.getMilliseconds(); }],\n\t\t\t\t\t\t\t[':%S', function(d) { return d.getSeconds(); }],\n\t\t\t\t\t\t\t['%I:%M', function(d) { return d.getMinutes(); }],\n\t\t\t\t\t\t\t['%I %p', function(d) { return d.getHours(); }],\n\t\t\t\t\t\t\t['%a %d', function(d) { return d.getDay() && d.getDate() !== 1; }],\n\t\t\t\t\t\t\t['%b %d', function(d) { return d.getDate() !== 1; }],\n\t\t\t\t\t\t\t['%B', function(d) { return d.getMonth(); }],\n\t\t\t\t\t\t\t['%Y', function() { return true; }]\n\t\t\t\t\t\t]);\n\t\t\t\t\t}\n\t\t\t\t\tscope.yAxis.ticks(options.y.ticks);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tscope.yAxis.ticks(options.y.ticks + options.y.ticks * options.y.tickSubdivide);\n\t\t\t\t\tscope.y.domain([0, 100]);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tscope.yAxis.tickFormat(options.y.tickFormat);\n\t\t\tif(d3Helpers.isDefined(scope.data)) {\n\t\t\t\tthis.updateData(scope.data, options);\n\t\t\t}\n\t\t},\n\n\t\tzoomBehaviour: function() {\n\t\t},\n\n\t\tupdateData: function(scope, options) {\n\t\t\tif(!d3Helpers.isDefined(scope.x) || !d3Helpers.isDefined(scope.y)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar data = d3Helpers.getDataFromScope(scope, options);\n\t\t\tvar _idFunction = function(d) {\n\t\t\t\treturn d[options.idKey];\n\t\t\t};\n\t\t\tif(d3Helpers.isUndefinedOrEmpty(data)) {\n\t\t\t\t$log.warn('[Angular - D3] No data for bars');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t$log.debug('[Angular - D3] Data for bars:', data);\n\n\t\t\tvar formatTime = d3.timeFormat(options.timeFormat);\n\t\t\tvar colors = d3Helpers.setColors(options.bar.colors);\n\n\t\t\tvar mapFunction = function(d) {\n\t\t\t\treturn d[options.y.key].map(function(e, i) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: i,\n\t\t\t\t\t\tparentId: d[options.idKey],\n\t\t\t\t\t\tx: d[options.x.key],\n\t\t\t\t\t\ty: e\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar domain = data.map(function(d) { return d[options.x.key]; });\n\t\t\tscope.x.domain(domain);\n\t\t\tscope.xl.call(scope.xAxis);\n\t\t\t$log.debug('[Angular - D3] x domain:', domain);\n\n\t\t\tvar totals = [];\n\t\t\tvar max = d3.max(data, function(d) {\n\t\t\t\treturn d3.max(d[options.y.key], function(v, i) {\n\t\t\t\t\tif(options.y.scale === 'time' && !(v instanceof Date)) {\n\t\t\t\t\t\tv = formatTime.parse(v);\n\t\t\t\t\t}\n\t\t\t\t\tif(!d3Helpers.isDefined(totals[i])) {\n\t\t\t\t\t\ttotals.push(v);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttotals[i] += v;\n\t\t\t\t\t}\n\t\t\t\t\treturn v;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tvar min = 0;\n\n\t\t\tif(!options.y.minFromZero) {\n\t\t\t\tmin = d3.min(data, function(d) {\n\t\t\t\t\treturn d3.min(d[options.y.key]);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t$log.debug('[Angular - D3] Data max for bars:', max);\n\n\t\t\tif(min === undefined || max === undefined || (min === 0 && max === 0)) {\n\t\t\t\tmin = 0;\n\t\t\t\tmax = options.y.scale === 'time'? new Date():100;\n\t\t\t} else if((min - max) === 0) {\n\t\t\t\tmin = min instanceof Date? 0:(min - Math.abs(min/2));\n\t\t\t\tmax = max instanceof Date? max:(max + Math.abs(max/2));\n\t\t\t}\n\n\t\t\tscope.y.domain([min, max]);\n\t\t\tif(min < max) {\n\t\t\t\tscope.y.nice();\n\t\t\t}\n\n\t\t\tif(scope.type === 'bar') {\n\t\t\t\tscope.yl.call(scope.yAxis);\n\t\t\t\tsvgHelpers.addSubdivideTicks(scope.yl, scope.y, scope.yAxis, options.y);\n\t\t\t}\n\n\t\t\tif(d3Helpers.isDefined(scope.zoom) && d3Helpers.isDefined(options.zoom) && options.zoom) {\n\t\t\t\t// scope.zoom.x(scope.x).y(scope.y);\n\t\t\t}\n\n\t\t\tvar yMaxPoints = d3.max(data.map(function(d){ return d[options.y.key].length; }));\n\t\t\tvar x0 = d3.scaleBand()\n\t\t\t\t.domain(d3.range(yMaxPoints))\n\t\t\t\t.rangeRound([0, scope.x.bandwidth()]);\n\n\t\t\tvar barsContainer = scope.svg.select('g.' + scope.classPrefix + '-bars');\n\t\t\tif(barsContainer.empty()) {\n\t\t\t\tbarsContainer = scope.svg.append('g')\n\t\t\t\t\t.attr('transform', 'translate(' + scope.xlLeftOffset + ',' + scope.ylTopOffset + ')')\n\t\t\t\t\t.attr('class', scope.classPrefix + '-bars')\n\t\t\t\t\t.attr('clip-path', 'url(#'+scope.idClip+')');\n\t\t\t}\n\n\t\t\tvar updateBars = function(bars, update) {\n\t\t\t\tif(d3Helpers.isDefined(options.bar.path)) {\n\t\t\t\t\tbars\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.duration(options.animations.time)\n\t\t\t\t\t\t.attrTween('transform', function(d, i, a) {\n\t\t\t\t\t\t\tvar iconHeight = 115;\n\t\t\t\t\t\t\tvar percentH = Math.abs((scope.y(d.y) - scope.y(min))/iconHeight);\n\t\t\t\t\t\t\tvar dy = 0;\n\t\t\t\t\t\t\tvar trans = 'translate(' + (scope.x(d.x) + x0(i) - 102*percentH/2 + x0.bandwidth()/2) + ', ' + dy + ')';\n\t\t\t\t\t\t\tvar inp = d3.interpolateString(a, trans);\n\t\t\t\t\t\t\treturn function(t) {\n\t\t\t\t\t\t\t\treturn inp(t);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\n\t\t\t\t\tif(update) {\n\t\t\t\t\t\tbars = bars.selectAll('path');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbars = bars.append('path')\n\t\t\t\t\t\t\t.attr('d', options.bar.path)\n\t\t\t\t\t\t\t.attr('class', 'a3bar-bar-path')\n\t\t\t\t\t\t\t.attr('fill-rule', 'evenodd')\n\t\t\t\t\t\t\t.attr('transform', 'scale(0)')\n\t\t\t\t\t\t\t.style('opacity', 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tbars\n\t\t\t\t\t\t.style('fill', function(d, i) {\n\t\t\t\t\t\t\tvar color = d3.rgb(colors(i));\n\t\t\t\t\t\t\treturn color;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.style('stroke', function(d, i) {\n\t\t\t\t\t\t\treturn d3.rgb(colors(i)).darker();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.style('stroke-width', 1)\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t\t\t.duration(options.animations.time)\n\t\t\t\t\t\t.attrTween('transform', function(d, i, a) {\n\t\t\t\t\t\t\td = d3.select(this.parentNode).data()[0];\n\t\t\t\t\t\t\tvar percentW = x0.bandwidth()/102;\n\t\t\t\t\t\t\tvar percentH = Math.abs((scope.y(d.y) - scope.y(min))/115);\n\t\t\t\t\t\t\treturn d3.interpolateString(a, 'scale(' + percentW + ', ' + percentH + ')');\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.style('opacity', 0.8);\n\t\t\t\t} else {\n\t\t\t\t\tbars\n\t\t\t\t\t\t.attr('width', x0.bandwidth())\n\t\t\t\t\t\t.attr('title', function(d) {\n\t\t\t\t\t\t\tvar format = d3.format('.3');\n\t\t\t\t\t\t\tif(d3Helpers.isDefined(options.y.tickFormat)) {\n\t\t\t\t\t\t\t\tformat = options.y.tickFormat;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn format(d.y);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('x', function(d, i) {\n\t\t\t\t\t\t\tvar x = scope.x(d.x) + x0(i);\n\t\t\t\t\t\t\treturn isNaN(x)? 0:x;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('y', function() {\n\t\t\t\t\t\t\tvar h = d3.select(this).attr('height');\n\t\t\t\t\t\t\tvar dy = options.y.direction === 'btt'? scope.y(0)-h:0;\n\t\t\t\t\t\t\treturn dy;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('height', function() {\n\t\t\t\t\t\t\tvar h = d3.select(this).attr('height');\n\t\t\t\t\t\t\treturn h? h:0;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t//.style('opacity', 0)\n\t\t\t\t\t\t.style('fill', function() {\n\t\t\t\t\t\t\tvar fill = d3.select(this).style('fill');\n\t\t\t\t\t\t\treturn fill === 'rgb(0, 0, 0)'?\n\t\t\t\t\t\t\t\td3.rgb(255,255,255):fill;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t\t\t.duration(options.animations.time)\n\t\t\t\t\t\t.attr('height', function(d) {\n\t\t\t\t\t\t\treturn Math.abs(scope.y(d.y) - scope.y(min));\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('y', function(d) {\n\t\t\t\t\t\t\tvar h = Math.abs(scope.y(d.y) - scope.y(min));\n\t\t\t\t\t\t\tvar dy = options.y.direction === 'btt'? scope.y(0)-h:0;\n\t\t\t\t\t\t\treturn dy;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t.attrTween('transform', function(d, i, a) {\n\t\t\t\t\t\t\tvar h = Math.abs(scope.y(d.y) - scope.y(min));\n\t\t\t\t\t\t\tvar dy = options.y.direction === 'btt'? (scope.y.range()[1] - h):0;\n\t\t\t\t\t\t\tvar inp = d3.interpolateTransformSvg(a, 'translate(0, ' + dy + ')');\n\t\t\t\t\t\t\treturn inp;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t*/\n\t\t\t\t\t\t.styleTween('fill', function(d, i, a) {\n\t\t\t\t\t\t\tvar color = d3.rgb(colors(i));\n\t\t\t\t\t\t\tvar inp;\n\t\t\t\t\t\t\tif(d3Helpers.isDefined(options.bar.colorInterpolator) && d3Helpers.isFunction(options.bar.colorInterpolator)) {\n\t\t\t\t\t\t\t\tinp = options.bar.colorInterpolator(color.brighter(), color.darker());\n\t\t\t\t\t\t\t\tcolor = inp(d.y/max);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// TODO Check subcolors.\n\t\t\t\t\t\t\tvar returnColor = d3Helpers.isDefined(options.bar.subcolors)? options.bar.subcolors[d.parentId-1]:color;\n\t\t\t\t\t\t\tinp = d3.interpolateRgb(a, returnColor);\n\t\t\t\t\t\t\treturn inp;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//.style('opacity', 1);\n\t\t\t\t}\n\t\t\t\tbars.select('title').remove();\n\t\t\t\tbars.append('title')\n\t\t\t\t\t.text(function(d) {\n\t\t\t\t\t\tvar format = d3.format('.3g');\n\t\t\t\t\t\tif(d3Helpers.isDefined(options.y.tickFormat)) {\n\t\t\t\t\t\t\tformat = options.y.tickFormat;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn format(d.y);\n\t\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar barGroups = barsContainer\n\t\t\t\t.selectAll('.' + scope.classPrefix + '-group-bar')\n\t\t\t\t.data(data, _idFunction);\n\t\t\t// barGroups.interrupt();\n\n\t\t\tbarGroups.each(function(d) {\n\t\t\t\tvar barGroup = d3.select(this);\n\t\t\t\tvar bars = barGroup\n\t\t\t\t\t.selectAll('.' + scope.classPrefix + '-bar')\n\t\t\t\t\t.data(function() {\n\t\t\t\t\t\tvar newData = mapFunction(d);\n\t\t\t\t\t\treturn newData;\n\t\t\t\t\t}, function(d) {\n\t\t\t\t\t\treturn d.id;\n\t\t\t\t\t});\n\n\n\t\t\t\tupdateBars(bars, true);\n\t\t\t\tbars\n\t\t\t\t\t.enter()\n\t\t\t\t\t.append(d3Helpers.isDefined(options.bar.path)? 'g':'rect')\n\t\t\t\t\t.attr('class', scope.classPrefix + '-bar');\n\t\t\t\tupdateBars(bars, true);\n\t\t\t\tbars.exit().remove();\n\t\t\t\tbars = barGroup\n\t\t\t\t\t.selectAll('.' + scope.classPrefix + '-bar');\n\t\t\t\tupdateBars(bars, true);\n\t\t\t});\n\n\n\t\t\tvar series = barGroups.enter()\n\t\t\t\t.append('g')\n\t\t\t\t.attr('class', scope.classPrefix + '-group-bar');\n\n\t\t\tvar bars = series.selectAll('.' + scope.classPrefix + '-bar')\n\t\t\t\t.data(mapFunction, function(d) {\n\t\t\t\t\treturn d.id;\n\t\t\t\t})\n\t\t\t\t// .interrupt()\n\t\t\t\t.enter()\n\t\t\t\t.append(d3Helpers.isDefined(options.bar.path)? 'g':'rect')\n\t\t\t\t.attr('class', scope.classPrefix + '-bar');\n\t\t\tupdateBars(bars);\n\n\t\t\t//bars.exit().remove();\n\t\t\tbarGroups.exit().remove();\n\n\t\t\tif(scope.type === 'oneAxisBar') {\n\t\t\t\tscope.svg.select('g.' + scope.classPrefix +'-helptext').remove();\n\n\t\t\t\tvar helpTextContainer = scope.svg.append('g')\n\t\t\t\t\t.attr('transform', 'translate(' + scope.xlLeftOffset + ',' +\n\t\t\t\t\t\t(scope.ylTopOffset - (options.x.position === 'bottom'? options.height*0.15:-options.height*0.85)) + ')')\n\t\t\t\t\t.attr('class', scope.classPrefix + '-helptext');\n\n\t\t\t\tvar textGroups = helpTextContainer.selectAll('.' + scope.classPrefix + '-values')\n\t\t\t\t\t.data(data, _idFunction)\n\t\t\t\t\t.interrupt();\n\n\t\t\t\tseries = textGroups.enter()\n\t\t\t\t\t.append('g')\n\t\t\t\t\t.attr('class', scope.classPrefix + '-values');\n\n\t\t\t\tif(options.axis.showValues) {\n\t\t\t\t\tseries.selectAll('.' + scope.classPrefix + '-val')\n\t\t\t\t\t\t.data(mapFunction, function(d) {\n\t\t\t\t\t\t\treturn d.id;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.interrupt()\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append('text')\n\t\t\t\t\t\t.attr('x', function(d, i) {\n\t\t\t\t\t\t\treturn scope.x(d.x) + x0(i) + x0.bandwidth()/2;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('dy', !options.axis.showPercent? '0.5em':0)\n\t\t\t\t\t\t.attr('class', scope.classPrefix + '-val')\n\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\t\t.style('fill', options.axis.valuesColor)\n\t\t\t\t\t\t.text(function(d) {\n\t\t\t\t\t\t\tvar format = d3.format('.3g');\n\t\t\t\t\t\t\treturn format(d.y);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif(options.axis.showPercent) {\n\t\t\t\t\tseries.selectAll('.' + scope.classPrefix + '-percent')\n\t\t\t\t\t\t.data(mapFunction, function(d) {\n\t\t\t\t\t\t\treturn d.id;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.interrupt()\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append('text')\n\t\t\t\t\t\t.attr('x', function(d, i) {\n\t\t\t\t\t\t\treturn scope.x(d.x) + x0(i) + x0.bandwidth()/2;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('y', options.height*0.065)\n\t\t\t\t\t\t.attr('dy', !options.axis.showValues? '-0.5em':0)\n\t\t\t\t\t\t.attr('class', scope.classPrefix + '-percent')\n\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\t\t.style('font-size', '0.85em')\n\t\t\t\t\t\t.style('font-weight', 'bold')\n\t\t\t\t\t\t.style('fill', options.axis.percentColor)\n\t\t\t\t\t\t.text(function(d, i) {\n\t\t\t\t\t\t\tvar format = d3.format('.3p');\n\t\t\t\t\t\t\treturn format(d.y/totals[i]);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsvgHelpers.updateStyles(scope, options);\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('pieHelpers', function ($log, d3Helpers, svgHelpers) {\n\n\tfunction _tweenPie($this, scope, options, b) {\n\t\tb.innerRadius = 0;\n\t\tvar start = null;\n\t\tswitch(options.pieAnimation) {\n\t\t\tcase 'inverse':\n\t\t\t\tstart = {startAngle: 2*Math.PI, endAngle: 2*Math.PI};\n\t\t\t\tbreak;\n\t\t\tcase 'crossfade':\n\t\t\t\tstart = {startAngle: 2*Math.PI, endAngle: 0};\n\t\t\t\tbreak;\n\t\t\tcase 'crossfade-inverse':\n\t\t\t\tstart = {startAngle: 0, endAngle: 2*Math.PI};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif(!d3Helpers.isDefined(options.pieAnimation) || options.pieAnimation === '') {\n\t\t\t\t\t$log.warn('[Angular - D3] The option \"pieAnimation\" is undefined or it has a invalid value. Setting to \"normal\"');\n\t\t\t\t\toptions.pieAnimation = 'normal';\n\t\t\t\t}\n\t\t\t\tstart = {startAngle: 0, endAngle: 0};\n\t\t\t\tbreak;\n\t\t}\n\t\tif($this._current) {\n\t\t\tstart = $this._current;\n\t\t}\n\t\tvar i = d3.interpolate(start, b);\n\t\t$this._current = i(0);\n\t\treturn function(t) {\n\t\t\treturn scope.arc(i(t));\n\t\t};\n\t}\n\n\t// Find the element in data0 that joins the highest preceding element in data1.\n\tfunction findPreceding(i, data0, data1, key) {\n\t\tvar m = data0.length;\n\t\twhile (--i >= 0) {\n\t\t\tvar k = key(data1[i]);\n\t\t\tfor (var j = 0; j < m; ++j) {\n\t\t\t\tif (key(data0[j]) === k) {\n\t\t\t\t\treturn data0[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Find the element in data0 that joins the lowest following element in data1.\n\tfunction findFollowing(i, data0, data1, key) {\n\t\tvar n = data1.length, m = data0.length;\n\t\twhile (++i < n) {\n\t\t\tvar k = key(data1[i]);\n\t\t\tfor (var j = 0; j < m; ++j) {\n\t\t\t\tif (key(data0[j]) === k) {\n\t\t\t\t\treturn data0[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction findNeighborArc(i, data0, data1, key) {\n    var d;\n\t\tvar obj;\n    if(d = findPreceding(i, data0, data1, key)) {\n      obj = angular.copy(d);\n      obj.startAngle = d.endAngle;\n      return obj;\n    } else if(d = findFollowing(i, data0, data1, key)) {\n      obj = angular.copy(d);\n      obj.endAngle = d.startAngle;\n      return obj;\n    }\n    return null;\n  }\n\n\tvar pathAnim = function(path, dir, options) {\n\t\tswitch(dir) {\n\t\t\tcase 0:\n\t\t\t\tpath\n\t\t\t\t\t.style('stroke', null)\n\t\t\t\t\t.transition('pie-animation')\n\t\t\t\t\t.duration(500)\n\t\t\t\t\t.ease(d3.easeBounce)\n\t\t\t\t\t.style('stroke-opacity', 0)\n\t\t\t\t\t.style('stroke-width', 0)\n\t\t\t\t\t.attr('d', d3.arc()\n\t\t\t\t\t\t.outerRadius(options.radius * 0.9)\n\t\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tpath\n\t\t\t\t\t.style('stroke', function() {\n\t\t\t\t\t\treturn d3.color(d3.select(this).attr('fill')).darker();\n\t\t\t\t\t})\n\t\t\t\t\t.style('stroke-opacity', 0)\n\t\t\t\t\t.style('stroke-width', 0)\n\t\t\t\t\t.transition('pie-animation')\n\t\t\t\t\t.style('stroke-opacity', 1)\n\t\t\t\t\t.style('stroke-width', 1)\n\t\t\t\t\t.attr('d', d3.arc()\n\t\t\t\t\t\t.outerRadius(options.radius * 0.95)\n\t\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tpath\n\t\t\t\t\t.style('stroke', function() {\n\t\t\t\t\t\treturn d3.color(d3.select(this).attr('fill')).darker();\n\t\t\t\t\t})\n\t\t\t\t\t.style('stroke-opacity', 0)\n\t\t\t\t\t.style('stroke-width', 0)\n\t\t\t\t\t.transition('pie-animation')\n\t\t\t\t\t.style('stroke-opacity', 1)\n\t\t\t\t\t.style('stroke-width', 1)\n\t\t\t\t\t.attr('d', d3.arc()\n\t\t\t\t\t\t.outerRadius(options.radius * 0.95)\n\t\t\t\t\t);\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\tvar midAngle = function(d) {\n\t\treturn d.startAngle + (d.endAngle - d.startAngle)/2;\n\t};\n\n\tvar _wrapLabels = function(scope, options) {\n\t\tscope.svg.selectAll('.' + scope.classPrefix + '-lines g text')\n\t\t\t.each(function() {\n\t\t\t\tvar rect = this.parentNode.getBoundingClientRect();\n\t\t\t\tif(rect.left < 0) {\n\t\t\t\t\tsvgHelpers.wrap(this, rect.right);\n\t\t\t\t} else if(rect.right > options.width) {\n\t\t\t\t\tsvgHelpers.wrap(this, options.width - rect.left);\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\treturn {\n\t\taddArc: function(scope, options) {\n\t\t\tvar w = options.width - options.margin.left - options.margin.right;\n\t\t\tif(options.legend.show && options.legend.type === 'vertical') {\n\t\t\t\tw -= options.legend.size;\n\t\t\t}\n\t\t\tvar h = options.height - options.margin.top - options.margin.bottom;\n\t\t\toptions.radius = Math.min(w, h) / 2;\n\t\t\tscope.arc = d3.arc()\n\t\t\t\t.outerRadius(options.radius * 0.9);\n\n\t\t\tscope.outerArc = d3.arc()\n\t\t\t\t.innerRadius(options.radius * 1)\n\t\t\t\t.outerRadius(options.radius * 1);\n\n\t\t\tscope.pie = d3.pie()\n\t\t\t\t.value(function(d) { return d[options.y.key]; })\n\t\t    .sort(null);\n\n\t\t\t// ===========================================================================================\n\t    // g elements to keep elements within svg modular\n\t\t\tscope.svg.append('g').attr('class', scope.classPrefix + '-slices');\n\t\t\tscope.svg.append('g').attr('class', scope.classPrefix + '-labelName');\n\t    scope.svg.append('g').attr('class', scope.classPrefix + '-lines');\n\t    // ===========================================================================================\n\t\t},\n\n\t\tupdateData: function(scope, options) {\n\t\t\t$log.debug('Update data');\n\t\t\t// var percentFormat = d3.format(',.2%');\n\t\t\tvar colors = d3Helpers.setColors(options.pie.colors);\n\t\t\tvar data = d3Helpers.getDataFromScope(scope, options);\n\t\t\tdata = data.filter(function(d) {\n\t\t\t\treturn d3Helpers.isDefined(d[options.y.key]) && !isNaN(d[options.y.key]);\n\t\t\t});\n\n\t\t\tif(d3Helpers.isUndefinedOrEmpty(data)) {\n\t\t\t\t$log.warn('[Angular - D3] No data for pie');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Key function for get data.\n\t\t\tvar key = function(d) {\n\t\t\t\tif(angular.isUndefined(d)) {\n\t\t\t\t\treturn d;\n\t\t\t\t}\n\t\t\t\tif(angular.isUndefined(d.data)) {\n\t\t\t\t\treturn d.data;\n\t\t\t\t}\n\t\t\t\treturn d.data[options.idKey];\n\t\t\t};\n\n\t\t\tvar arcTween = function() {\n\t\t\t\treturn _tweenPie(this, scope, options, d3.select(this).data()[0]);\n\t\t\t};\n\n\t\t\tvar removeTooltip = function() {\n\t\t\t\tvar lines = scope.svg.select('.a3pie-lines');\n\t\t\t\tlines\n\t\t\t\t\t.selectAll('g')\n\t\t\t\t\t.remove();\n\n\t\t\t\treturn lines;\n\t\t\t};\n\n\t\t\tvar onTooltip = function(d) {\n\t\t\t\tpathAnim(d3.select(this), 1, options);\n\t\t\t\tvar lines = removeTooltip();\n\t\t\t\tvar g = lines.append('g');\n\t\t\t\tvar polyline = g.append('polyline');\n\n\t\t\t\tpolyline\n\t\t\t\t\t.style('opacity', 0.3)\n\t\t\t\t\t.style('stroke', 'black')\n\t\t\t\t\t.style('stroke-width', '2px')\n\t\t\t\t\t.style('fill', 'none')\n\t\t\t\t\t.transition().duration(1000)\n\t\t\t\t\t.attrTween('points', function() {\n\t\t\t\t\t\tthis._current = this._current || d;\n\t\t\t\t\t\tvar interpolate = d3.interpolate(this._current, d);\n\t\t\t\t\t\tthis._current = interpolate(0);\n\n\t\t\t\t\t\treturn function(t) {\n\t\t\t\t\t\t\tvar d2 = interpolate(t);\n\t\t\t\t\t\t\tvar pos = scope.outerArc.centroid(d2);\n\t\t\t\t\t\t\tpos[0] = options.radius * 0.95 * (midAngle(d2) < Math.PI ? 1 : -1);\n\t\t\t\t\t\t\treturn [scope.arc.centroid(d2), scope.outerArc.centroid(d2), pos];\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\n\t\t\t\tvar text = g.append('text')\n\t\t\t\t\t.attr('dy', '.35em')\n\t\t\t\t\t.html(function() {\n\t\t\t\t\t\treturn d.data[options.x.key];\n\t\t\t\t\t});\n\n\t\t\t\ttext\n\t\t\t\t\t.attr('transform', function() {\n\t\t\t\t\t\tthis._current = this._current || d;\n\t\t\t\t\t\tvar pos = scope.outerArc.centroid(this._current);\n\t\t\t\t\t\tpos[0] = options.radius * (midAngle(this._current) < Math.PI ? 1 : -1);\n\t\t\t\t\t\treturn 'translate('+ pos +')';\n\t\t\t\t\t})\n\t\t\t\t\t.style('text-anchor', function(){\n\t\t\t\t\t\tthis._current = this._current || d;\n\t\t\t\t\t\treturn midAngle(this._current) < Math.PI ? 'start':'end';\n\t\t\t\t\t})\n\t\t\t\t\t.each(function() {\n\t\t\t\t\t\tsvgHelpers.wrap(this, options.tooltipSize);\n\t\t\t\t\t});\n\t\t\t};\n\n\t\t\t//scope.svg.selectAll('.' + scope.classPrefix + '-arc').remove();\n\n\t\t\t// ===========================================================================================\n\t\t\t// add and colour the pie slices\n\t\t\tscope.slices = scope.svg.selectAll('.' + scope.classPrefix + '-slices');\n\t\t\tvar path = scope.slices.selectAll('path');\n\t\t\tvar dataSlices = path.data();\n\t\t\tvar pieData = scope.pie(data);\n\n\t\t\tvar arcs = path.data(pieData, key);\n\n\t\t\tarcs\n\t\t\t\t.on('mouseout', null)\n\t\t\t\t.on('mouseover', null)\n\t\t\t\t.transition()\n\t\t\t\t.duration(options.animations.time)\n\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t.on('end', function() {\n\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\t\t\tpathAnim(d3.select(this), 1, options);\n\t\t\t\t\t\t\tonTooltip(d);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('mouseout', function() {\n\t\t\t\t\t\t\tremoveTooltip();\n\t\t\t\t\t\t\tpathAnim(d3.select(this), 0, options);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('click', onTooltip);\n\t\t\t\t})\n\t\t\t\t.attr('fill', function(d) {\n\t\t\t\t\tif(angular.isDefined(options.colorKey) && angular.isDefined(d.data[options.colorKey])) {\n\t\t\t\t\t\treturn d.data[options.colorKey];\n\t\t\t\t\t}\n\t\t\t\t\treturn colors(d.data[options.x.key]);\n\t\t\t\t})\n\t\t\t\t.attrTween('d', arcTween);\n\n\t\t\tarcs.enter()\n\t\t\t\t.append('path')\n\t\t\t\t.each(function(d, i) {\n\t\t\t\t\tvar narc = findNeighborArc(i, dataSlices, pieData, key);\n\t\t\t\t\tif(narc) {\n\t\t\t\t\t\tthis._current = narc;\n\t\t\t\t\t\tthis._previous = narc;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._current = d;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.attr('fill', function(d) {\n\t\t\t\t\tif(angular.isDefined(options.colorKey) && angular.isDefined(d.data[options.colorKey])) {\n\t\t\t\t\t\treturn d.data[options.colorKey];\n\t\t\t\t\t}\n\t\t\t\t\treturn colors(d.data[options.x.key]);\n\t\t\t\t})\n\t\t\t\t.transition('pie-enter')\n\t\t\t\t.duration(options.animations.time)\n\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t.on('end', function() {\n\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\t\t\tpathAnim(d3.select(this), 1, options);\n\t\t\t\t\t\t\tonTooltip(d);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('mouseout', function() {\n\t\t\t\t\t\t\tremoveTooltip();\n\t\t\t\t\t\t\tpathAnim(d3.select(this), 0, options);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('click', onTooltip);\n\t\t\t\t})\n\t\t\t\t.attrTween('d', arcTween);\n\n\t\t\tarcs\n\t\t\t\t.exit()\n\t\t\t\t.each(function() {\n\t\t\t\t\td3.select(this)\n\t\t\t\t\t.on('mouseout', null)\n\t\t\t\t\t.on('mouseover', null);\n\t\t\t\t})\n\t\t\t\t.transition()\n\t\t\t\t.duration(options.animations.time)\n\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t.attrTween('d', function(d, idx) {\n\t\t\t\t\tvar previous = this._previous? this._previous:findNeighborArc(idx, pieData, dataSlices, key);\n\t\t\t\t\tvar i = d3.interpolateObject(d, previous);\n\t\t\t\t\treturn function(t) {\n\t\t\t\t\t\treturn scope.arc(i(t));\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t\t.remove();\n\n\t\t\t// ===========================================================================================\n\n\t\t\tthis.setStyles(scope, options);\n\n\t\t\tif(options.legend.show) {\n\t\t\t\tthis.createLegend(scope, options, colors);\n\t\t\t}\n\t\t},\n\n\t\tcreateLegend: function(scope, options, colors) {\n\t\t\tvar percentFormat = d3.format(',.2%');\n\t\t\tvar data = d3Helpers.getDataFromScope(scope, options);\n\n\t\t\tvar total = d3.sum(data, function(d) {\n\t\t\t\treturn d[options.y.key];\n\t\t\t});\n\n\t\t\t// Key function for get data.\n\t\t\tvar key = function(d) {\n\t\t\t\tif(angular.isUndefined(d)) {\n\t\t\t\t\treturn d;\n\t\t\t\t}\n\t\t\t\treturn d[options.idKey];\n\t\t\t};\n\n\n\t\t\tif(!scope.legend) {\n\t\t\t\tvar left;\n\t\t\t\tvar top;\n\t\t\t\tif(options.legend.type === 'vertical') {\n\t\t\t\t\tleft = options.radius + options.legend.gap;\n\t\t\t\t\ttop = -options.radius*0.9;\n\t\t\t\t} else {\n\t\t\t\t\tleft = -options.containerWidth/2 + options.margin.left;\n\t\t\t\t\ttop = options.radius + options.legend.gap;\n\t\t\t\t}\n\t\t\t\tscope.legend = scope.svg\n\t\t\t\t\t.append('g')\n\t\t\t\t\t.attr('class', 'legend')\n\t\t\t\t\t.attr('transform', 'translate(' + left  +', ' + top + ')');\n\t\t\t}\n\n\t\t\tvar items = scope.legend\n\t\t\t\t.selectAll('.legend-item')\n\t\t\t\t.data(data, key);\n\n\t\t\titems\n\t\t\t\t.selectAll('text')\n\t\t\t\t.html(function() {\n\t\t\t\t\tvar d = d3.select(this.parentNode).data()[0];\n\t\t\t\t\treturn d[options.x.key] + ' (' + percentFormat(d[options.y.key]/total) + ')';\n\t\t\t\t})\n\t\t\t\t.each(function() {\n\t\t\t\t\tif(options.legend.type === 'vertical') {\n\t\t\t\t\t\tsvgHelpers.wrap(this, options.legend.size - 20);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\titems\n\t\t\t\t.selectAll('rect')\n\t\t\t\t.attr('fill', function() {\n\t\t\t\t\tvar d = d3.select(this.parentNode).data()[0];\n\t\t\t\t\treturn colors(d[options.x.key]);\n\t\t\t\t});\n\n\t\t\tvar item = items.enter()\n\t\t\t\t.append('g')\n\t\t\t\t.attr('class', 'legend-item');\n\n\t\t\titem\n\t\t\t\t.append('rect')\n\t\t\t\t.attr('width', 18)\n\t\t\t\t.attr('height', 18)\n\t\t\t\t.attr('transform', 'translate(0, -13)')\n\t\t\t\t.attr('fill', function() {\n\t\t\t\t\tvar d = d3.select(this.parentNode).data()[0];\n\t\t\t\t\treturn colors(d[options.x.key]);\n\t\t\t\t});\n\n\t\t\titem\n\t\t\t\t.append('text')\n\t\t\t\t// .attr('x', '25px')\n\t\t\t\t.attr('y', 0)\n\t\t\t\t.attr('dy', '0')\n\t\t\t\t.attr('dx', '25px')\n\t\t\t\t.html(function() {\n\t\t\t\t\tvar d = d3.select(this.parentNode).data()[0];\n\t\t\t\t\treturn d[options.x.key] + ' (' + percentFormat(d[options.y.key]/total) + ')';\n\t\t\t\t})\n\t\t\t\t.each(function() {\n\t\t\t\t\tif(options.legend.type === 'vertical') {\n\t\t\t\t\t\tsvgHelpers.wrap(this, options.legend.size - 20);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\titems\n\t\t\t\t.exit()\n\t\t\t\t.remove();\n\n\t\t\tvar currentX = 0;\n\t\t\tvar currentY = 0, iy = 0;\n\t\t\tscope.legend\n\t\t\t\t.selectAll('.legend-item')\n\t\t\t\t.attr('transform', function() {\n\t\t\t\t\tvar oldY = Math.max(currentY, 25*iy);\n\t\t\t\t\tvar oldX = currentX;\n\n\t\t\t\t\tvar clientRect =\n\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t//.select('text')\n\t\t\t\t\t\t\t.node()\n\t\t\t\t\t\t\t.getBoundingClientRect();\n\n\t\t\t\t\tif(options.legend.type === 'vertical') {\n\t\t\t\t\t\tcurrentY += clientRect.height + 5;\n\t\t\t\t\t\tiy++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(currentX + clientRect.width > options.containerWidth) {\n\t\t\t\t\t\t\tcurrentX = 0;\n\t\t\t\t\t\t\toldX = 0;\n\t\t\t\t\t\t\tiy++;\n\t\t\t\t\t\t\toldY = Math.max(currentY, 25*iy);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrentX += clientRect.width + 10;\n\t\t\t\t\t}\n\t\t\t\t\treturn 'translate(' + oldX + ', ' + oldY + ')';\n\t\t\t\t});\n\n\t\t\tvar legendRect = scope.legend.node().getBoundingClientRect();\n\t\t\tif(scope.container) {\n\t\t\t\t$log.debug('SVG:', scope.svg.node().parentNode);\n\t\t\t\tvar svg = d3.select(scope.svg.node().parentNode);\n\t\t\t\tif(legendRect.bottom > options.containerHeight) {\n\t\t\t\t\td3.selectAll(scope.container)\n\t\t\t\t\t\t.style('height', legendRect.bottom + 'px');\n\n\t\t\t\t\tsvg.attr('height', legendRect.bottom);\n\t\t\t\t} else {\n\t\t\t\t\td3.selectAll(scope.container)\n\t\t\t\t\t\t.style('height', options.containerHeight + 'px');\n\n\t\t\t\t\tsvg.attr('height', options.containerHeight);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\twrapLabels: _wrapLabels,\n\n\t\tsetStyles: function(scope, options) {\n\t\t\tscope.svg.selectAll('.' + scope.classPrefix + '-labelName text')\n\t\t\t\t.style('fill', options.axis.color)\n\t\t\t\t.style('font-weight', options.axis.fontWeight);\n\n\t\t\tscope.svg\n\t\t\t\t.style('font-family', options.fontFamily)\n\t\t\t\t.style('font-size', options.fontSize);\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('lineHelpers', function ($log, d3Helpers, svgHelpers) {\n\t/*\n\tvar _idFunction = function(d) {\n\t\treturn d.id;\n\t};\n\t*/\n\n\treturn {\n\t\taddAxis: function(scope, options) {\n\t\t\tsvgHelpers.addXAxis(scope, options);\n\t\t\tsvgHelpers.addYAxis(scope, options);\n\t\t\tsvgHelpers.addSubdivideTicks(scope.yl, scope.y, scope.yAxis, options.y);\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('svgHelpers', function ($log, d3Helpers) {\n\treturn {\n\t\t/**\n\t\t * Add SVG element to DOM.\n\t\t *\n\t\t * @param {Object} scope Chart scope.\n\t\t * @param {Element} container Container from SVG.\n\t\t * @param {Object} options Chart options.\n\t\t *\n\t\t * @returns {SVGElement} SVG Element for Pie.\n\t\t */\n\t\taddSVG: function(scope, container, options) {\n\t\t\tvar w = options.width + options.margin.left + options.margin.right;\n\t\t\tw += (options.legend.show && options.legend.type === 'vertical')?\n\t\t\t\t(options.legend.size + options.legend.gap):0;\n\t\t\tvar h = options.height + options.margin.top + options.margin.bottom + (options.axis.show? 30:0);\n\n\t\t\toptions.containerWidth = w;\n\t\t\toptions.containerHeight = h;\n\t\t\tvar svg = d3.select(container)\n\t\t\t\t.style('width', w + 'px')\n\t\t\t\t.style('height', h + 'px')\n\t\t\t\t.append('svg')\n\t\t\t\t.attr('width', w)\n\t\t\t\t.attr('height', h)\n\t\t\t\t.append('g')\n\t\t\t\t.attr('transform', 'translate(' + options.margin.left + ',' + options.margin.top + ')')\n\t\t\t\t.style('cursor', 'pointer');\n\n\t\t\t// Mask for zoom and pan behavior.\n\t\t\tscope.idClip = 'clip-' + d3Helpers.getRandomString();\n\t\t\tsvg.append('clipPath')\n\t\t\t\t.attr('id', scope.idClip)\n\t\t\t\t.append('rect')\n\t\t\t\t.attr('width', options.width)\n\t\t\t\t.attr('height', options.height);\n\t\t\tscope.svg = svg;\n\t\t\treturn svg;\n\t\t},\n\n\t\t/**\n\t\t * Add Zoom Behaviour to chart.\n\t\t */\n\t\taddZoomBehaviour: function(scope, behavior) {\n\t\t\tif(!d3Helpers.isDefined(scope.x)) {\n\t\t\t\t$log.warn('[Angular - D3] x scale is not defined, unable set zoom behavior');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!d3Helpers.isDefined(scope.y)) {\n\t\t\t\t$log.warn('[Angular - D3] y scale is not defined, unable set zoom behavior');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.zoom = d3.zoom()\n\t\t\t\t// .x(scope.x)\n\t\t\t\t// .y(scope.y)\n\t\t\t\t.scaleExtent([0.5, 100])\n\t\t\t\t.on('zoom', behavior);\n\t\t},\n\n\n\t\t/**\n\t\t * Add X Axis to chart.\n\t\t */\n\t\taddXAxis: function(scope, options) {\n\t\t\tscope.xl = scope.svg.append('g')\n\t\t\t\t.attr('class', 'x axis');\n\n\t\t\tscope.xlLeftOffset = 0;\n\t\t\tif(options.axis.show && options.y.position === 'left') {\n\t\t\t\tscope.xlLeftOffset = 30;\n\t\t\t\tif(options.y.orient === 'axisRight') {\n\t\t\t\t\tscope.xlLeftOffset += 10;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(scope.type === 'oneAxisBar') {\n\t\t\t\tscope.xlLeftOffset = 0;\n\t\t\t}\n\n\t\t\tif(!d3Helpers.isDefined(options.x.position) || d3Helpers.isString(options.x.position)) {\n\t\t\t\tswitch(options.x.position) {\n\t\t\t\t\tcase 'top':\n\t\t\t\t\t\tscope.xl.attr('transform', 'translate(' + scope.xlLeftOffset + ', ' + (options.x.orient === 'axisBottom'? 0:20) + ')');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!d3Helpers.isDefined(options.x.position) || !d3Helpers.isString(options.x.position) ||\n\t\t\t\t\t\t\toptions.x.position !== 'bottom') {\n\t\t\t\t\t\t\t$log.warn('[Angular - D3] X Axis position must be a string. Setting default value \"bottom\"');\n\t\t\t\t\t\t\toptions.x.position = 'bottom';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscope.xl.attr('transform', 'translate(' + scope.xlLeftOffset + ', ' +\n\t\t\t\t\t\t\t(options.height + (options.x.orient === 'axisBottom'? 0:20))+ ')');\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if(d3Helpers.isNumber(options.x.position)) {\n\t\t\t\tscope.xl.attr('transform', 'translate(' + scope.xlLeftOffset + ', ' +\n\t\t\t\t\t(options.x.orient === 'axisBottom'? (options.x.position + 20):options.x.position) + ')');\n\t\t\t}\n\n\t\t\tscope.xl.call(scope.xAxis);\n\n\t\t\tif(d3Helpers.isDefined(options.x.label) && options.x.label !== false) {\n\t\t\t\tscope.xl.append('text')\n\t\t\t\t\t.attr('class', 'label')\n\t\t\t\t\t.attr('transform', 'translate(' + (options.width) + ')')\n\t\t\t\t\t.attr('dx', '0.8em')\n\t\t\t\t\t.attr('dy', options.x.orient === 'axisBottom'? '1.35em':0)\n\t\t\t\t\t.style('text-anchor', 'start')\n\t\t\t\t\t.style('font-size', '1.1em')\n\t\t\t\t\t.style('font-weight', 'bold')\n\t\t\t\t\t.text(options.x.label);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Add Y Axis to chart.\n\t\t */\n\t\taddYAxis: function(scope, options) {\n\t\t\tscope.yl = scope.svg.append('g')\n\t\t\t\t.attr('class', 'y axis');\n\n\t\t\tscope.ylTopOffset = 0;\n\t\t\tif(options.axis.show && options.x.position === 'top') {\n\t\t\t\tscope.ylTopOffset = 30;\n\t\t\t}\n\n\t\t\tif(!d3Helpers.isDefined(options.y.position) || d3Helpers.isString(options.y.position)) {\n\t\t\t\tswitch(options.y.position) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tscope.yl.attr('transform', 'translate(' + (options.width + (options.y.orient === 'axisLeft'? 20:0)) + ',' +\n\t\t\t\t\t\t\t\t(scope.ylTopOffset) + ')');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!d3Helpers.isDefined(options.y.position) || !d3Helpers.isString(options.y.position) ||\n\t\t\t\t\t\t\toptions.y.position !== 'left') {\n\t\t\t\t\t\t\t$log.warn('[Angular - D3] Y Axis position must be a string. Setting default value \"left\"');\n\t\t\t\t\t\t\toptions.y.position = 'left';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscope.yl.attr('transform', 'translate(' + (options.y.orient === 'axisLeft'? 20:0) + ',' +\n\t\t\t\t\t\t\t\t(scope.ylTopOffset) + ')');\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if(d3Helpers.isNumber(options.y.position)) {\n\t\t\t\tscope.yl.attr('transform', 'translate(' + (options.y.position - (options.y.orient === 'axisLeft'? 20:0)) + ',' +\n\t\t\t\t\t\t(scope.ylTopOffset) + ')');\n\t\t\t}\n\n\t\t\tscope.yl.call(scope.yAxis);\n\n\t\t\tif(d3Helpers.isDefined(options.y.label) && options.y.label !== false) {\n\t\t\t\tscope.yl.append('text')\n\t\t\t\t\t.attr('class', 'label')\n\t\t\t\t\t.attr('dy', options.y.position === 'right'? 4:(options.x.position === 'top'? 0:'-1em'))\n\t\t\t\t\t.attr('x', options.y.position === 'right'? '1.5em':'1em')\n\t\t\t\t\t.attr('y', options.x.position === 'top'? options.height:0)\n\t\t\t\t\t.style('text-anchor', 'start')\n\t\t\t\t\t.style('font-size', '1.1em')\n\t\t\t\t\t.style('font-weight', 'bold')\n\t\t\t\t\t.text(options.y.label);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Add Subdivide Ticks to chart.\n\t\t */\n\t\taddSubdivideTicks: function(g, scale, axis, options) {\n\t\t\tg.selectAll('.tick.minor')\n\t\t\t\t.classed('minor', false)\n\t\t\t\t.selectAll('text')\n\t\t\t\t.style('display', null)\n\t\t\t\t.style('stroke-width', 0);\n\t\t\tif(options.scale !== 'sqrt' && options.scale !== 'linear') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tg.selectAll('.tick')\n\t\t\t\t.data(scale.ticks(options.ticks), function(d) { return d; })\n\t\t\t\t.exit()\n\t\t\t\t.classed('minor', true)\n\t\t\t\t.selectAll('text')\n\t\t\t\t.style('display', 'none');\n\n\t\t\t/*\n\t\t\tswitch(axis.orient()) {\n\t\t\t\tcase 'left':\n\t\t\t\t\tg.selectAll('.tick.minor line')\n\t\t\t\t\t\t.attr('x2', -4);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bottom':\n\t\t\t\t\tg.selectAll('.tick.minor line')\n\t\t\t\t\t\t.attr('y2', 4);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'top':\n\t\t\t\t\tg.selectAll('.tick.minor line')\n\t\t\t\t\t\t.attr('y2', -4);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'right':\n\t\t\t\t\tg.selectAll('.tick.minor line')\n\t\t\t\t\t\t.attr('x2', 4);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t*/\n\t\t},\n\n\n\t\t/**\n\t\t * Refresh chart CSS styles.\n\t\t */\n\t\tupdateStyles: function(scope, options) {\n\t\t\tvar stroke = scope.type === 'bar'? options.axis.stroke:null;\n\n\t\t\tif(options.axis.show === true) {\n\t\t\t\tscope.svg.selectAll('.axis path')\n\t\t\t\t\t.style('stroke', stroke)\n\t\t\t\t\t.style('fill', 'none')\n\t\t\t\t\t.style('shape-rendering', 'crispEdges');\n\n\t\t\t\tscope.svg.selectAll('.axis .tick line')\n\t\t\t\t\t.style('stroke', stroke)\n\t\t\t\t\t.style('fill', 'none');\n\n\t\t\t\tscope.svg.selectAll('.axis .tick.minor')\n\t\t\t\t\t.style('stroke', stroke)\n\t\t\t\t\t.style('fill', 'none');\n\n\t\t\t\tscope.svg.selectAll('.axis text')\n\t\t\t\t\t.style('fill', options.axis.color)\n\t\t\t\t\t.style('font-weight', options.axis.fontWeight);\n\n\t\t\t\tscope.svg.selectAll('.axis .label')\n\t\t\t\t\t.style('fill', options.axis.label.color)\n\t\t\t\t\t.style('font-weight', options.axis.label.fontWeight);\n\t\t\t} else {\n\t\t\t\tscope.svg.selectAll('.axis')\n\t\t\t\t\t.style('display', 'none');\n\t\t\t}\n\n\t\t\tscope.svg.style('font-family', options.fontFamily);\n\t\t\tscope.svg.style('font-size', options.fontSize);\n\t\t},\n\n\t\t/**\n\t\t * Wrap Text Node on determinate width.\n\t\t *\n\t\t * @param {string} text Text to wrap.\n\t\t * @param {number} width Max width for text element.\n\t\t */\n\t\twrap: function(text, width) {\n\t    text = d3.select(text);\n\t\t\tvar words = text.text().split(/\\s+/).reverse(),\n\t        word,\n\t        line = [],\n\t        lineNumber = 0,\n\t        lineHeight = 1.1, // ems\n\t        y = text.attr('y'),\n\t        dy = parseFloat(text.attr('dy')),\n\t        dx = text.attr('dx');\n\n\t\t\tvar tspan =\n\t\t\t\ttext.text(null)\n\t\t\t\t\t.append('tspan')\n\t\t\t\t\t.attr('x', 0)\n\t\t\t\t\t.attr('y', y)\n\t\t\t\t\t.attr('dx', dx)\n\t\t\t\t\t.attr('dy', dy + 'em');\n\t    while(word = words.pop()) {\n\t      line.push(word);\n\t      tspan.text(line.join(' '));\n\t      if(tspan.node().getComputedTextLength() > width) {\n\t        line.pop();\n\t        tspan.text(line.join(' '));\n\t        line = [word];\n\t        tspan =\n\t\t\t\t\t\ttext.append('tspan')\n\t\t\t\t\t\t\t.attr('x', 0)\n\t\t\t\t\t\t\t.attr('y', y)\n\t\t\t\t\t\t\t.attr('dx', dx)\n\t\t\t\t\t\t\t.attr('dy', ++lineNumber * lineHeight + dy + 'em')\n\t\t\t\t\t\t\t.text(word);\n\t      }\n\t    }\n\t\t},\n\n\t\t/**\n\t\t * Get translation from an transform string.\n\t\t *\n\t\t * @param {string} transform Transform string.\n\t\t */\n\t\tgetTranslation: function(transform) {\n\t\t\t// Create a dummy g for calculation purposes only. This will never\n\t\t\t// be appended to the DOM and will be discarded once this function\n\t\t\t// returns.\n\t\t\tvar g = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n\n\t\t\t// Set the transform attribute to the provided string value.\n\t\t\tg.setAttributeNS(null, 'transform', transform);\n\n\t\t\t// consolidate the SVGTransformList containing all transformations\n\t\t\t// to a single SVGTransform of type SVG_TRANSFORM_MATRIX and get\n\t\t\t// its SVGMatrix.\n\t\t\tvar matrix = g.transform.baseVal.consolidate().matrix;\n\n\t\t\t// As per definition values e and f are the ones for the translation.\n\t\t\treturn [matrix.e, matrix.f];\n\t\t}\n\t};\n});\n\n}());\n//# sourceMappingURL=angular-d3-charts.js.map"]}
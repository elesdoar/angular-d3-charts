{"version":3,"sources":["angular-d3-charts.js"],"names":["angular","module","directive","$log","d3Helpers","svgHelpers","barHelpers","barDefaults","restrict","replace","scope","options","data","template","controller","$scope","info","link","element","attrs","jQuery","container","type","classPrefix","isDefined","setDefaults","id","setSize","setXScale","setYScale","zoom","addZoomBehaviour","zoomBehaviour","addSVG","get","width","containerWidth","height","containerHeight","addAxis","updateStyles","$watch","updateData","error","x","orient","addOneAxis","pieHelpers","pieDefaults","w","margin","left","right","legend","show","size","svg","attr","addArc","$on","obtainEffectiveChartId","createLegend","setColors","pie","colors","lineHelpers","lineDefaults","factory","isEmpty","value","Object","keys","length","isUndefinedOrEmpty","isUndefined","isNumber","isString","isArray","isObject","isFunction","equals","o1","o2","safeApply","fn","phase","$root","$$phase","$eval","$apply","getCommonDefaults","idKey","heigth","top","bottom","gap","timeFormat","fontFamily","fontSize","tooltipSize","axis","stroke","color","label","fontWeight","showDefaultData","locale","animations","time","ease","d3","easeCubic","newDefaults","userDefaults","this","colorKey","extend","h","isNaN","css","userColors","defaultColors","scaleOrdinal","schemePaired","range","getDataFromScope","defaultData","getRandomString","chars","string_length","randomstring","i","rnum","Math","floor","random","substring","getRandomColor","r","g","b","rgb","d","chartId","hasOwnProperty","tree","defaults","getDefaults","scopeId","barId","getCreationDefaults","commonDefaults","series","bar","path","subcolors","colorInterpolator","tickFormat","tickSize","position","key","ticks","tickSubdivide","y","scale","direction","minFromZero","guidePosition","showValues","valuesColor","showPercent","percentColor","tooltip","pieId","radius","borderColor","pieAnimation","lineId","addXAxis","addYAxis","addSubdivideTicks","yl","yAxis","ylTopOffset","guide","append","xlLeftOffset","style","scaleBand","xAxis","warn","domain","map","rangeRound","paddingInner","scaleLog","clamp","scaleSqrt","scaleTime","scaleLinear","dy","round","log","LN10","multi","getMilliseconds","getSeconds","getMinutes","getHours","getDay","getDate","getMonth","_idFunction","debug","formatTime","mapFunction","e","parentId","xl","call","totals","max","v","Date","parse","push","min","undefined","abs","nice","yMaxPoints","x0","bandwidth","barsContainer","select","empty","idClip","updateBars","bars","update","transition","duration","attrTween","a","percentH","trans","inp","interpolateString","t","selectAll","darker","parentNode","percentW","format","fill","styleTween","brighter","returnColor","interpolateRgb","remove","text","barGroups","each","barGroup","enter","exit","interrupt","findNeighborArc","data0","data1","obj","m","k","j","findPreceding","copy","startAngle","endAngle","n","findFollowing","pathAnim","dir","easeBounce","arc","outerRadius","midAngle","outerArc","innerRadius","sort","filter","arcTween","$this","start","PI","_current","interpolate","_tweenPie","removeTooltip","lines","onTooltip","d2","pos","centroid","html","wrap","slices","dataSlices","pieData","arcs","on","narc","_previous","idx","previous","interpolateObject","setStyles","percentFormat","total","sum","items","item","currentX","currentY","iy","oldY","oldX","clientRect","node","getBoundingClientRect","legendNode","svgBBox","getBBox","wrapLabels","rect","behavior","scaleExtent","classed","word","words","split","reverse","line","lineNumber","parseFloat","dx","tspan","pop","join","getComputedTextLength","getTranslation","transform","document","createElementNS","setAttributeNS","matrix","baseVal","consolidate","f"],"mappings":";;;;CAAC,WAED,aAEAA,QAAQC,OAAO,oBAAqB,IAAIC,UAAU,QAAS,SAAUC,EAAMC,EAAWC,EAAYC,EAAYC,GAC7G,MAAO,CACNC,SAAU,KACVC,SAAS,EACTC,MAAO,CACNC,QAAS,WACTC,KAAM,SAEPC,SAAU,oCACVC,WAAY,SAASC,GACpBZ,EAAKa,KAAK,sCAAuCD,IAElDE,KAAM,SAASP,EAAOQ,EAASC,GAC9B,GAAIC,OAAJ,CAIAV,EAAMW,UAAYH,EAClBR,EAAMY,KAAO,MACbZ,EAAMa,YAAc,QACpB,IAAIC,EAAYpB,EAAUoB,UACzBb,EAAUJ,EAAYkB,YAAYf,EAAMC,QAASQ,EAAMO,IAExDtB,EAAUuB,QAAQT,EAASP,EAASQ,GAEpCb,EAAWsB,UAAUlB,EAAOC,GAC5BL,EAAWuB,UAAUnB,EAAOC,GACzBa,EAAUb,EAAQmB,OAASnB,EAAQmB,MACrCzB,EAAW0B,iBAAiBrB,EAAOJ,EAAW0B,eAE/C3B,EAAW4B,OAAOvB,EAAOQ,EAAQgB,IAAI,GAAIvB,GAEzCO,EAAQiB,MAAMxB,EAAQyB,gBACtBlB,EAAQmB,OAAO1B,EAAQ2B,iBAEvBhC,EAAWiC,QAAQ7B,EAAOC,GAC1BN,EAAWmC,aAAa9B,EAAOC,GAE/BD,EAAM+B,OAAO,OAAQ,WACpBnC,EAAWoC,WAAWhC,EAAOC,UAzB7BR,EAAKwC,MAAM,4BA+Bf3C,QAAQC,OAAO,qBAAqBC,UAAU,UAAW,SAAUC,EAAMC,EAAWC,EAAYC,EAAYC,GAC3G,MAAO,CACNC,SAAU,KACVC,SAAS,EACTC,MAAO,CACNC,QAAS,WACTC,KAAM,SAEPC,SAAU,sCACVC,WAAY,SAASC,GACpBZ,EAAKa,KAAK,+CAAgDD,IAE3DE,KAAM,SAASP,EAAOQ,EAASC,GAC9B,GAAIC,OAAJ,CAIAV,EAAMW,UAAYH,EAClBR,EAAMY,KAAO,aACbZ,EAAMa,YAAc,UACpB,IAAIC,EAAYpB,EAAUoB,UACzBb,EAAUJ,EAAYkB,YAAYf,EAAMC,QAASQ,EAAMO,IAExDtB,EAAUuB,QAAQT,EAASP,EAASQ,GAGpCR,EAAQiC,EAAEC,OAAS,aAEnBvC,EAAWsB,UAAUlB,EAAOC,GAC5BL,EAAWuB,UAAUnB,EAAOC,GACzBa,EAAUb,EAAQmB,OAASnB,EAAQmB,MACrCzB,EAAW0B,iBAAiBrB,EAAOJ,EAAW0B,eAE/C3B,EAAW4B,OAAOvB,EAAOQ,EAAQgB,IAAI,GAAIvB,GAEzCO,EAAQiB,MAAMxB,EAAQyB,gBACtBlB,EAAQmB,OAAO1B,EAAQ2B,iBAEvBhC,EAAWwC,WAAWpC,EAAOC,GAC7BN,EAAWmC,aAAa9B,EAAOC,GAE/BD,EAAM+B,OAAO,OAAQ,WACpBnC,EAAWoC,WAAWhC,EAAOC,UA5B7BR,EAAKwC,MAAM,4BAkCf3C,QAAQC,OAAO,qBAAqBC,UAAU,QAAS,SAAUC,EAAMC,EAAWC,EAAY0C,EAAYC,GACzG,MAAO,CACNxC,SAAU,KACVC,SAAS,EACTC,MAAO,CACNC,QAAS,WACTC,KAAM,SAEPC,SAAU,oCACVC,WAAY,SAASC,GACpBZ,EAAKa,KAAK,sCAAuCD,IAElDE,KAAM,SAASP,EAAOQ,EAASC,GAC9B,GAAIC,OAAJ,CAIAV,EAAMW,UAAYH,EAClBR,EAAMY,KAAO,MACbZ,EAAMa,YAAc,QACpB,IAAIZ,EAAUqC,EAAYvB,YAAYf,EAAMC,QAASQ,EAAMO,IAE3DtB,EAAUuB,QAAQT,EAASP,EAASQ,GAEpCd,EAAW4B,OAAOvB,EAAOQ,EAAQgB,IAAI,GAAIvB,GACzC,IAAIsC,EAAItC,EAAQwB,MAAQxB,EAAQuC,OAAOC,KAAOxC,EAAQuC,OAAOE,MAC7DH,GAAKtC,EAAQ0C,OAAOC,MAAgC,aAAxB3C,EAAQ0C,OAAO/B,KAAqBX,EAAQ0C,OAAOE,KAAK,EACpF7C,EAAM8C,IAAIC,KAAK,YAAa,aAAeR,EAAI,EAAI,IAAMtC,EAAQ0B,OAAS,EAAI,KAE9EU,EAAWW,OAAOhD,EAAOC,GAKzBD,EAAM+B,OAAO,OAAQ,WACpBM,EAAWL,WAAWhC,EAAOC,KAG9BD,EAAMiD,IAAI,gBAAkBX,EAAYY,uBAAuBzC,EAAMO,IAAK,WACzEqB,EAAWc,aAAanD,EAAOC,EAASP,EAAU0D,UAAUnD,EAAQoD,IAAIC,gBAzBxE7D,EAAKwC,MAAM,4BA+Bf3C,QAAQC,OAAO,qBAAqBC,UAAU,SAAU,SAAUC,EAAMC,EAAWC,EAAY4D,EAAaC,GAC3G,MAAO,CACN1D,SAAU,KACVC,SAAS,EACTC,MAAO,CACNC,QAAS,WACTC,KAAM,SAEPC,SAAU,qCACVC,WAAY,SAASC,GACpBZ,EAAKa,KAAK,uCAAwCD,IAEnDE,KAAM,SAASP,EAAOQ,EAASC,GAC9B,GAAIC,OAAJ,CAIAV,EAAMW,UAAYH,EAClBR,EAAMY,KAAO,OACbZ,EAAMa,YAAc,SAEpB,IAAIZ,EAAUuD,EAAazC,YAAYf,EAAMC,QAASQ,EAAMO,IAE5DtB,EAAUuB,QAAQT,EAASP,EAASQ,GAEpCd,EAAW4B,OAAOvB,EAAOQ,EAAQgB,IAAI,GAAIvB,GAEzCO,EAAQiB,MAAMxB,EAAQyB,gBACtBlB,EAAQmB,OAAO1B,EAAQ2B,sBAdtBnC,EAAKwC,MAAM,4BAmBf3C,QAAQC,OAAO,qBAAqBkE,QAAQ,YAAa,SAAUhE,GA+DlE,MAAO,CAENiE,QAAS,SAASC,GACjB,OAAqC,IAA9BC,OAAOC,KAAKF,GAAOG,QAI3BC,mBAAoB,SAAUJ,GAC7B,OAAQrE,QAAQ0E,YAAYL,IAAoB,OAAVA,GAAiD,IAA9BC,OAAOC,KAAKF,GAAOG,QAI7EhD,UAAW,SAAS6C,GACnB,OAAOrE,QAAQwB,UAAU6C,IAAoB,OAAVA,GAIpCM,SAAU,SAASN,GAClB,OAAOrE,QAAQ2E,SAASN,IAIzBO,SAAU,SAASP,GAClB,OAAOrE,QAAQ4E,SAASP,IAIzBQ,QAAS,SAASR,GACjB,OAAOrE,QAAQ6E,QAAQR,IAIxBS,SAAU,SAAST,GAClB,OAAOrE,QAAQ8E,SAAST,IAIzBU,WAAY,SAASV,GACpB,OAAOrE,QAAQ+E,WAAWV,IAI3BW,OAAQ,SAASC,EAAIC,GACpB,OAAOlF,QAAQgF,OAAOC,EAAIC,IAG3BC,UAAW,SAASpE,EAAQqE,GAC3B,IAAIC,EAAQtE,EAAOuE,MAAMC,QACX,WAAVF,GAAgC,YAAVA,EACzBtE,EAAOyE,MAAMJ,GAEbrE,EAAO0E,OAAOL,IAIhBM,kBAhGD,WACC,MAAO,CACNC,MAAO,KACPxD,MAAO,IACPyD,OAAQ,IACR9D,MAAM,EACNoB,OAAQ,CACPC,KAAM,GACNC,MAAO,GACPyC,IAAK,GACLC,OAAQ,IAETzC,OAAQ,CACPC,MAAM,EACNC,KAAM,IACNjC,KAAM,WACNyE,IAAK,IAENC,WAAY,WACZC,WAAY,QACZC,SAAU,SACVC,YAAa,IACbC,KAAM,CACL9C,MAAM,EACN+C,OAAQ,OACRC,MAAO,OACPC,MAAO,CACND,MAAO,OACPE,WAAY,QAEbA,WAAY,UAEbC,iBAAiB,EACjBC,OAAQ,KACRC,WAAY,CACXC,KAAM,IACNC,KAAMC,GAAGC,aA8DXtF,YAAa,SAASuF,EAAaC,GAC9BC,KAAK1F,UAAUyF,KAClBD,EAAYrB,MAAQuB,KAAK1F,UAAUyF,EAAatB,OAAUsB,EAAatB,MAAQqB,EAAYrB,MAC3FqB,EAAYG,SAAWD,KAAK1F,UAAUyF,EAAaE,UAAaF,EAAaE,SAAWH,EAAYG,SACpGH,EAAY7E,MAAQ+E,KAAK1F,UAAUyF,EAAa9E,OAAU8E,EAAa9E,MAAQ6E,EAAY7E,MAC3F6E,EAAYpB,OAASsB,KAAK1F,UAAUyF,EAAarB,QAAWqB,EAAarB,OAASoB,EAAYpB,OAC9FoB,EAAYlF,KAAOoF,KAAK1F,UAAUyF,EAAanF,MAASmF,EAAanF,KAAOkF,EAAYlF,KACxFkF,EAAYhB,WAAakB,KAAK1F,UAAUyF,EAAajB,YAAeiB,EAAajB,WAAagB,EAAYhB,WAC1GgB,EAAYf,WAAaiB,KAAK1F,UAAUyF,EAAahB,YAAegB,EAAahB,WAAae,EAAYf,WAC1Ge,EAAYd,SAAWgB,KAAK1F,UAAUyF,EAAaf,UAAae,EAAaf,SAAWc,EAAYd,SACpGc,EAAYb,YAAce,KAAK1F,UAAUyF,EAAad,aAAgBc,EAAad,YAAca,EAAYb,YAC7Ga,EAAYP,gBAAkBS,KAAK1F,UAAUyF,EAAaR,iBAAoBQ,EAAaR,gBAAkBO,EAAYP,gBACzHO,EAAYN,OAASQ,KAAK1F,UAAUyF,EAAaP,QAAWO,EAAaP,OAASM,EAAYN,OAE3FQ,KAAK1F,UAAUyF,EAAa/D,SAC9BlD,QAAQoH,OAAOJ,EAAY9D,OAAQ+D,EAAa/D,QAE9CgE,KAAK1F,UAAUyF,EAAa5D,SAC9BrD,QAAQoH,OAAOJ,EAAY3D,OAAQ4D,EAAa5D,QAG9C6D,KAAK1F,UAAUyF,EAAab,OAC9BpG,QAAQoH,OAAOJ,EAAYZ,KAAMa,EAAab,MAG5Cc,KAAK1F,UAAUyF,EAAaN,aAC9B3G,QAAQoH,OAAOJ,EAAYL,WAAYM,EAAaN,cAKvDhF,QAAS,SAAST,EAASP,EAASQ,GAEnC,IAAI8B,EAAIiE,KAAK1F,UAAUL,EAAMgB,OAAQhB,EAAMgB,MAAMxB,EAAQwB,MACxDkF,EAAIH,KAAK1F,UAAUL,EAAMkB,QAASlB,EAAMkB,OAAO1B,EAAQ0B,OAEpDiF,MAAMrE,GACT/B,EAAQqG,IAAI,QAAStE,GAErB/B,EAAQqG,IAAI,QAAStE,EAAI,MAGtBqE,MAAMD,GACTnG,EAAQqG,IAAI,SAAUF,GAEtBnG,EAAQqG,IAAI,SAAUF,EAAI,MAG3B1G,EAAQwB,MAAQjB,EAAQiB,QACxBxB,EAAQ0B,OAASnB,EAAQmB,UAG1ByB,UAAW,SAAS0D,EAAYC,GAC/B,IAAIzD,EAASyD,GAAiBX,GAAGY,aAAaZ,GAAGa,cAMjD,OALGT,KAAK1F,UAAUgG,KACjBxD,EAASkD,KAAKrC,QAAQ2C,GAAaV,GAAGY,eAAeE,MAAMJ,GAAYxD,EACvEA,EAASkD,KAAKtC,SAAS4C,GAAaV,GAAGY,eAAeE,MAAM,CAACJ,IAAaxD,EAC1EA,EAASkD,KAAKnC,WAAWyC,GAAaA,EAAWxD,GAE3CA,GAGR6D,iBAAkB,SAASnH,EAAOC,GACjC,IAAIC,EAAO,KASX,OARGsG,KAAKzC,mBAAmB/D,EAAME,OAASD,EAAQ8F,kBAChDS,KAAKzC,mBAAmB9D,EAAQmH,aACjClH,EAAOD,EAAQmH,YACNZ,KAAKtC,SAASlE,EAAME,QAG7BA,EAAOF,EAAME,MAEPA,GAGRmH,gBAAiB,SAASvD,GAIzB,IAHA,IAAIwD,EAAQ,gEACRC,EAAgBzD,GAAU,EAC1B0D,EAAe,GACVC,EAAI,EAAGA,EAAIF,EAAeE,IAAK,CACvC,IAAIC,EAAOC,KAAKC,MAAMD,KAAKE,SAAWP,EAAMxD,QAC5C0D,GAAgBF,EAAMQ,UAAUJ,EAAMA,EAAK,GAE5C,OAAOF,GAGNO,eAAgB,WAEjB,IAAIC,EAAIL,KAAKC,MAAoB,IAAdD,KAAKE,UACpBI,EAAIN,KAAKC,MAAoB,IAAdD,KAAKE,UACpBK,EAAIP,KAAKC,MAAoB,IAAdD,KAAKE,UAGxB,OAAOzB,GAAG+B,IAAIH,EAAEC,EAAEC,IAGnBhF,uBAvND,SAAiCkF,EAAGC,GACnC,IAAIrH,EAAIyG,EACR,GAAKnI,QAAQwB,UAAUuH,GAatBrH,EAAKqH,OAZL,GAA8B,IAA1BzE,OAAOC,KAAKuE,GAAGtE,OAClB,IAAK2D,KAAKW,EACLA,EAAEE,eAAeb,KACpBzG,EAAKyG,QAG6B,IAA1B7D,OAAOC,KAAKuE,GAAGtE,OACzB9C,EAAK,OAELvB,EAAKwC,MAAM,6FAMb,OAAOjB,MAyMT1B,QAAQC,OAAO,qBAAqBkE,QAAQ,cAAe,WAC1D,MAAO,CACN8E,KACC,6iNAIHjJ,QAAQC,OAAO,qBAAqBkE,QAAQ,cAAe,SAAU/D,GAsEpE,IAAIoB,EAAYpB,EAAUoB,UACzBoC,EAAyBxD,EAAUwD,uBACnCsF,EAAW,GAEZ,MAAO,CACNC,YAAa,SAAUC,GACtB,IAAIC,EAAQzF,EAAuBsF,EAAUE,GAC7C,OAAOF,EAASG,IAGjBC,oBAAqB,SAAUF,GAC9B,IAAIN,EAAI5B,KAAKiC,YAAYC,GAErB7I,EAAc,GAElB,OADAP,QAAQoH,OAAO7G,EAAauI,GACrBvI,GAGRkB,YAAa,SAASwF,EAAcmC,GACnC,IAvFGG,EAuFCvC,GAvFDuC,EAAiBnJ,EAAUsF,oBAC/B1F,QAAQoH,OAAOmC,EAAgB,CAC9BC,OAAQ,CAAC,IAAK,IAAK,IAAK,KACxBC,IAAK,CACJ1D,IAAK,GACL2D,KAAM,KACN1F,OAAQ8C,GAAGY,aAAaZ,GAAGa,cAC3BgC,UAAW,KAEXC,kBAAmB,MAEpBhH,EAAG,CACFiH,WAAY,KACZC,SAAU,EACVjH,OAAQ,aACRkH,SAAU,SACVC,IAAK,IACLzD,MAAO,IACP0D,MAAO,EACPC,cAAe,GAEhBC,EAAG,CACFC,MAAO,SACPP,WAAY,KACZC,SAAU,EACVjH,OAAQ,WACRkH,SAAU,OAEVM,UAAW,MACXL,IAAK,IACLzD,MAAO,IACP0D,MAAO,EACPC,cAAe,EACfI,aAAa,GAEdlE,KAAM,CAELmE,cAAe,MACfC,YAAY,EACZC,YAAa,OACbC,aAAa,EACbC,aAAc,OACdpE,MAAO,CACND,MAAO,OACPE,WAAY,QAEblD,MAAM,GAEPwE,YAAa,CAAC,CACbpG,GAAI,EACJkB,EAAG,SACHuH,EAAG,CAAE,GAAI,EAAG,KACZS,QAAS,kBACP,CACFlJ,GAAI,EACJkB,EAAG,aACHuH,EAAG,CAAE,GAAI,GAAI,IACbS,QAAS,sBACP,CACFlJ,GAAI,EACJkB,EAAG,OACHuH,EAAG,CAAE,IAAK,IAAK,KACfS,QAAS,mBAGJrB,GAwBF/H,EAAUyF,KACb7G,EAAUqB,YAAYuF,EAAaC,GAEhCzF,EAAUyF,EAAawC,MACzBzJ,QAAQoH,OAAOJ,EAAYyC,IAAKxC,EAAawC,KAG3CjI,EAAUyF,EAAarE,IACzB5C,QAAQoH,OAAOJ,EAAYpE,EAAGqE,EAAarE,GAGzCpB,EAAUyF,EAAakD,IACzBnK,QAAQoH,OAAOJ,EAAYmD,EAAGlD,EAAakD,GAGzC3I,EAAUwF,EAAYc,cACxB9H,QAAQoH,OAAOJ,EAAYc,YAAad,EAAYc,cAItD,IAAIuB,EAAQzF,EAAuBsF,EAAUE,GAE7C,OADAF,EAASG,GAASrC,MAMrBhH,QAAQC,OAAO,qBAAqBkE,QAAQ,cAAe,SAAU/D,GAwCpE,IAAIoB,EAAYpB,EAAUoB,UACzBoC,EAAyBxD,EAAUwD,uBACnCsF,EAAW,GAEZ,MAAO,CACNC,YAAa,SAAUC,GACtB,IAAIyB,EAAQjH,EAAuBsF,EAAUE,GAC7C,OAAOF,EAAS2B,IAGjBvB,oBAAqB,SAAUF,GAC9B,IAAIN,EAAI5B,KAAKiC,YAAYC,GAErBpG,EAAc,GAElB,OADAhD,QAAQoH,OAAOpE,EAAa8F,GACrB9F,GAGRvB,YAAa,SAASwF,EAAcmC,GACnC,IAzDGG,EAyDCvC,GAzDDuC,EAAiBnJ,EAAUsF,oBAC/B1F,QAAQoH,OAAOmC,EAAgB,CAC9BxF,IAAK,CACJC,OAAQ8C,GAAGY,aAAaZ,GAAGa,eAE5BmD,OAAQ,EACRlI,EAAG,CACFoH,IAAK,IACLzD,MAAO,IACPjD,MAAM,GAEP6G,EAAG,CACFH,IAAK,IACLzD,MAAO,KAERuB,YAAa,CAAC,CACbpG,GAAI,EACJkB,EAAG,SACHuH,EAAG,GACHS,QAAS,kBACP,CACFlJ,GAAI,EACJkB,EAAG,aACHuH,EAAG,GACHS,QAAS,sBACP,CACFlJ,GAAI,EACJkB,EAAG,OACHuH,EAAG,GACHS,QAAS,iBAEVF,aAAa,EACbK,YAAa,OACbC,aAAc,WAERzB,GAwBF/H,EAAUyF,KACb7G,EAAUqB,YAAYuF,EAAaC,GAEnCD,EAAY8D,OAAS1K,EAAUoB,UAAUyF,EAAa6D,QAAU7D,EAAa6D,OAAO9D,EAAY8D,OAChG9D,EAAY0D,YAActK,EAAUoB,UAAUyF,EAAayD,aAAezD,EAAayD,YAAY1D,EAAY0D,YAC/G1D,EAAY+D,YAAc3K,EAAUoB,UAAUyF,EAAa8D,aAAe9D,EAAa8D,YAAY/D,EAAY+D,YAC/G/D,EAAYgE,aAAe5K,EAAUoB,UAAUyF,EAAa+D,cAAgB/D,EAAa+D,aAAahE,EAAYgE,aAE/GxJ,EAAUyF,EAAalD,MACzB/D,QAAQoH,OAAOJ,EAAYjD,IAAKkD,EAAalD,KAG3CvC,EAAUyF,EAAarE,IACzB5C,QAAQoH,OAAOJ,EAAYpE,EAAGqE,EAAarE,GAGzCpB,EAAUyF,EAAakD,IACzBnK,QAAQoH,OAAOJ,EAAYmD,EAAGlD,EAAakD,GAGzC3I,EAAUwF,EAAYc,cACxB9H,QAAQoH,OAAOJ,EAAYc,YAAad,EAAYc,cAItD,IAAI+C,EAAQjH,EAAuBsF,EAAUE,GAE7C,OADAF,EAAS2B,GAAS7D,GAInBpD,uBAAwB,SAASwF,GAChC,OAAOxF,EAAuBsF,EAAUE,OAK3CpJ,QAAQC,OAAO,qBAAqBkE,QAAQ,eAAgB,SAAU/D,GAuDrE,IAAIoB,EAAYpB,EAAUoB,UACzBoC,EAAyBxD,EAAUwD,uBACnCsF,EAAW,GAEZ,MAAO,CACNC,YAAa,SAAUC,GACtB,IAAI6B,EAASrH,EAAuBsF,EAAUE,GAC9C,OAAOF,EAAS+B,IAGjB3B,oBAAqB,SAAUF,GAC9B,IAAIN,EAAI5B,KAAKiC,YAAYC,GAErBlF,EAAe,GAEnB,OADAlE,QAAQoH,OAAOlD,EAAc4E,GACtB5E,GAGRzC,YAAa,SAASwF,EAAcmC,GACnC,IAxEGG,EAwECvC,GAxEDuC,EAAiBnJ,EAAUsF,oBAC/B1F,QAAQoH,OAAOmC,EAAgB,CAC9BC,OAAQ,CAAC,IAAK,IAAK,IAAK,KACxB5G,EAAG,CACFwH,MAAO,SACPP,WAAY,KACZC,SAAU,EACVjH,OAAQ,SACRkH,SAAU,SACVC,IAAK,IACLzD,MAAO,IACP0D,MAAO,EACPC,cAAe,GAEhBC,EAAG,CACFC,MAAO,SACPP,WAAY,KACZC,SAAU,EACVjH,OAAQ,OACRkH,SAAU,OACVC,IAAK,IACLzD,MAAO,IACP0D,MAAO,EACPC,cAAe,GAEhB9D,KAAM,CACLqE,YAAa,OACbE,aAAc,OACdpE,MAAO,CACND,MAAO,OACPE,WAAY,SAGdsB,YAAa,CAAC,CACbpG,GAAI,EACJkB,EAAG,SACHuH,EAAG,CAAE,GAAI,EAAG,KACZS,QAAS,kBACP,CACFlJ,GAAI,EACJkB,EAAG,aACHuH,EAAG,CAAE,GAAI,GAAI,IACbS,QAAS,sBACP,CACFlJ,GAAI,EACJkB,EAAG,OACHuH,EAAG,CAAE,IAAK,IAAK,KACfS,QAAS,mBAGJrB,GAwBF/H,EAAUyF,KACb7G,EAAUqB,YAAYuF,EAAaC,GAEhCzF,EAAUyF,EAAarE,IACzB5C,QAAQoH,OAAOJ,EAAYpE,EAAGqE,EAAarE,GAGzCpB,EAAUyF,EAAakD,IACzBnK,QAAQoH,OAAOJ,EAAYmD,EAAGlD,EAAakD,GAGzC3I,EAAUwF,EAAYc,cACxB9H,QAAQoH,OAAOJ,EAAYc,YAAad,EAAYc,cAItD,IAAImD,EAASrH,EAAuBsF,EAAUE,GAE9C,OADAF,EAAS+B,GAAUjE,MAMtBhH,QAAQC,OAAO,qBAAqBkE,QAAQ,aAAc,SAAUhE,EAAMC,EAAWC,GA2BpF,MAAO,CACNkC,QAAS,SAAS7B,EAAOC,GACxBN,EAAW6K,SAASxK,EAAOC,GAC3BN,EAAW8K,SAASzK,EAAOC,GAC3BN,EAAW+K,kBAAkB1K,EAAM2K,GAAI3K,EAAMyJ,EAAGzJ,EAAM4K,MAAO3K,EAAQwJ,IAGtErH,WAAY,SAASpC,EAAOC,GAC3BN,EAAW6K,SAASxK,EAAOC,GAC3BD,EAAM6K,YAAqC,QAAvB5K,EAAQiC,EAAEmH,SAAmC,KAAfpJ,EAAQ0B,OAA4B,GAAf1B,EAAQ0B,OAE/E3B,EAAM8K,MAAQ9K,EAAM8C,IAAIiI,OAAO,KAC7BhI,KAAK,QAAS,SAEhB,IAAI8G,EAC4B,WAA/B5J,EAAQyF,KAAKmE,cAA2C,EAAf5J,EAAQ0B,OAAU3B,EAAM6K,YAA6B,IAAf5K,EAAQ0B,OACxF3B,EAAM8K,MACJC,OAAO,QACPhI,KAAK,KAAM/C,EAAMgL,cACjBjI,KAAK,KAAM9C,EAAQwB,MAAQzB,EAAMgL,cACjCjI,KAAK,KAAM8G,GACX9G,KAAK,KAAM8G,GACXoB,MAAM,SAAU,QAChBA,MAAM,eAAgB,GACtBA,MAAM,kBAAmB,eAG5B/J,UAAW,SAASlB,EAAOC,GAC1BD,EAAMkC,EAAIkE,GAAG8E,YACblL,EAAMkC,EACJgF,MAAM,CAAC,EAAGjH,EAAQwB,QAEhB/B,EAAUoB,UAAUd,EAAMmL,OAQ7BnL,EAAMmL,MAAMzB,MAAM1J,EAAMkC,IAPpBxC,EAAUoB,UAAUb,EAAQiC,EAAEC,SAAYzC,EAAUwE,SAASjE,EAAQiC,EAAEC,UACpD,eAArBlC,EAAQiC,EAAEC,QAAgD,YAArBlC,EAAQiC,EAAEC,UAChD1C,EAAK2L,KAAK,mFACVnL,EAAQiC,EAAEC,OAAS,cAEpBnC,EAAMmL,MAAQ/E,GAAGnG,EAAQiC,EAAEC,QAAQnC,EAAMkC,IAKvCxC,EAAUoB,UAAUb,EAAQiC,EAAEkH,WAAa1J,EAAUuE,SAAShE,EAAQiC,EAAEkH,YAG1E3J,EAAK2L,KAAK,qEACVnL,EAAQiC,EAAEkH,SAAW,GAHrBpJ,EAAMmL,MAAM/B,SAASnJ,EAAQiC,EAAEkH,UAOhC,IAAIlJ,EAAQR,EAAUyH,iBAAiBnH,EAAOC,GAC9CD,EAAMkC,EACJmJ,OAAOnL,EAAKoL,IAAI,SAASlD,GAAK,OAAOA,EAAEnI,EAAQiC,EAAEoH,QACjDiC,WAAW,CAAC,EAAGtL,EAAQwB,QACvB+J,aAAavL,EAAQ8I,IAAI1D,KAC3BrF,EAAMmL,MAAMhC,WAAWlJ,EAAQiC,EAAEiH,YAC9BzJ,EAAUoB,UAAUd,EAAME,OAC5BsG,KAAKxE,WAAWhC,EAAME,KAAMD,IAI9BkB,UAAW,SAASnB,EAAOC,GAC1B,OAAOA,EAAQwJ,EAAEC,OAChB,IAAK,MACJ1J,EAAMyJ,EAAIrD,GAAGqF,WAAWC,OAAM,GAC9B,MACD,IAAK,OACJ1L,EAAMyJ,EAAIrD,GAAGuF,YACb,MACD,IAAK,OACJ3L,EAAMyJ,EAAIrD,GAAGwF,YACb,MACD,QACwB,WAApB3L,EAAQwJ,EAAEC,QACZjK,EAAK2L,KAAK,kHACVnL,EAAQwJ,EAAEC,MAAQ,UAEnB1J,EAAMyJ,EAAIrD,GAAGyF,cAIf,IAAIC,EAAK,EA+BT,OA9BkB,eAAf9L,EAAMY,OACRkL,EAAoB,GAAf7L,EAAQ0B,OAEqB,WAA/B1B,EAAQyF,KAAKmE,gBACfiC,GAAqB,IAAf7L,EAAQ0B,SAGW,QAAxB1B,EAAQwJ,EAAEE,UACZ3J,EAAMyJ,EAAEvC,MAAM,CAACjH,EAAQ0B,OAASmK,EAAI,IAEpC9L,EAAMyJ,EAAEvC,MAAM,CAAC,EAAGjH,EAAQ0B,OAASmK,IAEhCpM,EAAUoB,UAAUd,EAAM4K,OAO7B5K,EAAM4K,MAAMlB,MAAM1J,EAAMyJ,IANpB/J,EAAUoB,UAAUb,EAAQwJ,EAAEtH,SAAYzC,EAAUwE,SAASjE,EAAQwJ,EAAEtH,UAC1E1C,EAAK2L,KAAK,6EACVnL,EAAQwJ,EAAEtH,OAAS,YAEpBnC,EAAM4K,MAAQxE,GAAGnG,EAAQwJ,EAAEtH,QAAQnC,EAAMyJ,IAKvC/J,EAAUoB,UAAUb,EAAQwJ,EAAEL,WAAa1J,EAAUuE,SAAShE,EAAQwJ,EAAEL,YAG1E3J,EAAK2L,KAAK,qEACVnL,EAAQwJ,EAAEL,SAAW,GAHrBpJ,EAAM4K,MAAMxB,SAASnJ,EAAQwJ,EAAEL,UAOzBnJ,EAAQwJ,EAAEC,OAChB,IAAK,MACAhK,EAAUoB,UAAUb,EAAQwJ,EAAEN,cACjClJ,EAAQwJ,EAAEN,WAAa,SAASf,GAE/B,OADWhC,GAAG2F,MAAMpE,KAAKqE,IAAI5D,GAAGT,KAAKsE,KAAM,GAC/B,GAAM,EAAG7D,EAAE,KAGzBpI,EAAM4K,MAAMrB,MAAMtJ,EAAQwJ,EAAEF,OAC5BvJ,EAAMyJ,EAAE4B,OAAO,CAAC,GAAK,MACrB,MACD,IAAK,OACJ,IAAI3L,EAAUoB,UAAUb,EAAQwJ,EAAEN,YAAa,CAC9C,IAAInD,EAAStG,EAAUoB,UAAUb,EAAQ+F,QAAS/F,EAAQ+F,OAAOV,WAAWc,GAAGd,WAC/ErF,EAAQwJ,EAAEN,WAAanD,EAAOkG,MAAM,CACnC,CAAC,MAAO,SAAS9D,GAAK,OAAOA,EAAE+D,oBAC/B,CAAC,MAAO,SAAS/D,GAAK,OAAOA,EAAEgE,eAC/B,CAAC,QAAS,SAAShE,GAAK,OAAOA,EAAEiE,eACjC,CAAC,QAAS,SAASjE,GAAK,OAAOA,EAAEkE,aACjC,CAAC,QAAS,SAASlE,GAAK,OAAOA,EAAEmE,UAA4B,IAAhBnE,EAAEoE,YAC/C,CAAC,QAAS,SAASpE,GAAK,OAAuB,IAAhBA,EAAEoE,YACjC,CAAC,KAAM,SAASpE,GAAK,OAAOA,EAAEqE,aAC9B,CAAC,KAAM,WAAa,OAAO,MAG7BzM,EAAM4K,MAAMrB,MAAMtJ,EAAQwJ,EAAEF,OAC5B,MACD,QACCvJ,EAAM4K,MAAMrB,MAAMtJ,EAAQwJ,EAAEF,MAAQtJ,EAAQwJ,EAAEF,MAAQtJ,EAAQwJ,EAAED,eAChExJ,EAAMyJ,EAAE4B,OAAO,CAAC,EAAG,MAGrBrL,EAAM4K,MAAMzB,WAAWlJ,EAAQwJ,EAAEN,YAC9BzJ,EAAUoB,UAAUd,EAAME,OAC5BsG,KAAKxE,WAAWhC,EAAME,KAAMD,IAI9BqB,cAAe,aAGfU,WAAY,SAAShC,EAAOC,GAC3B,GAAIP,EAAUoB,UAAUd,EAAMkC,IAAOxC,EAAUoB,UAAUd,EAAMyJ,GAA/D,CAGA,IAAIvJ,EAAOR,EAAUyH,iBAAiBnH,EAAOC,GACzCyM,EAAc,SAAStE,GAC1B,OAAOA,EAAEnI,EAAQgF,QAElB,GAAGvF,EAAUqE,mBAAmB7D,GAC/BT,EAAK2L,KAAK,uCADX,CAIA3L,EAAKkN,MAAM,gCAAiCzM,GAE5C,IAAI0M,EAAaxG,GAAGd,WAAWrF,EAAQqF,YACnChC,EAAS5D,EAAU0D,UAAUnD,EAAQ8I,IAAIzF,QAEzCuJ,EAAc,SAASzE,GAC1B,OAAOA,EAAEnI,EAAQwJ,EAAEH,KAAKgC,IAAI,SAASwB,EAAGrF,GACvC,MAAO,CACNzG,GAAIyG,EACJsF,SAAU3E,EAAEnI,EAAQgF,OACpB/C,EAAGkG,EAAEnI,EAAQiC,EAAEoH,KACfG,EAAGqD,MAKFzB,EAASnL,EAAKoL,IAAI,SAASlD,GAAK,OAAOA,EAAEnI,EAAQiC,EAAEoH,OACvDtJ,EAAMkC,EAAEmJ,OAAOA,GACfrL,EAAMgN,GAAGC,KAAKjN,EAAMmL,OACpB1L,EAAKkN,MAAM,2BAA4BtB,GAEvC,IAAI6B,EAAS,GACTC,EAAM/G,GAAG+G,IAAIjN,EAAM,SAASkI,GAC/B,OAAOhC,GAAG+G,IAAI/E,EAAEnI,EAAQwJ,EAAEH,KAAM,SAAS8D,EAAG3F,GAS3C,MARuB,SAApBxH,EAAQwJ,EAAEC,OAAsB0D,aAAaC,OAC/CD,EAAIR,EAAWU,MAAMF,IAElB1N,EAAUoB,UAAUoM,EAAOzF,IAG9ByF,EAAOzF,IAAM2F,EAFbF,EAAOK,KAAKH,GAINA,MAILI,EAAM,EAENvN,EAAQwJ,EAAEG,cACb4D,EAAMpH,GAAGoH,IAAItN,EAAM,SAASkI,GAC3B,OAAOhC,GAAGoH,IAAIpF,EAAEnI,EAAQwJ,EAAEH,SAI5B7J,EAAKkN,MAAM,oCAAqCQ,QAErCM,IAARD,QAA6BC,IAARN,GAA8B,IAARK,GAAqB,IAARL,GAC1DK,EAAM,EACNL,EAA0B,SAApBlN,EAAQwJ,EAAEC,MAAkB,IAAI2D,KAAO,KACnCG,EAAML,GAAS,IACzBK,EAAMA,aAAeH,KAAM,EAAGG,EAAM7F,KAAK+F,IAAIF,EAAI,GACjDL,EAAMA,aAAeE,KAAMF,EAAKA,EAAMxF,KAAK+F,IAAIP,EAAI,IAGpDnN,EAAMyJ,EAAE4B,OAAO,CAACmC,EAAKL,IAClBK,EAAML,GACRnN,EAAMyJ,EAAEkE,OAGS,QAAf3N,EAAMY,OACRZ,EAAM2K,GAAGsC,KAAKjN,EAAM4K,OACpBjL,EAAW+K,kBAAkB1K,EAAM2K,GAAI3K,EAAMyJ,EAAGzJ,EAAM4K,MAAO3K,EAAQwJ,IAGnE/J,EAAUoB,UAAUd,EAAMoB,OAAS1B,EAAUoB,UAAUb,EAAQmB,OAASnB,EAAQmB,KAInF,IAAIwM,EAAaxH,GAAG+G,IAAIjN,EAAKoL,IAAI,SAASlD,GAAI,OAAOA,EAAEnI,EAAQwJ,EAAEH,KAAKxF,UAClE+J,EAAKzH,GAAG8E,YACVG,OAAOjF,GAAGc,MAAM0G,IAChBrC,WAAW,CAAC,EAAGvL,EAAMkC,EAAE4L,cAErBC,EAAgB/N,EAAM8C,IAAIkL,OAAO,KAAOhO,EAAMa,YAAc,SAC7DkN,EAAcE,UAChBF,EAAgB/N,EAAM8C,IAAIiI,OAAO,KAC/BhI,KAAK,YAAa,aAAe/C,EAAMgL,aAAe,IAAMhL,EAAM6K,YAAc,KAChF9H,KAAK,QAAS/C,EAAMa,YAAc,SAClCkC,KAAK,YAAa,QAAQ/C,EAAMkO,OAAO,MAG1C,IAAIC,EAAa,SAASC,EAAMC,GAC5B3O,EAAUoB,UAAUb,EAAQ8I,IAAIC,OAClCoF,EACEE,aACAC,SAAStO,EAAQgG,WAAWC,MAC5BsI,UAAU,YAAa,SAASpG,EAAGX,EAAGgH,GACtC,IACIC,EAAW/G,KAAK+F,KAAK1N,EAAMyJ,EAAErB,EAAEqB,GAAKzJ,EAAMyJ,EAAE+D,IAD/B,KAGbmB,EAAQ,cAAgB3O,EAAMkC,EAAEkG,EAAElG,GAAK2L,EAAGpG,GAAK,IAAIiH,EAAS,EAAIb,EAAGC,YAAY,GAAK,OACpFc,EAAMxI,GAAGyI,kBAAkBJ,EAAGE,GAClC,OAAO,SAASG,GACf,OAAOF,EAAIE,OAKbV,EADEC,EACKD,EAAKW,UAAU,QAEfX,EAAKrD,OAAO,QACjBhI,KAAK,IAAK9C,EAAQ8I,IAAIC,MACtBjG,KAAK,QAAS,kBACdA,KAAK,YAAa,WAClBA,KAAK,YAAa,YAClBkI,MAAM,UAAW,IAIlBA,MAAM,OAAQ,SAAS7C,EAAGX,GAE1B,OADYrB,GAAG+B,IAAI7E,EAAOmE,MAG1BwD,MAAM,SAAU,SAAS7C,EAAGX,GAC5B,OAAOrB,GAAG+B,IAAI7E,EAAOmE,IAAIuH,WAEzB/D,MAAM,eAAgB,GACtBqD,aACAnI,KAAKlG,EAAQgG,WAAWE,MACxBoI,SAAStO,EAAQgG,WAAWC,MAC5BsI,UAAU,YAAa,SAASpG,EAAGX,EAAGgH,GACtCrG,EAAIhC,GAAG4H,OAAOxH,KAAKyI,YAAY/O,OAAO,GACtC,IAAIgP,EAAWrB,EAAGC,YAAY,IAC1BY,EAAW/G,KAAK+F,KAAK1N,EAAMyJ,EAAErB,EAAEqB,GAAKzJ,EAAMyJ,EAAE+D,IAAM,KACtD,OAAOpH,GAAGyI,kBAAkBJ,EAAG,SAAWS,EAAW,KAAOR,EAAW,OAEvEzD,MAAM,UAAW,KAEnBmD,EACErL,KAAK,QAAS8K,EAAGC,aACjB/K,KAAK,QAAS,SAASqF,GACvB,IAAI+G,EAAS/I,GAAG+I,OAAO,MAIvB,OAHGzP,EAAUoB,UAAUb,EAAQwJ,EAAEN,cAChCgG,EAASlP,EAAQwJ,EAAEN,YAEbgG,EAAO/G,EAAEqB,KAEhB1G,KAAK,IAAK,SAASqF,EAAGX,GACtB,IAAIvF,EAAIlC,EAAMkC,EAAEkG,EAAElG,GAAK2L,EAAGpG,GAC1B,OAAOb,MAAM1E,GAAI,EAAEA,IAEnBa,KAAK,IAAK,WACV,IAAI4D,EAAIP,GAAG4H,OAAOxH,MAAMzD,KAAK,UAE7B,MADiC,QAAxB9C,EAAQwJ,EAAEE,UAAqB3J,EAAMyJ,EAAE,GAAG9C,EAAE,IAGrD5D,KAAK,SAAU,WACf,IAAI4D,EAAIP,GAAG4H,OAAOxH,MAAMzD,KAAK,UAC7B,OAAO4D,GAAK,IAGZsE,MAAM,OAAQ,WACd,IAAImE,EAAOhJ,GAAG4H,OAAOxH,MAAMyE,MAAM,QACjC,MAAgB,iBAATmE,EACNhJ,GAAG+B,IAAI,IAAI,IAAI,KAAKiH,IAErBd,aACAnI,KAAKlG,EAAQgG,WAAWE,MACxBoI,SAAStO,EAAQgG,WAAWC,MAC5BnD,KAAK,SAAU,SAASqF,GACxB,OAAOT,KAAK+F,IAAI1N,EAAMyJ,EAAErB,EAAEqB,GAAKzJ,EAAMyJ,EAAE+D,MAEvCzK,KAAK,IAAK,SAASqF,GACnB,IAAIzB,EAAIgB,KAAK+F,IAAI1N,EAAMyJ,EAAErB,EAAEqB,GAAKzJ,EAAMyJ,EAAE+D,IAExC,MADiC,QAAxBvN,EAAQwJ,EAAEE,UAAqB3J,EAAMyJ,EAAE,GAAG9C,EAAE,IAWrD0I,WAAW,OAAQ,SAASjH,EAAGX,EAAGgH,GAClC,IAAI7I,EAAQQ,GAAG+B,IAAI7E,EAAOmE,IAEvB/H,EAAUoB,UAAUb,EAAQ8I,IAAIG,oBAAsBxJ,EAAU2E,WAAWpE,EAAQ8I,IAAIG,qBAEzFtD,EADM3F,EAAQ8I,IAAIG,kBAAkBtD,EAAM0J,WAAY1J,EAAMoJ,SACpDJ,CAAIxG,EAAEqB,EAAE0D,IAIjB,IAAIoC,EAAc7P,EAAUoB,UAAUb,EAAQ8I,IAAIE,WAAYhJ,EAAQ8I,IAAIE,UAAUb,EAAE2E,SAAS,GAAGnH,EAElG,OADMQ,GAAGoJ,eAAef,EAAGc,KAK9BnB,EAAKJ,OAAO,SAASyB,SACrBrB,EAAKrD,OAAO,SACV2E,KAAK,SAAStH,GACd,IAAI+G,EAAS/I,GAAG+I,OAAO,OAIvB,OAHGzP,EAAUoB,UAAUb,EAAQwJ,EAAEN,cAChCgG,EAASlP,EAAQwJ,EAAEN,YAEbgG,EAAO/G,EAAEqB,MAIfkG,EAAY5B,EACdgB,UAAU,IAAM/O,EAAMa,YAAc,cACpCX,KAAKA,EAAMwM,GAGbiD,EAAUC,KAAK,SAASxH,GACvB,IAAIyH,EAAWzJ,GAAG4H,OAAOxH,MACrB4H,EAAOyB,EACTd,UAAU,IAAM/O,EAAMa,YAAc,QACpCX,KAAK,WAEL,OADc2M,EAAYzE,IAExB,SAASA,GACX,OAAOA,EAAEpH,KAIXmN,EAAWC,GAAM,GACjBA,EACE0B,QACA/E,OAAOrL,EAAUoB,UAAUb,EAAQ8I,IAAIC,MAAO,IAAI,QAClDjG,KAAK,QAAS/C,EAAMa,YAAc,QACpCsN,EAAWC,GAAM,GACjBA,EAAK2B,OAAON,SACZrB,EAAOyB,EACLd,UAAU,IAAM/O,EAAMa,YAAc,QACtCsN,EAAWC,GAAM,KAIlB,IAAItF,EAAS6G,EAAUG,QACrB/E,OAAO,KACPhI,KAAK,QAAS/C,EAAMa,YAAc,cAEhCuN,EAAOtF,EAAOiG,UAAU,IAAM/O,EAAMa,YAAc,QACpDX,KAAK2M,EAAa,SAASzE,GAC3B,OAAOA,EAAEpH,KAGT8O,QACA/E,OAAOrL,EAAUoB,UAAUb,EAAQ8I,IAAIC,MAAO,IAAI,QAClDjG,KAAK,QAAS/C,EAAMa,YAAc,QAMpC,GALAsN,EAAWC,GAGXuB,EAAUI,OAAON,SAEC,eAAfzP,EAAMY,KACRZ,EAAM8C,IAAIkL,OAAO,KAAOhO,EAAMa,YAAa,aAAa4O,SAWxD3G,EATwB9I,EAAM8C,IAAIiI,OAAO,KACvChI,KAAK,YAAa,aAAe/C,EAAMgL,aAAe,KACrDhL,EAAM6K,aAAsC,WAAvB5K,EAAQiC,EAAEmH,SAAsC,IAAfpJ,EAAQ0B,OAA4B,KAAf1B,EAAQ0B,SAAgB,KACpGoB,KAAK,QAAS/C,EAAMa,YAAc,aAEDkO,UAAU,IAAM/O,EAAMa,YAAc,WACrEX,KAAKA,EAAMwM,GACXsD,YAEkBF,QAClB/E,OAAO,KACPhI,KAAK,QAAS/C,EAAMa,YAAc,WAEjCZ,EAAQyF,KAAKoE,YACfhB,EAAOiG,UAAU,IAAM/O,EAAMa,YAAc,QACzCX,KAAK2M,EAAa,SAASzE,GAC3B,OAAOA,EAAEpH,KAETgP,YACAF,QACA/E,OAAO,QACPhI,KAAK,IAAK,SAASqF,EAAGX,GACtB,OAAOzH,EAAMkC,EAAEkG,EAAElG,GAAK2L,EAAGpG,GAAKoG,EAAGC,YAAY,IAE7C/K,KAAK,KAAO9C,EAAQyF,KAAKsE,YAAqB,EAAR,SACtCjH,KAAK,QAAS/C,EAAMa,YAAc,QAClCoK,MAAM,cAAe,UACrBA,MAAM,OAAQhL,EAAQyF,KAAKqE,aAC3B2F,KAAK,SAAStH,GAEd,OADahC,GAAG+I,OAAO,MAChBA,CAAO/G,EAAEqB,KAIhBxJ,EAAQyF,KAAKsE,aACflB,EAAOiG,UAAU,IAAM/O,EAAMa,YAAc,YACzCX,KAAK2M,EAAa,SAASzE,GAC3B,OAAOA,EAAEpH,KAETgP,YACAF,QACA/E,OAAO,QACPhI,KAAK,IAAK,SAASqF,EAAGX,GACtB,OAAOzH,EAAMkC,EAAEkG,EAAElG,GAAK2L,EAAGpG,GAAKoG,EAAGC,YAAY,IAE7C/K,KAAK,IAAoB,KAAf9C,EAAQ0B,QAClBoB,KAAK,KAAO9C,EAAQyF,KAAKoE,WAAqB,EAAT,UACrC/G,KAAK,QAAS/C,EAAMa,YAAc,YAClCoK,MAAM,cAAe,UACrBA,MAAM,YAAa,UACnBA,MAAM,cAAe,QACrBA,MAAM,OAAQhL,EAAQyF,KAAKuE,cAC3ByF,KAAK,SAAStH,EAAGX,GAEjB,OADarB,GAAG+I,OAAO,MAChBA,CAAO/G,EAAEqB,EAAEyD,EAAOzF,MAK7B9H,EAAWmC,aAAa9B,EAAOC,SAKlCX,QAAQC,OAAO,qBAAqBkE,QAAQ,aAAc,SAAUhE,EAAMC,EAAWC,GA2DpF,SAASsQ,EAAgBxI,EAAGyI,EAAOC,EAAO7G,GACvC,IAAIlB,EACFgI,EACF,OAAGhI,EA5BN,SAAuBX,EAAGyI,EAAOC,EAAO7G,GAEvC,IADA,IAAI+G,EAAIH,EAAMpM,OACA,KAAL2D,GAER,IADA,IAAI6I,EAAIhH,EAAI6G,EAAM1I,IACT8I,EAAI,EAAGA,EAAIF,IAAKE,EACxB,GAAIjH,EAAI4G,EAAMK,MAAQD,EACrB,OAAOJ,EAAMK,GAsBPC,CAAc/I,EAAGyI,EAAOC,EAAO7G,MACpC8G,EAAM9Q,QAAQmR,KAAKrI,IACfsI,WAAatI,EAAEuI,SACZP,IACChI,EAnBb,SAAuBX,EAAGyI,EAAOC,EAAO7G,GAEvC,IADA,IAAIsH,EAAIT,EAAMrM,OAAQuM,EAAIH,EAAMpM,SACvB2D,EAAImJ,GAEZ,IADA,IAAIN,EAAIhH,EAAI6G,EAAM1I,IACT8I,EAAI,EAAGA,EAAIF,IAAKE,EACxB,GAAIjH,EAAI4G,EAAMK,MAAQD,EACrB,OAAOJ,EAAMK,GAaAM,CAAcpJ,EAAGyI,EAAOC,EAAO7G,MAC3C8G,EAAM9Q,QAAQmR,KAAKrI,IACfuI,SAAWvI,EAAEsI,WACVN,GAEF,KAGV,IAAIU,EAAW,SAAS9H,EAAM+H,EAAK9Q,GAClC,OAAO8Q,GACN,KAAK,EACJ/H,EACEiC,MAAM,SAAU,MAChBqD,WAAW,iBACXC,SAAS,KACTpI,KAAKC,GAAG4K,YACR/F,MAAM,iBAAkB,GACxBA,MAAM,eAAgB,GACtBlI,KAAK,IAAKqD,GAAG6K,MACZC,YAA6B,GAAjBjR,EAAQmK,SAEvB,MACD,KAAK,EAcL,KAAK,EACJpB,EACEiC,MAAM,SAAU,WAChB,OAAO7E,GAAGR,MAAMQ,GAAG4H,OAAOxH,MAAMzD,KAAK,SAASiM,WAE9C/D,MAAM,iBAAkB,GACxBA,MAAM,eAAgB,GACtBqD,WAAW,iBACXrD,MAAM,iBAAkB,GACxBA,MAAM,eAAgB,GACtBlI,KAAK,IAAKqD,GAAG6K,MACZC,YAA6B,IAAjBjR,EAAQmK,WAMtB+G,EAAW,SAAS/I,GACvB,OAAOA,EAAEsI,YAActI,EAAEuI,SAAWvI,EAAEsI,YAAY,GAenD,MAAO,CACN1N,OAAQ,SAAShD,EAAOC,GACvB,IAAIsC,EAAItC,EAAQwB,MAAQxB,EAAQuC,OAAOC,KAAOxC,EAAQuC,OAAOE,MAC1DzC,EAAQ0C,OAAOC,MAAgC,aAAxB3C,EAAQ0C,OAAO/B,OACxC2B,GAAKtC,EAAQ0C,OAAOE,MAErB,IAAI8D,EAAI1G,EAAQ0B,OAAS1B,EAAQuC,OAAO2C,IAAMlF,EAAQuC,OAAO4C,OAC7DnF,EAAQmK,OAASzC,KAAK6F,IAAIjL,EAAGoE,GAAK,EAClC3G,EAAMiR,IAAM7K,GAAG6K,MACbC,YAA6B,GAAjBjR,EAAQmK,QAEtBpK,EAAMoR,SAAWhL,GAAG6K,MAClBI,YAA6B,EAAjBpR,EAAQmK,QACpB8G,YAA6B,EAAjBjR,EAAQmK,QAEtBpK,EAAMqD,IAAM+C,GAAG/C,MACbM,MAAM,SAASyE,GAAK,OAAOA,EAAEnI,EAAQwJ,EAAEH,OACrCgI,KAAK,MAITtR,EAAM8C,IAAIiI,OAAO,KAAKhI,KAAK,QAAS/C,EAAMa,YAAc,WACxDb,EAAM8C,IAAIiI,OAAO,KAAKhI,KAAK,QAAS/C,EAAMa,YAAc,cACtDb,EAAM8C,IAAIiI,OAAO,KAAKhI,KAAK,QAAS/C,EAAMa,YAAc,WAI3DmB,WAAY,SAAShC,EAAOC,GAC3BR,EAAKkN,MAAM,eAEX,IAAIrJ,EAAS5D,EAAU0D,UAAUnD,EAAQoD,IAAIC,QACzCpD,EAAOR,EAAUyH,iBAAiBnH,EAAOC,GAK7C,GAJAC,EAAOA,EAAKqR,OAAO,SAASnJ,GAC3B,OAAO1I,EAAUoB,UAAUsH,EAAEnI,EAAQwJ,EAAEH,QAAU1C,MAAMwB,EAAEnI,EAAQwJ,EAAEH,QAGjE5J,EAAUqE,mBAAmB7D,GAC/BT,EAAK2L,KAAK,sCADX,CAMA,IAAI9B,EAAM,SAASlB,GAClB,OAAG9I,QAAQ0E,YAAYoE,GACfA,EAEL9I,QAAQ0E,YAAYoE,EAAElI,MACjBkI,EAAElI,KAEHkI,EAAElI,KAAKD,EAAQgF,QAGnBuM,EAAW,WACd,OA1LH,SAAmBC,EAAOzR,EAAOC,EAASiI,GACzCA,EAAEmJ,YAAc,EAChB,IAAIK,EAAQ,KACZ,OAAOzR,EAAQqK,cACd,IAAK,UACJoH,EAAQ,CAAChB,WAAY,EAAE/I,KAAKgK,GAAIhB,SAAU,EAAEhJ,KAAKgK,IACjD,MACD,IAAK,YACJD,EAAQ,CAAChB,WAAY,EAAE/I,KAAKgK,GAAIhB,SAAU,GAC1C,MACD,IAAK,oBACJe,EAAQ,CAAChB,WAAY,EAAGC,SAAU,EAAEhJ,KAAKgK,IACzC,MACD,QACKjS,EAAUoB,UAAUb,EAAQqK,eAA0C,KAAzBrK,EAAQqK,eACxD7K,EAAK2L,KAAK,wGACVnL,EAAQqK,aAAe,UAExBoH,EAAQ,CAAChB,WAAY,EAAGC,SAAU,GAGjCc,EAAMG,WACRF,EAAQD,EAAMG,UAEf,IAAInK,EAAIrB,GAAGyL,YAAYH,EAAOxJ,GAE9B,OADAuJ,EAAMG,SAAWnK,EAAE,GACZ,SAASqH,GACf,OAAO9O,EAAMiR,IAAIxJ,EAAEqH,KA+JXgD,CAAUtL,KAAMxG,EAAOC,EAASmG,GAAG4H,OAAOxH,MAAMtG,OAAO,KAG3D6R,EAAgB,WACnB,IAAIC,EAAQhS,EAAM8C,IAAIkL,OAAO,gBAK7B,OAJAgE,EACEjD,UAAU,KACVU,SAEKuC,GAGJC,EAAY,SAAS7J,GACxB0I,EAAS1K,GAAG4H,OAAOxH,MAAO,EAAGvG,GAC7B,IACIgI,EADQ8J,IACEhH,OAAO,KACN9C,EAAE8C,OAAO,YAGtBE,MAAM,UAAW,IACjBA,MAAM,SAAU,SAChBA,MAAM,eAAgB,OACtBA,MAAM,OAAQ,QACdqD,aAAaC,SAAS,KACtBC,UAAU,SAAU,WACpBhI,KAAKoL,SAAWpL,KAAKoL,UAAYxJ,EACjC,IAAIyJ,EAAczL,GAAGyL,YAAYrL,KAAKoL,SAAUxJ,GAGhD,OAFA5B,KAAKoL,SAAWC,EAAY,GAErB,SAAS/C,GACf,IAAIoD,EAAKL,EAAY/C,GACjBqD,EAAMnS,EAAMoR,SAASgB,SAASF,GAElC,OADAC,EAAI,GAAsB,IAAjBlS,EAAQmK,QAAiB+G,EAASe,GAAMvK,KAAKgK,GAAK,GAAK,GACzD,CAAC3R,EAAMiR,IAAImB,SAASF,GAAKlS,EAAMoR,SAASgB,SAASF,GAAKC,MAIrDlK,EAAE8C,OAAO,QAClBhI,KAAK,KAAM,SACXsP,KAAK,WACL,OAAOjK,EAAElI,KAAKD,EAAQiC,EAAEoH,OAIxBvG,KAAK,YAAa,WAClByD,KAAKoL,SAAWpL,KAAKoL,UAAYxJ,EACjC,IAAI+J,EAAMnS,EAAMoR,SAASgB,SAAS5L,KAAKoL,UAEvC,OADAO,EAAI,GAAKlS,EAAQmK,QAAU+G,EAAS3K,KAAKoL,UAAYjK,KAAKgK,GAAK,GAAK,GAC7D,aAAcQ,EAAK,MAE1BlH,MAAM,cAAe,WAErB,OADAzE,KAAKoL,SAAWpL,KAAKoL,UAAYxJ,EAC1B+I,EAAS3K,KAAKoL,UAAYjK,KAAKgK,GAAK,QAAQ,QAEnD/B,KAAK,WACLjQ,EAAW2S,KAAK9L,KAAMvG,EAAQwF,gBAQjCzF,EAAMuS,OAASvS,EAAM8C,IAAIiM,UAAU,IAAM/O,EAAMa,YAAc,WAC7D,IAAImI,EAAOhJ,EAAMuS,OAAOxD,UAAU,QAC9ByD,EAAaxJ,EAAK9I,OAClBuS,EAAUzS,EAAMqD,IAAInD,GAEpBwS,EAAO1J,EAAK9I,KAAKuS,EAASnJ,GAE9BoJ,EACEC,GAAG,WAAY,MACfA,GAAG,YAAa,MAChBrE,aACAC,SAAStO,EAAQgG,WAAWC,MAC5BC,KAAKlG,EAAQgG,WAAWE,MACxBwM,GAAG,MAAO,WACVvM,GAAG4H,OAAOxH,MACRmM,GAAG,YAAa,SAASvK,GACzB0I,EAAS1K,GAAG4H,OAAOxH,MAAO,EAAGvG,GAC7BgS,EAAU7J,KAEVuK,GAAG,WAAY,WACfZ,IACAjB,EAAS1K,GAAG4H,OAAOxH,MAAO,EAAGvG,KAE7B0S,GAAG,QAASV,KAEdlP,KAAK,OAAQ,SAASqF,GACtB,OAAG9I,QAAQwB,UAAUb,EAAQwG,WAAanH,QAAQwB,UAAUsH,EAAElI,KAAKD,EAAQwG,WACnE2B,EAAElI,KAAKD,EAAQwG,UAEhBnD,EAAO8E,EAAElI,KAAKD,EAAQiC,EAAEoH,QAE/BkF,UAAU,IAAKgD,GAEjBkB,EAAK5C,QACH/E,OAAO,QACP6E,KAAK,SAASxH,EAAGX,GACjB,IAAImL,EAAO3C,EAAgBxI,EAAG+K,EAAYC,EAASnJ,GAChDsJ,GACFpM,KAAKoL,SAAWgB,EAChBpM,KAAKqM,UAAYD,GAEjBpM,KAAKoL,SAAWxJ,IAGjBrF,KAAK,OAAQ,SAASqF,GACtB,OAAG9I,QAAQwB,UAAUb,EAAQwG,WAAanH,QAAQwB,UAAUsH,EAAElI,KAAKD,EAAQwG,WACnE2B,EAAElI,KAAKD,EAAQwG,UAEhBnD,EAAO8E,EAAElI,KAAKD,EAAQiC,EAAEoH,QAE/BgF,WAAW,aACXC,SAAStO,EAAQgG,WAAWC,MAC5BC,KAAKlG,EAAQgG,WAAWE,MACxBwM,GAAG,MAAO,WACVvM,GAAG4H,OAAOxH,MACRmM,GAAG,YAAa,SAASvK,GACzB0I,EAAS1K,GAAG4H,OAAOxH,MAAO,EAAGvG,GAC7BgS,EAAU7J,KAEVuK,GAAG,WAAY,WACfZ,IACAjB,EAAS1K,GAAG4H,OAAOxH,MAAO,EAAGvG,KAE7B0S,GAAG,QAASV,KAEdzD,UAAU,IAAKgD,GAEjBkB,EACE3C,OACAH,KAAK,WACLxJ,GAAG4H,OAAOxH,MACTmM,GAAG,WAAY,MACfA,GAAG,YAAa,QAEjBrE,aACAC,SAAStO,EAAQgG,WAAWC,MAC5BC,KAAKlG,EAAQgG,WAAWE,MACxBqI,UAAU,IAAK,SAASpG,EAAG0K,GAC3B,IAAIC,EAAWvM,KAAKqM,UAAWrM,KAAKqM,UAAU5C,EAAgB6C,EAAKL,EAASD,EAAYlJ,GACpF7B,EAAIrB,GAAG4M,kBAAkB5K,EAAG2K,GAChC,OAAO,SAASjE,GACf,OAAO9O,EAAMiR,IAAIxJ,EAAEqH,OAGpBW,SAIFjJ,KAAKyM,UAAUjT,EAAOC,GAEnBA,EAAQ0C,OAAOC,MACjB4D,KAAKrD,aAAanD,EAAOC,EAASqD,KAIpCH,aAAc,SAASnD,EAAOC,EAASqD,GACtC,IAiBKb,EACA0C,EAlBD+N,EAAgB9M,GAAG+I,OAAO,QAC1BjP,EAAOR,EAAUyH,iBAAiBnH,EAAOC,GAEzCkT,EAAQ/M,GAAGgN,IAAIlT,EAAM,SAASkI,GACjC,OAAOA,EAAEnI,EAAQwJ,EAAEH,OAYhBtJ,EAAM2C,SAKRwC,EAF0B,aAAxBlF,EAAQ0C,OAAO/B,MACjB6B,EAAOxC,EAAQmK,OAASnK,EAAQ0C,OAAO0C,IACjB,IAAfpF,EAAQmK,SAEf3H,GAAQxC,EAAQyB,eAAe,EAAIzB,EAAQuC,OAAOC,KAC5CxC,EAAQmK,OAASnK,EAAQ0C,OAAO0C,KAEvCrF,EAAM2C,OAAS3C,EAAM8C,IACnBiI,OAAO,KACPhI,KAAK,QAAS,UACdA,KAAK,YAAa,aAAeN,EAAO,KAAO0C,EAAM,MAGxD,IAAIkO,EAAQrT,EAAM2C,OAChBoM,UAAU,gBACV7O,KAAKA,EA1BG,SAASkI,GAClB,OAAG9I,QAAQ0E,YAAYoE,GACfA,EAEDA,EAAEnI,EAAQgF,SAwBlBoO,EACEtE,UAAU,QACVsD,KAAK,WACL,IAAIjK,EAAIhC,GAAG4H,OAAOxH,KAAKyI,YAAY/O,OAAO,GAC1C,OAAOkI,EAAEnI,EAAQiC,EAAEoH,KAAO,KAAO4J,EAAc9K,EAAEnI,EAAQwJ,EAAEH,KAAK6J,GAAS,MAEzEvD,KAAK,WACsB,aAAxB3P,EAAQ0C,OAAO/B,MACjBjB,EAAW2S,KAAK9L,KAAMvG,EAAQ0C,OAAOE,KAAO,MAI/CwQ,EACEtE,UAAU,QACVhM,KAAK,OAAQ,WACb,IAAIqF,EAAIhC,GAAG4H,OAAOxH,KAAKyI,YAAY/O,OAAO,GAC1C,OAAOoD,EAAO8E,EAAEnI,EAAQiC,EAAEoH,QAG5B,IAAIgK,EAAOD,EAAMvD,QACf/E,OAAO,KACPhI,KAAK,QAAS,eAEhBuQ,EACEvI,OAAO,QACPhI,KAAK,QAAS,IACdA,KAAK,SAAU,IACfA,KAAK,YAAa,qBAClBA,KAAK,OAAQ,WACb,IAAIqF,EAAIhC,GAAG4H,OAAOxH,KAAKyI,YAAY/O,OAAO,GAC1C,OAAOoD,EAAO8E,EAAEnI,EAAQiC,EAAEoH,QAG5BgK,EACEvI,OAAO,QAEPhI,KAAK,IAAK,GACVA,KAAK,KAAM,KACXA,KAAK,KAAM,QACXsP,KAAK,WACL,IAAIjK,EAAIhC,GAAG4H,OAAOxH,KAAKyI,YAAY/O,OAAO,GAC1C,OAAOkI,EAAEnI,EAAQiC,EAAEoH,KAAO,KAAO4J,EAAc9K,EAAEnI,EAAQwJ,EAAEH,KAAK6J,GAAS,MAEzEvD,KAAK,WACsB,aAAxB3P,EAAQ0C,OAAO/B,MACjBjB,EAAW2S,KAAK9L,KAAMvG,EAAQ0C,OAAOE,KAAO,MAI/CwQ,EACEtD,OACAN,SAEF,IAAI8D,EAAW,EACXC,EAAW,EAAGC,EAAK,EACvBzT,EAAM2C,OACJoM,UAAU,gBACVhM,KAAK,YAAa,WAClB,IAAI2Q,EAAO/L,KAAKwF,IAAIqG,EAAU,GAAGC,GAC7BE,EAAOJ,EAEPK,EACHxN,GAAG4H,OAAOxH,MAERqN,OACAC,wBAeH,MAb2B,aAAxB7T,EAAQ0C,OAAO/B,MACjB4S,GAAYI,EAAWjS,OAAS,EAChC8R,MAEGF,EAAWK,EAAWnS,MAAQxB,EAAQyB,iBAExCiS,EADAJ,EAAW,EAEXE,IACAC,EAAO/L,KAAKwF,IAAIqG,EAAU,GAAGC,IAG9BF,GAAYK,EAAWnS,MAAQ,IAEzB,aAAekS,EAAO,KAAOD,EAAO,MAG7C,IAAIK,EAAa/T,EAAM2C,OAAOkR,OAC1BG,EAAUhU,EAAM8C,IAAI+Q,OAAOI,UAK/B,GAFAxU,EAAKkN,MAAM,UAAWqH,EAASD,EAAWE,WAEvCjU,EAAMW,UAAW,CACnB,IAAImC,EAAMsD,GAAG4H,OAAOhO,EAAM8C,IAAI+Q,OAAO5E,YACjCtN,EAASqS,EAAQrS,OAAS1B,EAAQuC,OAAO4C,OAC5CnF,EAAQ0B,OAAO,EAAIqS,EAAQvK,EAE5B9H,EAASgG,KAAKwF,IAAIxL,EAAQ1B,EAAQ2B,iBAClCwE,GAAG2I,UAAU/O,EAAMW,WAAWsK,MAAM,SAAUtJ,EAAS,MACvDmB,EAAIC,KAAK,SAAUpB,KAIrBuS,WAxWiB,SAASlU,EAAOC,GACjCD,EAAM8C,IAAIiM,UAAU,IAAM/O,EAAMa,YAAc,iBAC5C+O,KAAK,WACL,IAAIuE,EAAO3N,KAAKyI,WAAW6E,wBACxBK,EAAK1R,KAAO,EACd9C,EAAW2S,KAAK9L,KAAM2N,EAAKzR,OAClByR,EAAKzR,MAAQzC,EAAQwB,OAC9B9B,EAAW2S,KAAK9L,KAAMvG,EAAQwB,MAAQ0S,EAAK1R,SAmW9CwQ,UAAW,SAASjT,EAAOC,GAC1BD,EAAM8C,IAAIiM,UAAU,IAAM/O,EAAMa,YAAc,mBAC5CoK,MAAM,OAAQhL,EAAQyF,KAAKE,OAC3BqF,MAAM,cAAehL,EAAQyF,KAAKI,YAEpC9F,EAAM8C,IACJmI,MAAM,cAAehL,EAAQsF,YAC7B0F,MAAM,YAAahL,EAAQuF,cAKhClG,QAAQC,OAAO,qBAAqBkE,QAAQ,cAAe,SAAUhE,EAAMC,EAAWC,GAOrF,MAAO,CACNkC,QAAS,SAAS7B,EAAOC,GACxBN,EAAW6K,SAASxK,EAAOC,GAC3BN,EAAW8K,SAASzK,EAAOC,GAC3BN,EAAW+K,kBAAkB1K,EAAM2K,GAAI3K,EAAMyJ,EAAGzJ,EAAM4K,MAAO3K,EAAQwJ,OAKxEnK,QAAQC,OAAO,qBAAqBkE,QAAQ,aAAc,SAAUhE,EAAMC,GACzE,MAAO,CAUN6B,OAAQ,SAASvB,EAAOW,EAAWV,GAClC,IAAIsC,EAAItC,EAAQwB,MAAQxB,EAAQuC,OAAOC,KAAOxC,EAAQuC,OAAOE,MAC7DH,GAAMtC,EAAQ0C,OAAOC,MAAgC,aAAxB3C,EAAQ0C,OAAO/B,KAC1CX,EAAQ0C,OAAOE,KAAO5C,EAAQ0C,OAAO0C,IAAK,EAC5C,IAAIsB,EAAI1G,EAAQ0B,OAAS1B,EAAQuC,OAAO2C,IAAMlF,EAAQuC,OAAO4C,QAAUnF,EAAQyF,KAAK9C,KAAM,GAAG,GAE7F3C,EAAQyB,eAAiBa,EACzBtC,EAAQ2B,gBAAkB+E,EAC1B,IAAI7D,EAAMsD,GAAG4H,OAAOrN,GAClBsK,MAAM,QAAS1I,EAAI,MACnB0I,MAAM,SAAUtE,EAAI,MACpBoE,OAAO,OACPhI,KAAK,QAASR,GACdQ,KAAK,SAAU4D,GACfoE,OAAO,KACPhI,KAAK,YAAa,aAAe9C,EAAQuC,OAAOC,KAAO,IAAMxC,EAAQuC,OAAO2C,IAAM,KAClF8F,MAAM,SAAU,WAUlB,OAPAjL,EAAMkO,OAAS,QAAUxO,EAAU2H,kBACnCvE,EAAIiI,OAAO,YACThI,KAAK,KAAM/C,EAAMkO,QACjBnD,OAAO,QACPhI,KAAK,QAAS9C,EAAQwB,OACtBsB,KAAK,SAAU9C,EAAQ0B,QACzB3B,EAAM8C,IAAMA,GAObzB,iBAAkB,SAASrB,EAAOoU,GAC7B1U,EAAUoB,UAAUd,EAAMkC,GAI1BxC,EAAUoB,UAAUd,EAAMyJ,GAI9BzJ,EAAMoB,KAAOgF,GAAGhF,OAGdiT,YAAY,CAAC,GAAK,MAClB1B,GAAG,OAAQyB,GAPZ3U,EAAK2L,KAAK,mEAJV3L,EAAK2L,KAAK,oEAkBZZ,SAAU,SAASxK,EAAOC,GAgBzB,GAfAD,EAAMgN,GAAKhN,EAAM8C,IAAIiI,OAAO,KAC1BhI,KAAK,QAAS,UAEhB/C,EAAMgL,aAAe,EAClB/K,EAAQyF,KAAK9C,MAA+B,SAAvB3C,EAAQwJ,EAAEJ,WACjCrJ,EAAMgL,aAAe,GACG,cAArB/K,EAAQwJ,EAAEtH,SACZnC,EAAMgL,cAAgB,KAIN,eAAfhL,EAAMY,OACRZ,EAAMgL,aAAe,IAGlBtL,EAAUoB,UAAUb,EAAQiC,EAAEmH,WAAa3J,EAAUwE,SAASjE,EAAQiC,EAAEmH,UAC3E,OAAOpJ,EAAQiC,EAAEmH,UAChB,IAAK,MACJrJ,EAAMgN,GAAGjK,KAAK,YAAa,aAAe/C,EAAMgL,aAAe,MAA6B,eAArB/K,EAAQiC,EAAEC,OAAyB,EAAE,IAAM,KAClH,MACD,QACKzC,EAAUoB,UAAUb,EAAQiC,EAAEmH,WAAc3J,EAAUwE,SAASjE,EAAQiC,EAAEmH,WACrD,WAAvBpJ,EAAQiC,EAAEmH,WACV5J,EAAK2L,KAAK,mFACVnL,EAAQiC,EAAEmH,SAAW,UAEtBrJ,EAAMgN,GAAGjK,KAAK,YAAa,aAAe/C,EAAMgL,aAAe,MAC7D/K,EAAQ0B,QAA+B,eAArB1B,EAAQiC,EAAEC,OAAyB,EAAE,KAAM,UAGxDzC,EAAUuE,SAAShE,EAAQiC,EAAEmH,WACtCrJ,EAAMgN,GAAGjK,KAAK,YAAa,aAAe/C,EAAMgL,aAAe,MACxC,eAArB/K,EAAQiC,EAAEC,OAA0BlC,EAAQiC,EAAEmH,SAAW,GAAIpJ,EAAQiC,EAAEmH,UAAY,KAGtFrJ,EAAMgN,GAAGC,KAAKjN,EAAMmL,OAEjBzL,EAAUoB,UAAUb,EAAQiC,EAAE2D,SAA8B,IAApB5F,EAAQiC,EAAE2D,OACpD7F,EAAMgN,GAAGjC,OAAO,QACdhI,KAAK,QAAS,SACdA,KAAK,YAAa,aAAgB9C,EAAa,MAAI,KACnD8C,KAAK,KAAM,SACXA,KAAK,KAA2B,eAArB9C,EAAQiC,EAAEC,OAAyB,SAAS,GACvD8I,MAAM,cAAe,SACrBA,MAAM,YAAa,SACnBA,MAAM,cAAe,QACrByE,KAAKzP,EAAQiC,EAAE2D,QAOnB4E,SAAU,SAASzK,EAAOC,GASzB,GARAD,EAAM2K,GAAK3K,EAAM8C,IAAIiI,OAAO,KAC1BhI,KAAK,QAAS,UAEhB/C,EAAM6K,YAAc,EACjB5K,EAAQyF,KAAK9C,MAA+B,QAAvB3C,EAAQiC,EAAEmH,WACjCrJ,EAAM6K,YAAc,KAGjBnL,EAAUoB,UAAUb,EAAQwJ,EAAEJ,WAAa3J,EAAUwE,SAASjE,EAAQwJ,EAAEJ,UAC3E,OAAOpJ,EAAQwJ,EAAEJ,UAChB,IAAK,QACJrJ,EAAM2K,GAAG5H,KAAK,YAAa,cAAgB9C,EAAQwB,OAA8B,aAArBxB,EAAQwJ,EAAEtH,OAAuB,GAAG,IAAM,IACnGnC,EAAiB,YAAI,KACxB,MACD,QACKN,EAAUoB,UAAUb,EAAQwJ,EAAEJ,WAAc3J,EAAUwE,SAASjE,EAAQwJ,EAAEJ,WACrD,SAAvBpJ,EAAQwJ,EAAEJ,WACV5J,EAAK2L,KAAK,iFACVnL,EAAQwJ,EAAEJ,SAAW,QAEtBrJ,EAAM2K,GAAG5H,KAAK,YAAa,cAAqC,aAArB9C,EAAQwJ,EAAEtH,OAAuB,GAAG,GAAK,IACjFnC,EAAiB,YAAI,UAGjBN,EAAUuE,SAAShE,EAAQwJ,EAAEJ,WACtCrJ,EAAM2K,GAAG5H,KAAK,YAAa,cAAgB9C,EAAQwJ,EAAEJ,UAAiC,aAArBpJ,EAAQwJ,EAAEtH,OAAuB,GAAG,IAAM,IACxGnC,EAAiB,YAAI,KAGzBA,EAAM2K,GAAGsC,KAAKjN,EAAM4K,OAEjBlL,EAAUoB,UAAUb,EAAQwJ,EAAE5D,SAA8B,IAApB5F,EAAQwJ,EAAE5D,OACpD7F,EAAM2K,GAAGI,OAAO,QACdhI,KAAK,QAAS,SACdA,KAAK,KAA6B,UAAvB9C,EAAQwJ,EAAEJ,SAAsB,EAA0B,QAAvBpJ,EAAQiC,EAAEmH,SAAoB,EAAE,QAC9EtG,KAAK,IAA4B,UAAvB9C,EAAQwJ,EAAEJ,SAAsB,QAAQ,OAClDtG,KAAK,IAA4B,QAAvB9C,EAAQiC,EAAEmH,SAAoBpJ,EAAQ0B,OAAO,GACvDsJ,MAAM,cAAe,SACrBA,MAAM,YAAa,SACnBA,MAAM,cAAe,QACrByE,KAAKzP,EAAQwJ,EAAE5D,QAOnB6E,kBAAmB,SAASzC,EAAGyB,EAAOhE,EAAMzF,GAC3CgI,EAAE8G,UAAU,eACVuF,QAAQ,SAAS,GACjBvF,UAAU,QACV9D,MAAM,UAAW,MACjBA,MAAM,eAAgB,GACH,SAAlBhL,EAAQyJ,OAAsC,WAAlBzJ,EAAQyJ,OAIvCzB,EAAE8G,UAAU,SACV7O,KAAKwJ,EAAMH,MAAMtJ,EAAQsJ,OAAQ,SAASnB,GAAK,OAAOA,IACtD2H,OACAuE,QAAQ,SAAS,GACjBvF,UAAU,QACV9D,MAAM,UAAW,SA4BpBnJ,aAAc,SAAS9B,EAAOC,GAC7B,IAAI0F,EAAwB,QAAf3F,EAAMY,KAAgBX,EAAQyF,KAAKC,OAAO,MAE9B,IAAtB1F,EAAQyF,KAAK9C,MACf5C,EAAM8C,IAAIiM,UAAU,cAClB9D,MAAM,SAAUtF,GAChBsF,MAAM,OAAQ,QACdA,MAAM,kBAAmB,cAE3BjL,EAAM8C,IAAIiM,UAAU,oBAClB9D,MAAM,SAAUtF,GAChBsF,MAAM,OAAQ,QAEhBjL,EAAM8C,IAAIiM,UAAU,qBAClB9D,MAAM,SAAUtF,GAChBsF,MAAM,OAAQ,QAEhBjL,EAAM8C,IAAIiM,UAAU,cAClB9D,MAAM,OAAQhL,EAAQyF,KAAKE,OAC3BqF,MAAM,cAAehL,EAAQyF,KAAKI,YAEpC9F,EAAM8C,IAAIiM,UAAU,gBAClB9D,MAAM,OAAQhL,EAAQyF,KAAKG,MAAMD,OACjCqF,MAAM,cAAehL,EAAQyF,KAAKG,MAAMC,aAE1C9F,EAAM8C,IAAIiM,UAAU,SAClB9D,MAAM,UAAW,QAGpBjL,EAAM8C,IAAImI,MAAM,cAAehL,EAAQsF,YACvCvF,EAAM8C,IAAImI,MAAM,YAAahL,EAAQuF,WAStC8M,KAAM,SAAS5C,EAAMjO,GAkBlB,IAhBF,IACM8S,EADFC,GADF9E,EAAOtJ,GAAG4H,OAAO0B,IACFA,OAAO+E,MAAM,OAAOC,UAE/BC,EAAO,GACPC,EAAa,EAEbnL,EAAIiG,EAAK3M,KAAK,KACd+I,EAAK+I,WAAWnF,EAAK3M,KAAK,OAC1B+R,EAAKpF,EAAK3M,KAAK,MAEjBgS,EACHrF,EAAKA,KAAK,MACR3E,OAAO,SACPhI,KAAK,IAAK,GACVA,KAAK,IAAK0G,GACV1G,KAAK,KAAM+R,GACX/R,KAAK,KAAM+I,EAAK,MACXyI,EAAOC,EAAMQ,OACjBL,EAAKpH,KAAKgH,GACVQ,EAAMrF,KAAKiF,EAAKM,KAAK,MAClBF,EAAMlB,OAAOqB,wBAA0BzT,IACxCkT,EAAKK,MACLD,EAAMrF,KAAKiF,EAAKM,KAAK,MACrBN,EAAO,CAACJ,GACRQ,EACHrF,EAAK3E,OAAO,SACVhI,KAAK,IAAK,GACVA,KAAK,IAAK0G,GACV1G,KAAK,KAAM+R,GACX/R,KAAK,KAxBS,MAwBD6R,EAA0B9I,EAAK,MAC5C4D,KAAK6E,KAUXY,eAAgB,SAASC,GAIxB,IAAInN,EAAIoN,SAASC,gBAAgB,6BAA8B,KAG/DrN,EAAEsN,eAAe,KAAM,YAAaH,GAKpC,IAAII,EAASvN,EAAEmN,UAAUK,QAAQC,cAAcF,OAG/C,MAAO,CAACA,EAAO1I,EAAG0I,EAAOG,OAx/D5B","file":"angular-d3-charts.min.js","sourcesContent":["(function() {\n\n\"use strict\";\n\nangular.module('angular-d3-charts', []).directive('a3bar', function ($log, d3Helpers, svgHelpers, barHelpers, barDefaults) {\n\treturn {\n\t\trestrict: 'EA',\n\t\treplace: true,\n\t\tscope: {\n\t\t\toptions: '=options',\n\t\t\tdata: '=data'\n\t\t},\n\t\ttemplate: '<div class=\"angular-a3bar\"></div>',\n\t\tcontroller: function($scope) {\n\t\t\t$log.info('[Angular - D3] Bar scope controller', $scope);\n\t\t},\n\t\tlink: function(scope, element, attrs) {\n\t\t\tif(!jQuery) {\n\t\t\t\t$log.error('JQuery is not loaded');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.container = element;\n\t\t\tscope.type = 'bar';\n\t\t\tscope.classPrefix = 'a3bar';\n\t\t\tvar isDefined = d3Helpers.isDefined,\n\t\t\t\toptions = barDefaults.setDefaults(scope.options, attrs.id);\n\n\t\t\td3Helpers.setSize(element, options, attrs);\n\n\t\t\tbarHelpers.setXScale(scope, options);\n\t\t\tbarHelpers.setYScale(scope, options);\n\t\t\tif(isDefined(options.zoom) && options.zoom) {\n\t\t\t\tsvgHelpers.addZoomBehaviour(scope, barHelpers.zoomBehaviour);\n\t\t\t}\n\t\t\tsvgHelpers.addSVG(scope, element.get(0), options);\n\n\t\t\telement.width(options.containerWidth);\n\t\t\telement.height(options.containerHeight);\n\n\t\t\tbarHelpers.addAxis(scope, options);\n\t\t\tsvgHelpers.updateStyles(scope, options);\n\n\t\t\tscope.$watch('data', function() {\n\t\t\t\tbarHelpers.updateData(scope, options);\n\t\t\t});\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').directive('a3oabar', function ($log, d3Helpers, svgHelpers, barHelpers, barDefaults) {\n\treturn {\n\t\trestrict: 'EA',\n\t\treplace: true,\n\t\tscope: {\n\t\t\toptions: '=options',\n\t\t\tdata: '=data'\n\t\t},\n\t\ttemplate: '<div class=\"angular-a3oabar\"></div>',\n\t\tcontroller: function($scope) {\n\t\t\t$log.info('[Angular - D3] One Axis Bar scope controller', $scope);\n\t\t},\n\t\tlink: function(scope, element, attrs) {\n\t\t\tif(!jQuery) {\n\t\t\t\t$log.error('JQuery is not loaded');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.container = element;\n\t\t\tscope.type = 'oneAxisBar';\n\t\t\tscope.classPrefix = 'a3oabar';\n\t\t\tvar isDefined = d3Helpers.isDefined,\n\t\t\t\toptions = barDefaults.setDefaults(scope.options, attrs.id);\n\n\t\t\td3Helpers.setSize(element, options, attrs);\n\n\t\t\t// Orient option disabled for this chart.\n\t\t\toptions.x.orient = 'axisBottom';\n\n\t\t\tbarHelpers.setXScale(scope, options);\n\t\t\tbarHelpers.setYScale(scope, options);\n\t\t\tif(isDefined(options.zoom) && options.zoom) {\n\t\t\t\tsvgHelpers.addZoomBehaviour(scope, barHelpers.zoomBehaviour);\n\t\t\t}\n\t\t\tsvgHelpers.addSVG(scope, element.get(0), options);\n\n\t\t\telement.width(options.containerWidth);\n\t\t\telement.height(options.containerHeight);\n\n\t\t\tbarHelpers.addOneAxis(scope, options);\n\t\t\tsvgHelpers.updateStyles(scope, options);\n\n\t\t\tscope.$watch('data', function() {\n\t\t\t\tbarHelpers.updateData(scope, options);\n\t\t\t});\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').directive('a3pie', function ($log, d3Helpers, svgHelpers, pieHelpers, pieDefaults) {\n\treturn {\n\t\trestrict: 'EA',\n\t\treplace: true,\n\t\tscope: {\n\t\t\toptions: '=options',\n\t\t\tdata: '=data'\n\t\t},\n\t\ttemplate: '<div class=\"angular-a3pie\"></div>',\n\t\tcontroller: function($scope) {\n\t\t\t$log.info('[Angular - D3] Pie scope controller', $scope);\n\t\t},\n\t\tlink: function(scope, element, attrs) {\n\t\t\tif(!jQuery) {\n\t\t\t\t$log.error('JQuery is not loaded');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.container = element;\n\t\t\tscope.type = 'pie';\n\t\t\tscope.classPrefix = 'a3pie';\n\t\t\tvar options = pieDefaults.setDefaults(scope.options, attrs.id);\n\n\t\t\td3Helpers.setSize(element, options, attrs);\n\n\t\t\tsvgHelpers.addSVG(scope, element.get(0), options);\n\t\t\tvar w = options.width + options.margin.left + options.margin.right;\n\t\t\tw -= options.legend.show && options.legend.type === 'vertical'? options.legend.size:0;\n\t\t\tscope.svg.attr('transform', 'translate(' + w / 2 + ',' + options.height / 2 + ')');\n\n\t\t\tpieHelpers.addArc(scope, options);\n\t\t\t//svgHelpers.updateStyles(scope, options);\n\n\t\t\t//pieHelpers.updateData(scope, options);\n\n\t\t\tscope.$watch('data', function() {\n\t\t\t\tpieHelpers.updateData(scope, options);\n\t\t\t});\n\n\t\t\tscope.$on('a3pie:redraw-' + pieDefaults.obtainEffectiveChartId(attrs.id), function() {\n\t\t\t\tpieHelpers.createLegend(scope, options, d3Helpers.setColors(options.pie.colors));\n\t\t\t});\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').directive('a3line', function ($log, d3Helpers, svgHelpers, lineHelpers, lineDefaults) {\n\treturn {\n\t\trestrict: 'EA',\n\t\treplace: true,\n\t\tscope: {\n\t\t\toptions: '=options',\n\t\t\tdata: '=data'\n\t\t},\n\t\ttemplate: '<div class=\"angular-a3line\"></div>',\n\t\tcontroller: function($scope) {\n\t\t\t$log.info('[Angular - D3] Line scope controller', $scope);\n\t\t},\n\t\tlink: function(scope, element, attrs) {\n\t\t\tif(!jQuery) {\n\t\t\t\t$log.error('JQuery is not loaded');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.container = element;\n\t\t\tscope.type = 'line';\n\t\t\tscope.classPrefix = 'a3line';\n\n\t\t\tvar options = lineDefaults.setDefaults(scope.options, attrs.id);\n\n\t\t\td3Helpers.setSize(element, options, attrs);\n\n\t\t\tsvgHelpers.addSVG(scope, element.get(0), options);\n\n\t\t\telement.width(options.containerWidth);\n\t\t\telement.height(options.containerHeight);\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('d3Helpers', function ($log) {\n\tfunction _obtainEffectiveChartId(d, chartId) {\n\t\tvar id, i;\n\t\tif (!angular.isDefined(chartId)) {\n\t\t\tif (Object.keys(d).length === 1) {\n\t\t\t\tfor (i in d) {\n\t\t\t\t\tif (d.hasOwnProperty(i)) {\n\t\t\t\t\t\tid = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (Object.keys(d).length === 0) {\n\t\t\t\tid = 'main';\n\t\t\t} else {\n\t\t\t\t$log.error('[AngularJS - D3] - You have more than 1 object on the DOM, you must provide the object ID');\n\t\t\t}\n\t\t} else {\n\t\t\tid = chartId;\n\t\t}\n\n\t\treturn id;\n\t}\n\n\tfunction _getCommonDefaults() {\n\t\treturn {\n\t\t\tidKey: 'id',\n\t\t\twidth: 300,\n\t\t\theigth: 250,\n\t\t\tzoom: true,\n\t\t\tmargin: {\n\t\t\t\tleft: 10,\n\t\t\t\tright: 10,\n\t\t\t\ttop: 10,\n\t\t\t\tbottom: 10\n\t\t\t},\n\t\t\tlegend: {\n\t\t\t\tshow: true,\n\t\t\t\tsize: 120,\n\t\t\t\ttype: 'vertical',\n\t\t\t\tgap: 20\n\t\t\t},\n\t\t\ttimeFormat: '%d-%m-%Y',\n\t\t\tfontFamily: 'Arial',\n\t\t\tfontSize: '0.75em',\n\t\t\ttooltipSize: 120,\n\t\t\taxis: {\n\t\t\t\tshow: true,\n\t\t\t\tstroke: '#000',\n\t\t\t\tcolor: '#000',\n\t\t\t\tlabel: {\n\t\t\t\t\tcolor: '#000',\n\t\t\t\t\tfontWeight: 'bold'\n\t\t\t\t},\n\t\t\t\tfontWeight: 'normal'\n\t\t\t},\n\t\t\tshowDefaultData: true,\n\t\t\tlocale: null,\n\t\t\tanimations: {\n\t\t\t\ttime: 750,\n\t\t\t\tease: d3.easeCubic\n\t\t\t}\n\t\t};\n\t}\n\n\treturn {\n\t\t//Determine if a reference is {}\n\t\tisEmpty: function(value) {\n\t\t\treturn Object.keys(value).length === 0;\n\t\t},\n\n\t\t//Determine if a reference is undefined or {}\n\t\tisUndefinedOrEmpty: function (value) {\n\t\t\treturn (angular.isUndefined(value) || value === null) || Object.keys(value).length === 0;\n\t\t},\n\n\t\t// Determine if a reference is defined\n\t\tisDefined: function(value) {\n\t\t\treturn angular.isDefined(value) && value !== null;\n\t\t},\n\n\t\t// Determine if a reference is a number\n\t\tisNumber: function(value) {\n\t\t\treturn angular.isNumber(value);\n\t\t},\n\n\t\t// Determine if a reference is a string\n\t\tisString: function(value) {\n\t\t\treturn angular.isString(value);\n\t\t},\n\n\t\t// Determine if a reference is an array\n\t\tisArray: function(value) {\n\t\t\treturn angular.isArray(value);\n\t\t},\n\n\t\t// Determine if a reference is an object\n\t\tisObject: function(value) {\n\t\t\treturn angular.isObject(value);\n\t\t},\n\n\t\t// Determine if a reference is a function.\n\t\tisFunction: function(value) {\n\t\t\treturn angular.isFunction(value);\n\t\t},\n\n\t\t// Determine if two objects have the same properties\n\t\tequals: function(o1, o2) {\n\t\t\treturn angular.equals(o1, o2);\n\t\t},\n\n\t\tsafeApply: function($scope, fn) {\n\t\t\tvar phase = $scope.$root.$$phase;\n\t\t\tif (phase === '$apply' || phase === '$digest') {\n\t\t\t\t$scope.$eval(fn);\n\t\t\t} else {\n\t\t\t\t$scope.$apply(fn);\n\t\t\t}\n\t\t},\n\n\t\tgetCommonDefaults: _getCommonDefaults,\n\n\t\tsetDefaults: function(newDefaults, userDefaults) {\n\t\t\tif (this.isDefined(userDefaults)) {\n\t\t\t\tnewDefaults.idKey = this.isDefined(userDefaults.idKey) ?  userDefaults.idKey : newDefaults.idKey;\n\t\t\t\tnewDefaults.colorKey = this.isDefined(userDefaults.colorKey) ?  userDefaults.colorKey : newDefaults.colorKey;\n\t\t\t\tnewDefaults.width = this.isDefined(userDefaults.width) ?  userDefaults.width : newDefaults.width;\n\t\t\t\tnewDefaults.heigth = this.isDefined(userDefaults.heigth) ?  userDefaults.heigth : newDefaults.heigth;\n\t\t\t\tnewDefaults.zoom = this.isDefined(userDefaults.zoom) ?  userDefaults.zoom : newDefaults.zoom;\n\t\t\t\tnewDefaults.timeFormat = this.isDefined(userDefaults.timeFormat) ?  userDefaults.timeFormat : newDefaults.timeFormat;\n\t\t\t\tnewDefaults.fontFamily = this.isDefined(userDefaults.fontFamily) ?  userDefaults.fontFamily : newDefaults.fontFamily;\n\t\t\t\tnewDefaults.fontSize = this.isDefined(userDefaults.fontSize) ?  userDefaults.fontSize : newDefaults.fontSize;\n\t\t\t\tnewDefaults.tooltipSize = this.isDefined(userDefaults.tooltipSize) ?  userDefaults.tooltipSize : newDefaults.tooltipSize;\n\t\t\t\tnewDefaults.showDefaultData = this.isDefined(userDefaults.showDefaultData) ?  userDefaults.showDefaultData : newDefaults.showDefaultData;\n\t\t\t\tnewDefaults.locale = this.isDefined(userDefaults.locale) ?  userDefaults.locale : newDefaults.locale;\n\n\t\t\t\tif(this.isDefined(userDefaults.margin)) {\n\t\t\t\t\tangular.extend(newDefaults.margin, userDefaults.margin);\n\t\t\t\t}\n\t\t\t\tif(this.isDefined(userDefaults.legend)) {\n\t\t\t\t\tangular.extend(newDefaults.legend, userDefaults.legend);\n\t\t\t\t}\n\n\t\t\t\tif(this.isDefined(userDefaults.axis)) {\n\t\t\t\t\tangular.extend(newDefaults.axis, userDefaults.axis);\n\t\t\t\t}\n\n\t\t\t\tif(this.isDefined(userDefaults.animations)) {\n\t\t\t\t\tangular.extend(newDefaults.animations, userDefaults.animations);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tsetSize: function(element, options, attrs) {\n\t\t\t// Set width and height if they are defined\n\t\t\tvar w = this.isDefined(attrs.width)? attrs.width:options.width,\n\t\t\t\th = this.isDefined(attrs.height)? attrs.height:options.height;\n\n\t\t\tif (isNaN(w)) {\n\t\t\t\telement.css('width', w);\n\t\t\t} else {\n\t\t\t\telement.css('width', w + 'px');\n\t\t\t}\n\n\t\t\tif (isNaN(h)) {\n\t\t\t\telement.css('height', h);\n\t\t\t} else {\n\t\t\t\telement.css('height', h + 'px');\n\t\t\t}\n\n\t\t\toptions.width = element.width();\n\t\t\toptions.height = element.height();\n\t\t},\n\n\t\tsetColors: function(userColors, defaultColors) {\n\t\t\tvar colors = defaultColors || d3.scaleOrdinal(d3.schemePaired);\n\t\t\tif(this.isDefined(userColors)) {\n\t\t\t\tcolors = this.isArray(userColors)? d3.scaleOrdinal().range(userColors):colors;\n\t\t\t\tcolors = this.isString(userColors)? d3.scaleOrdinal().range([userColors]):colors;\n\t\t\t\tcolors = this.isFunction(userColors)? userColors:colors;\n\t\t\t}\n\t\t\treturn colors;\n\t\t},\n\n\t\tgetDataFromScope: function(scope, options) {\n\t\t\tvar data = null;\n\t\t\tif(this.isUndefinedOrEmpty(scope.data) && options.showDefaultData &&\n\t\t\t\t!this.isUndefinedOrEmpty(options.defaultData)) {\n\t\t\t\tdata = options.defaultData;\n\t\t\t} else if(this.isString(scope.data)) {\n\n\t\t\t} else {\n\t\t\t\tdata = scope.data;\n\t\t\t}\n\t\t\treturn data;\n\t\t},\n\n\t\tgetRandomString: function(length) {\n\t\t\tvar chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz';\n\t\t\tvar string_length = length || 8;\n\t\t\tvar randomstring = '';\n\t\t\tfor (var i = 0; i < string_length; i++) {\n\t\t\t\tvar rnum = Math.floor(Math.random() * chars.length);\n\t\t\t\trandomstring += chars.substring(rnum, rnum+1);\n\t\t\t}\n\t\t\treturn randomstring;\n    },\n\n    getRandomColor: function() {\n\t\t\t// random values between 0 and 255, these are the 3 colour values\n\t\t\tvar r = Math.floor(Math.random()*256);\n\t\t\tvar g = Math.floor(Math.random()*256);\n\t\t\tvar b = Math.floor(Math.random()*256);\n\n\t\t\t// puts the hex value inside this element (e is a jquery object)\n\t\t\treturn d3.rgb(r,g,b);\n\t\t},\n\n\t\tobtainEffectiveChartId: _obtainEffectiveChartId\n\t};\n});\n\nangular.module('angular-d3-charts').factory('iconHelpers', function () {\r\n\treturn {\r\n\t\ttree:\r\n\t\t\t'm 101.56082,48.552288 c -0.88364,1.27999 -1.603384,1.357043 -1.562119,2.826786 0.119189,0.64172 0.977609,0.392162 1.562119,0.471514 -0.0333,0.66932 -0.0665,1.33634 0.38968,1.414543 -1.161,1.423742 -2.082459,3.140743 -3.903601,3.769812 -0.119195,1.472044 1.12661,-1.198336 1.170161,0.471515 -0.406863,1.233987 -1.23778,1.959658 -1.952943,2.827935 0.978764,1.02008 3.413063,0.279458 3.515063,2.356419 -2.258944,-0.36916 -3.338565,0.684272 -5.468005,0.470364 1.844064,2.005661 -0.857278,2.099964 0,4.242478 -0.382796,0.760173 -1.041799,1.083332 -1.562127,0.471514 0.248703,1.028132 -1.10598,1.499646 0.389673,1.413393 -1.12088,0.35651 -2.484731,2.260967 -3.124251,0.471515 -0.5868,3.530605 -3.027979,4.827843 -5.856537,5.654718 1.218297,1.723902 0.324344,2.316169 0,4.713992 -1.350098,-0.372612 -1.648082,0.524416 -2.342615,0.943028 0.46646,0.680821 1.923145,0.714171 0.389672,1.413393 0.08939,0.600318 1.167869,0.616418 1.173599,0 1.132341,1.247787 -1.445223,1.99991 -2.73687,1.884906 -1.123172,-3.471954 -3.542575,0.549717 -4.684084,1.414542 -2.230298,-2.450723 -6.107531,-0.125354 -7.80948,2.355271 -0.991372,-0.247258 -2.82512,-0.661269 -1.954089,0.471514 -0.375918,1.167284 -1.500237,-0.648619 -2.732286,0 0.467605,-0.618719 0.152429,-0.741772 0,-1.413392 -2.525991,1.966558 -3.633117,2.903837 -7.030138,1.413392 -0.79195,0.957979 -1.810827,1.304139 -1.170161,2.827935 -0.61889,0.04025 -1.492214,-0.226557 -1.560979,0.471514 -1.128902,-0.211606 -0.924897,-2.028661 -1.954089,-2.356421 -0.456146,7.30157 -2.178724,20.025552 3.90474,22.623472 4.99009,2.13102 12.584104,-1.49159 16.79256,2.82679 -14.971418,0 -29.939397,0 -44.909668,0 0.116901,-0.95798 0.781635,-1.25468 1.171307,-1.88491 5.748804,-1.38693 10.138342,0.37491 13.668309,-1.41338 4.826199,-2.44612 3.203331,-16.080939 1.170162,-21.680458 -2.269265,-1.474345 -3.32711,-4.01477 -6.247356,-2.357571 0.166184,-0.984429 -0.268185,-1.247787 -0.390818,-1.884906 -4.370053,0.923479 -6.35394,-1.949309 -11.716512,-1.887207 0.161599,-1.133934 -0.71287,-1.02353 -0.390817,-2.356421 -1.542643,-0.753271 -4.592397,1.529547 -6.638174,-0.470363 2.143196,-1.411093 -1.711117,-0.30706 -0.390817,-1.887207 -1.329469,0.828024 -1.454393,-0.150654 -1.951797,-1.413392 -1.22632,0.729122 -2.177578,0.301309 -3.124251,-0.471513 0.207443,-0.379512 0.406864,-0.765924 0.390817,-1.413394 -0.710578,0.100053 -1.421155,-1.02123 -3.125395,-0.943027 -0.649835,-0.936128 0.03553,-0.599169 0,-1.884907 -2.3437613,0.103502 -0.838941,1.444442 -3.1242509,0 0.2028585,-0.695771 0.5787771,-1.186836 0.7816356,-1.886057 -0.6314974,0.809625 -1.6343292,1.171886 -3.1242505,0.943029 0.2028585,-2.196566 1.1518238,-2.086163 0,-3.770964 1.9449205,0.675071 1.2412191,0.392162 0.7804896,-1.413391 0.7014092,-0.0598 0.824041,0.577317 1.5621253,0.471513 C 7.1651335,64.353762 4.4557688,61.621281 6.6631446,59.386763 5.0425687,59.348813 4.4798368,57.975672 2.7584045,57.030343 3.1515145,56.404724 3.1274466,55.27654 3.9297119,55.144287 3.7085159,54.704974 2.8443616,54.431265 3.5388941,54.202408 c -0.2567249,-1.413392 -0.835502,0.451964 -1.5621252,0 0.221196,-1.148885 0.3346593,-2.424272 1.5621252,-2.357571 -0.4389537,-1.354739 -0.8206028,-2.780782 -1.5621252,-3.769811 0.075642,1.060331 -0.1615992,1.085631 0,2.827934 -2.04692278,0.05405 0.085957,-2.202317 -1.95179703,-2.356421 C 0.81348409,47.110145 -0.47014047,46.095816 0.41922798,44.781326 1.622626,44.429415 0.89485677,46.407474 2.371025,45.724354 2.9119811,45.193038 1.5469838,42.973472 1.5905355,41.483027 3.4598137,42.89872 3.7853042,40.623952 3.5423323,38.184728 5.4631849,37.357853 6.1806393,35.083085 8.2287082,34.413766 7.920409,33.941101 6.8637109,34.589721 6.2757651,33.471887 6.8442274,27.875819 9.3495874,25.063986 11.743777,20.745606 c 0.22578,2.141363 2.386166,0.901627 2.34376,2.356421 1.250389,-0.915427 1.747793,-1.346691 3.513922,-2.356421 -0.881345,1.820504 0.664735,1.932057 2.342615,1.887207 0.649835,0.934978 -0.03438,0.599168 0,1.884905 2.100789,-0.67852 3.111644,-0.555466 5.077193,-1.884905 -0.355287,-1.711252 -1.152969,-0.288659 -2.343759,-0.471514 0.606282,-1.182237 1.585046,-1.578998 0.782781,-3.300599 2.67842,0.02645 1.131195,-1.720452 1.560978,-2.827935 2.158095,0.0713 1.391358,1.216735 3.125398,0 -0.257872,-1.411093 -0.835502,0.450813 -1.563271,0 0.720892,-2.66463 0.605137,-3.408703 1.563271,-5.65472 2.644037,0.302458 4.757433,-1.6986009 5.466865,0.940728 0.127216,-1.7929037 2.577563,-2.5542265 3.513922,-1.8849063 0.354143,-1.1776354 3.234276,-3.6881606 3.513923,-1.8860567 0.881345,-0.3519105 0.153575,-2.6427792 0.390817,-3.7709629 0.676195,-1.2247868 3.222815,-0.1943559 3.124251,-2.3552706 1.045237,0.4657638 2.059529,0.970629 3.515068,0.9430282 -0.09053,1.8044041 0.720893,2.0643118 0.390818,3.2982988 0.312884,0.2058562 1.605677,0.6026181 2.342616,0 -1.594217,-2.4829244 1.054405,0.3082092 0,-2.8290847 1.465852,0.3576606 1.321444,-1.232837 1.951796,-1.88490656 1.426887,0.96832896 1.753523,-0.21275637 2.734579,-0.94302826 2.28531,2.86128582 3.982674,0.44851345 6.638173,1.88720652 0.216611,0.1173035 -1.014294,0.7912239 -1.170162,0.4715142 1.110565,2.2839684 5.575744,2.0562616 6.247355,5.1832053 0.954696,-1.1592346 1.693926,0.3496106 3.125396,0 0.108879,0.7613229 -0.369042,0.8119244 -0.391964,1.4133925 2.011394,-1.0246808 1.355829,1.1350845 3.515069,0.9430282 -0.168476,0.7406213 -1.228612,0.4025113 -0.781636,1.8849063 0.344974,0.371461 2.656644,-0.08166 2.733433,1.886057 1.611407,0.08395 1.160992,-1.591649 1.563271,-1.886057 0.397695,3.207446 4.105307,2.404722 5.46572,5.185506 1.05899,-0.584217 0.971887,-1.820505 2.344906,-0.943029 -2.052652,2.232218 1.596509,5.055551 2.341469,8.013441 -0.31403,-0.250708 -0.63379,-0.491065 -1.170161,-0.471515 1.951797,1.871106 -0.985641,4.271229 2.343761,4.713992 0.578777,-0.207007 -0.155869,-0.603768 0,-1.414542 1.33176,-0.351911 0.495113,1.914807 1.950651,1.414542 -1.313423,4.180375 0.330075,8.257247 1.954089,11.311738 -1.410841,-1.107482 -2.162679,-0.608368 -3.125397,0.941879 1.658397,1.336341 3.762625,1.772203 5.46572,0 -0.824042,1.883757 2.371267,-0.359961 2.735725,1.887207 0.882492,-0.263358 -0.473337,-0.736023 0.389671,-1.414542 1.133486,1.461694 1.550665,3.784763 3.124251,4.713989 -0.33007,1.381193 -1.257265,-0.280607 -1.951798,0 0.09512,0.829176 0.672758,1.074134 1.562118,0.940729 -0.755267,1.170736 0.38166,1.680201 -0.781627,2.358722 0.865307,1.754952 1.044087,-1.199487 2.341467,-0.474966 z M 6.6665829,50.908709 c -0.010314,1.245487 0.3644576,2.95444 -1.1701614,2.357572 -0.2693319,1.266188 0.8068499,0.910827 1.1701614,1.413392 0.033236,-2.672681 1.5162815,-1.179936 3.1253966,-2.829085 -1.4899214,0.604918 -1.2079825,-2.254067 -1.1713074,-0.941879 -0.331221,1.382342 -1.2584105,-0.281758 -1.9540892,0 z'\r\n\t};\r\n});\r\n\nangular.module('angular-d3-charts').factory('barDefaults', function (d3Helpers) {\n\tfunction _getDefaults() {\n\t\tvar commonDefaults = d3Helpers.getCommonDefaults();\n\t\tangular.extend(commonDefaults, {\n\t\t\tseries: ['A', 'B', 'C', 'D'],\n\t\t\tbar: {\n\t\t\t\tgap: 0.2,\n\t\t\t\tpath: null,\n\t\t\t\tcolors: d3.scaleOrdinal(d3.schemePaired),\n\t\t\t\tsubcolors: null,\n\t\t\t\t// Possible Values [d3.interpolateRgb, d3.interpolateHsl, d3.interpolateLab, d3.interpolateHcl]\n\t\t\t\tcolorInterpolator: null\n\t\t\t},\n\t\t\tx: {\n\t\t\t\ttickFormat: null,\n\t\t\t\ttickSize: 6,\n\t\t\t\torient: 'axisBottom',\n\t\t\t\tposition: 'bottom',\n\t\t\t\tkey: 'x',\n\t\t\t\tlabel: 'x',\n\t\t\t\tticks: 5,\n\t\t\t\ttickSubdivide: 4\n\t\t\t},\n\t\t\ty: {\n\t\t\t\tscale: 'linear',\n\t\t\t\ttickFormat: null,\n\t\t\t\ttickSize: 6,\n\t\t\t\torient: 'axisLeft',\n\t\t\t\tposition: 'left',\n\t\t\t\t// Possible Values ['ttb', 'btt'] => ['top to bottom', 'bottom to top']\n\t\t\t\tdirection: 'ttb',\n\t\t\t\tkey: 'y',\n\t\t\t\tlabel: 'y',\n\t\t\t\tticks: 5,\n\t\t\t\ttickSubdivide: 4,\n\t\t\t\tminFromZero: true\n\t\t\t},\n\t\t\taxis: {\n\t\t\t\t// Possible Values ['bottom', 'top']\n\t\t\t\tguidePosition: 'top',\n\t\t\t\tshowValues: true,\n\t\t\t\tvaluesColor: '#000',\n\t\t\t\tshowPercent: true,\n\t\t\t\tpercentColor: '#000',\n\t\t\t\tlabel: {\n\t\t\t\t\tcolor: '#000',\n\t\t\t\t\tfontWeight: 'bold'\n\t\t\t\t},\n\t\t\t\tshow: true\n\t\t\t},\n\t\t\tdefaultData: [{\n\t\t\t\tid: 1,\n\t\t\t\tx: 'Fruits',\n\t\t\t\ty: [ 54, 0, 879 ],\n\t\t\t\ttooltip: 'Fruits tooltip'\n\t\t\t}, {\n\t\t\t\tid: 2,\n\t\t\t\tx: 'Vegetables',\n\t\t\t\ty: [ 12, 34, 15 ],\n\t\t\t\ttooltip: 'Vegetables tooltip'\n\t\t\t}, {\n\t\t\t\tid: 3,\n\t\t\t\tx: 'Meet',\n\t\t\t\ty: [ 154, 432, 234 ],\n\t\t\t\ttooltip: 'Meet tooltip'\n\t\t\t}]\n\t\t});\n\t\treturn commonDefaults;\n\t}\n\n\tvar isDefined = d3Helpers.isDefined,\n\t\tobtainEffectiveChartId = d3Helpers.obtainEffectiveChartId,\n\t\tdefaults = {};\n\n\treturn {\n\t\tgetDefaults: function (scopeId) {\n\t\t\tvar barId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\treturn defaults[barId];\n\t\t},\n\n\t\tgetCreationDefaults: function (scopeId) {\n\t\t\tvar d = this.getDefaults(scopeId);\n\n\t\t\tvar barDefaults = {};\n\t\t\tangular.extend(barDefaults, d);\n\t\t\treturn barDefaults;\n\t\t},\n\n\t\tsetDefaults: function(userDefaults, scopeId) {\n\t\t\tvar newDefaults = _getDefaults();\n\n\t\t\tif (isDefined(userDefaults)) {\n\t\t\t\td3Helpers.setDefaults(newDefaults, userDefaults);\n\n\t\t\t\tif(isDefined(userDefaults.bar)) {\n\t\t\t\t\tangular.extend(newDefaults.bar, userDefaults.bar);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.x)) {\n\t\t\t\t\tangular.extend(newDefaults.x, userDefaults.x);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.y)) {\n\t\t\t\t\tangular.extend(newDefaults.y, userDefaults.y);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(newDefaults.defaultData)) {\n\t\t\t\t\tangular.extend(newDefaults.defaultData, newDefaults.defaultData);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar barId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\tdefaults[barId] = newDefaults;\n\t\t\treturn newDefaults;\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('pieDefaults', function (d3Helpers) {\n\tfunction _getDefaults() {\n\t\tvar commonDefaults = d3Helpers.getCommonDefaults();\n\t\tangular.extend(commonDefaults, {\n\t\t\tpie: {\n\t\t\t\tcolors: d3.scaleOrdinal(d3.schemePaired)\n\t\t\t},\n\t\t\tradius: 0,\n\t\t\tx: {\n\t\t\t\tkey: 'x',\n\t\t\t\tlabel: 'x',\n\t\t\t\tshow: true\n\t\t\t},\n\t\t\ty: {\n\t\t\t\tkey: 'y',\n\t\t\t\tlabel: 'y'\n\t\t\t},\n\t\t\tdefaultData: [{\n\t\t\t\tid: 1,\n\t\t\t\tx: 'Fruits',\n\t\t\t\ty: 54,\n\t\t\t\ttooltip: 'Fruits tooltip'\n\t\t\t}, {\n\t\t\t\tid: 2,\n\t\t\t\tx: 'Vegetables',\n\t\t\t\ty: 23,\n\t\t\t\ttooltip: 'Vegetables tooltip'\n\t\t\t}, {\n\t\t\t\tid: 3,\n\t\t\t\tx: 'Meet',\n\t\t\t\ty: 41,\n\t\t\t\ttooltip: 'Meet tooltip'\n\t\t\t}],\n\t\t\tshowPercent: false,\n\t\t\tborderColor: '#FFF',\n\t\t\tpieAnimation: 'normal'\n\t\t});\n\t\treturn commonDefaults;\n\t}\n\n\tvar isDefined = d3Helpers.isDefined,\n\t\tobtainEffectiveChartId = d3Helpers.obtainEffectiveChartId,\n\t\tdefaults = {};\n\n\treturn {\n\t\tgetDefaults: function (scopeId) {\n\t\t\tvar pieId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\treturn defaults[pieId];\n\t\t},\n\n\t\tgetCreationDefaults: function (scopeId) {\n\t\t\tvar d = this.getDefaults(scopeId);\n\n\t\t\tvar pieDefaults = {};\n\t\t\tangular.extend(pieDefaults, d);\n\t\t\treturn pieDefaults;\n\t\t},\n\n\t\tsetDefaults: function(userDefaults, scopeId) {\n\t\t\tvar newDefaults = _getDefaults();\n\n\t\t\tif (isDefined(userDefaults)) {\n\t\t\t\td3Helpers.setDefaults(newDefaults, userDefaults);\n\n\t\t\t\tnewDefaults.radius = d3Helpers.isDefined(userDefaults.radius)?  userDefaults.radius:newDefaults.radius;\n\t\t\t\tnewDefaults.showPercent = d3Helpers.isDefined(userDefaults.showPercent)?  userDefaults.showPercent:newDefaults.showPercent;\n\t\t\t\tnewDefaults.borderColor = d3Helpers.isDefined(userDefaults.borderColor)?  userDefaults.borderColor:newDefaults.borderColor;\n\t\t\t\tnewDefaults.pieAnimation = d3Helpers.isDefined(userDefaults.pieAnimation)?  userDefaults.pieAnimation:newDefaults.pieAnimation;\n\n\t\t\t\tif(isDefined(userDefaults.pie)) {\n\t\t\t\t\tangular.extend(newDefaults.pie, userDefaults.pie);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.x)) {\n\t\t\t\t\tangular.extend(newDefaults.x, userDefaults.x);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.y)) {\n\t\t\t\t\tangular.extend(newDefaults.y, userDefaults.y);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(newDefaults.defaultData)) {\n\t\t\t\t\tangular.extend(newDefaults.defaultData, newDefaults.defaultData);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar pieId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\tdefaults[pieId] = newDefaults;\n\t\t\treturn newDefaults;\n\t\t},\n\n\t\tobtainEffectiveChartId: function(scopeId) {\n\t\t\treturn obtainEffectiveChartId(defaults, scopeId);\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('lineDefaults', function (d3Helpers) {\n\tfunction _getDefaults() {\n\t\tvar commonDefaults = d3Helpers.getCommonDefaults();\n\t\tangular.extend(commonDefaults, {\n\t\t\tseries: ['A', 'B', 'C', 'D'],\n\t\t\tx: {\n\t\t\t\tscale: 'linear',\n\t\t\t\ttickFormat: null,\n\t\t\t\ttickSize: 6,\n\t\t\t\torient: 'bottom',\n\t\t\t\tposition: 'bottom',\n\t\t\t\tkey: 'x',\n\t\t\t\tlabel: 'x',\n\t\t\t\tticks: 5,\n\t\t\t\ttickSubdivide: 4\n\t\t\t},\n\t\t\ty: {\n\t\t\t\tscale: 'linear',\n\t\t\t\ttickFormat: null,\n\t\t\t\ttickSize: 6,\n\t\t\t\torient: 'left',\n\t\t\t\tposition: 'left',\n\t\t\t\tkey: 'y',\n\t\t\t\tlabel: 'y',\n\t\t\t\tticks: 5,\n\t\t\t\ttickSubdivide: 4\n\t\t\t},\n\t\t\taxis: {\n\t\t\t\tvaluesColor: '#000',\n\t\t\t\tpercentColor: '#000',\n\t\t\t\tlabel: {\n\t\t\t\t\tcolor: '#000',\n\t\t\t\t\tfontWeight: 'bold'\n\t\t\t\t}\n\t\t\t},\n\t\t\tdefaultData: [{\n\t\t\t\tid: 1,\n\t\t\t\tx: 'Fruits',\n\t\t\t\ty: [ 54, 0, 879 ],\n\t\t\t\ttooltip: 'Fruits tooltip'\n\t\t\t}, {\n\t\t\t\tid: 2,\n\t\t\t\tx: 'Vegetables',\n\t\t\t\ty: [ 12, 34, 15 ],\n\t\t\t\ttooltip: 'Vegetables tooltip'\n\t\t\t}, {\n\t\t\t\tid: 3,\n\t\t\t\tx: 'Meet',\n\t\t\t\ty: [ 154, 432, 234 ],\n\t\t\t\ttooltip: 'Meet tooltip'\n\t\t\t}]\n\t\t});\n\t\treturn commonDefaults;\n\t}\n\n\tvar isDefined = d3Helpers.isDefined,\n\t\tobtainEffectiveChartId = d3Helpers.obtainEffectiveChartId,\n\t\tdefaults = {};\n\n\treturn {\n\t\tgetDefaults: function (scopeId) {\n\t\t\tvar lineId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\treturn defaults[lineId];\n\t\t},\n\n\t\tgetCreationDefaults: function (scopeId) {\n\t\t\tvar d = this.getDefaults(scopeId);\n\n\t\t\tvar lineDefaults = {};\n\t\t\tangular.extend(lineDefaults, d);\n\t\t\treturn lineDefaults;\n\t\t},\n\n\t\tsetDefaults: function(userDefaults, scopeId) {\n\t\t\tvar newDefaults = _getDefaults();\n\n\t\t\tif (isDefined(userDefaults)) {\n\t\t\t\td3Helpers.setDefaults(newDefaults, userDefaults);\n\n\t\t\t\tif(isDefined(userDefaults.x)) {\n\t\t\t\t\tangular.extend(newDefaults.x, userDefaults.x);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(userDefaults.y)) {\n\t\t\t\t\tangular.extend(newDefaults.y, userDefaults.y);\n\t\t\t\t}\n\n\t\t\t\tif(isDefined(newDefaults.defaultData)) {\n\t\t\t\t\tangular.extend(newDefaults.defaultData, newDefaults.defaultData);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar lineId = obtainEffectiveChartId(defaults, scopeId);\n\t\t\tdefaults[lineId] = newDefaults;\n\t\t\treturn newDefaults;\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('barHelpers', function ($log, d3Helpers, svgHelpers) {\n\t/*\n\tvar wrap = function (text, width) {\n\t\ttext.each(function() {\n\t\t\tvar text = d3.select(this),\n\t\t\t\twords = text.text().split(/\\s+/).reverse(),\n\t\t\t\tword,\n\t\t\t\tline = [],\n\t\t\t\tlineNumber = 0,\n\t\t\t\tlineHeight = 1.1, // ems\n\t\t\t\ty = text.attr('y'),\n\t\t\t\tdy = parseFloat(text.attr('dy')),\n\t\t\t\ttspan = text.text(null).append('tspan').attr('x', 0).attr('y', y).attr('dy', dy + 'em');\n\t\t\twhile (word = words.pop()) {\n\t\t\t\tline.push(word);\n\t\t\t\ttspan.text(line.join(' '));\n\t\t\t\tif (tspan.node().getComputedTextLength() > width) {\n\t\t\t\t\tline.pop();\n\t\t\t\t\ttspan.text(line.join(' '));\n\t\t\t\t\tline = [word];\n\t\t\t\t\ttspan = text.append('tspan').attr('x', 0).attr('y', y).attr('dy', ++lineNumber * lineHeight + dy + 'em').text(word);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\t*/\n\n\treturn {\n\t\taddAxis: function(scope, options) {\n\t\t\tsvgHelpers.addXAxis(scope, options);\n\t\t\tsvgHelpers.addYAxis(scope, options);\n\t\t\tsvgHelpers.addSubdivideTicks(scope.yl, scope.y, scope.yAxis, options.y);\n\t\t},\n\n\t\taddOneAxis: function(scope, options) {\n\t\t\tsvgHelpers.addXAxis(scope, options);\n\t\t\tscope.ylTopOffset = options.x.position === 'top'? options.height*0.125:options.height*0.2;\n\n\t\t\tscope.guide = scope.svg.append('g')\n\t\t\t\t.attr('class', 'guide');\n\n\t\t\tvar guidePosition =\n\t\t\t\toptions.axis.guidePosition === 'bottom'? options.height*1:(scope.ylTopOffset - options.height*0.03);\n\t\t\tscope.guide\n\t\t\t\t.append('line')\n\t\t\t\t.attr('x1', scope.xlLeftOffset)\n\t\t\t\t.attr('x2', options.width + scope.xlLeftOffset)\n\t\t\t\t.attr('y1', guidePosition)\n\t\t\t\t.attr('y2', guidePosition)\n\t\t\t\t.style('stroke', '#BBB')\n\t\t\t\t.style('stroke-width', 1)\n\t\t\t\t.style('shape-rendering', 'crispEdges');\n\t\t},\n\n\t\tsetXScale: function(scope, options) {\n\t\t\tscope.x = d3.scaleBand();\n\t\t\tscope.x\n\t\t\t\t.range([0, options.width]);\n\n\t\t\tif(!d3Helpers.isDefined(scope.xAxis)) {\n\t\t\t\tif(!d3Helpers.isDefined(options.x.orient) || !d3Helpers.isString(options.x.orient) ||\n\t\t\t\t\t(options.x.orient !== 'axisBottom' && options.x.orient !== 'axisTop')) {\n\t\t\t\t\t$log.warn('[Angular - D3] Tick orient must be a string. Setting default value \"axisBottom\"');\n\t\t\t\t\toptions.x.orient = 'axisBottom';\n\t\t\t\t}\n\t\t\t\tscope.xAxis = d3[options.x.orient](scope.x);\n\t\t\t} else {\n\t\t\t\tscope.xAxis.scale(scope.x);\n\t\t\t}\n\n\t\t\tif(d3Helpers.isDefined(options.x.tickSize) && d3Helpers.isNumber(options.x.tickSize)) {\n\t\t\t\tscope.xAxis.tickSize(options.x.tickSize);\n\t\t\t} else {\n\t\t\t\t$log.warn('[Angular - D3] Ticksize must be a number. Setting default value 6');\n\t\t\t\toptions.x.tickSize = 6;\n\t\t\t\tscope.xAxis.tickSize(options.x.tickSize);\n\t\t\t}\n\n\t\t\tvar data  = d3Helpers.getDataFromScope(scope, options);\n\t\t\tscope.x\n\t\t\t\t.domain(data.map(function(d) { return d[options.x.key]; }))\n\t\t\t\t.rangeRound([0, options.width])\n\t\t\t\t.paddingInner(options.bar.gap);\n\t\t\tscope.xAxis.tickFormat(options.x.tickFormat);\n\t\t\tif(d3Helpers.isDefined(scope.data)) {\n\t\t\t\tthis.updateData(scope.data, options);\n\t\t\t}\n\t\t},\n\n\t\tsetYScale: function(scope, options) {\n\t\t\tswitch(options.y.scale) {\n\t\t\t\tcase 'log':\n\t\t\t\t\tscope.y = d3.scaleLog().clamp(true);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'sqrt':\n\t\t\t\t\tscope.y = d3.scaleSqrt();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'time':\n\t\t\t\t\tscope.y = d3.scaleTime();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif(options.y.scale !== 'linear') {\n\t\t\t\t\t\t$log.warn('[Angular - D3] Ticksize must be a string and [\"linear\", \"log\", \"time\", \"sqrt\"]. Setting default value \"linear\"');\n\t\t\t\t\t\toptions.y.scale = 'linear';\n\t\t\t\t\t}\n\t\t\t\t\tscope.y = d3.scaleLinear();\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvar dy = 0;\n\t\t\tif(scope.type === 'oneAxisBar') {\n\t\t\t\tdy = options.height*0.2;\n\n\t\t\t\tif(options.axis.guidePosition === 'bottom') {\n\t\t\t\t\tdy += options.height*0.05;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(options.y.direction === 'btt') {\n\t\t\t\tscope.y.range([options.height - dy, 0]);\n\t\t\t} else {\n\t\t\t\tscope.y.range([0, options.height - dy]);\n\t\t\t}\n\t\t\tif(!d3Helpers.isDefined(scope.yAxis)) {\n\t\t\t\tif(!d3Helpers.isDefined(options.y.orient) || !d3Helpers.isString(options.y.orient)) {\n\t\t\t\t\t$log.warn('[Angular - D3] Tick orient must be a string. Setting default value \"left\"');\n\t\t\t\t\toptions.y.orient = 'axisLeft';\n\t\t\t\t}\n\t\t\t\tscope.yAxis = d3[options.y.orient](scope.y);\n\t\t\t} else {\n\t\t\t\tscope.yAxis.scale(scope.y);\n\t\t\t}\n\n\t\t\tif(d3Helpers.isDefined(options.y.tickSize) && d3Helpers.isNumber(options.y.tickSize)) {\n\t\t\t\tscope.yAxis.tickSize(options.y.tickSize);\n\t\t\t} else {\n\t\t\t\t$log.warn('[Angular - D3] Ticksize must be a number. Setting default value 6');\n\t\t\t\toptions.y.tickSize = 6;\n\t\t\t\tscope.yAxis.tickSize(options.y.tickSize);\n\t\t\t}\n\n\t\t\tswitch(options.y.scale) {\n\t\t\t\tcase 'log':\n\t\t\t\t\tif(!d3Helpers.isDefined(options.y.tickFormat)) {\n\t\t\t\t\t\toptions.y.tickFormat = function(d) {\n\t\t\t\t\t\t\tvar base = d3.round(Math.log(d)/Math.LN10, 3);\n\t\t\t\t\t\t\treturn base%1 === 0? d:'';\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tscope.yAxis.ticks(options.y.ticks);\n\t\t\t\t\tscope.y.domain([0.1, 1000]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'time':\n\t\t\t\t\tif(!d3Helpers.isDefined(options.y.tickFormat)) {\n\t\t\t\t\t\tvar locale = d3Helpers.isDefined(options.locale)? options.locale.timeFormat:d3.timeFormat;\n\t\t\t\t\t\toptions.y.tickFormat = locale.multi([\n\t\t\t\t\t\t\t['.%L', function(d) { return d.getMilliseconds(); }],\n\t\t\t\t\t\t\t[':%S', function(d) { return d.getSeconds(); }],\n\t\t\t\t\t\t\t['%I:%M', function(d) { return d.getMinutes(); }],\n\t\t\t\t\t\t\t['%I %p', function(d) { return d.getHours(); }],\n\t\t\t\t\t\t\t['%a %d', function(d) { return d.getDay() && d.getDate() !== 1; }],\n\t\t\t\t\t\t\t['%b %d', function(d) { return d.getDate() !== 1; }],\n\t\t\t\t\t\t\t['%B', function(d) { return d.getMonth(); }],\n\t\t\t\t\t\t\t['%Y', function() { return true; }]\n\t\t\t\t\t\t]);\n\t\t\t\t\t}\n\t\t\t\t\tscope.yAxis.ticks(options.y.ticks);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tscope.yAxis.ticks(options.y.ticks + options.y.ticks * options.y.tickSubdivide);\n\t\t\t\t\tscope.y.domain([0, 100]);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tscope.yAxis.tickFormat(options.y.tickFormat);\n\t\t\tif(d3Helpers.isDefined(scope.data)) {\n\t\t\t\tthis.updateData(scope.data, options);\n\t\t\t}\n\t\t},\n\n\t\tzoomBehaviour: function() {\n\t\t},\n\n\t\tupdateData: function(scope, options) {\n\t\t\tif(!d3Helpers.isDefined(scope.x) || !d3Helpers.isDefined(scope.y)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar data = d3Helpers.getDataFromScope(scope, options);\n\t\t\tvar _idFunction = function(d) {\n\t\t\t\treturn d[options.idKey];\n\t\t\t};\n\t\t\tif(d3Helpers.isUndefinedOrEmpty(data)) {\n\t\t\t\t$log.warn('[Angular - D3] No data for bars');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t$log.debug('[Angular - D3] Data for bars:', data);\n\n\t\t\tvar formatTime = d3.timeFormat(options.timeFormat);\n\t\t\tvar colors = d3Helpers.setColors(options.bar.colors);\n\n\t\t\tvar mapFunction = function(d) {\n\t\t\t\treturn d[options.y.key].map(function(e, i) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: i,\n\t\t\t\t\t\tparentId: d[options.idKey],\n\t\t\t\t\t\tx: d[options.x.key],\n\t\t\t\t\t\ty: e\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar domain = data.map(function(d) { return d[options.x.key]; });\n\t\t\tscope.x.domain(domain);\n\t\t\tscope.xl.call(scope.xAxis);\n\t\t\t$log.debug('[Angular - D3] x domain:', domain);\n\n\t\t\tvar totals = [];\n\t\t\tvar max = d3.max(data, function(d) {\n\t\t\t\treturn d3.max(d[options.y.key], function(v, i) {\n\t\t\t\t\tif(options.y.scale === 'time' && !(v instanceof Date)) {\n\t\t\t\t\t\tv = formatTime.parse(v);\n\t\t\t\t\t}\n\t\t\t\t\tif(!d3Helpers.isDefined(totals[i])) {\n\t\t\t\t\t\ttotals.push(v);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttotals[i] += v;\n\t\t\t\t\t}\n\t\t\t\t\treturn v;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tvar min = 0;\n\n\t\t\tif(!options.y.minFromZero) {\n\t\t\t\tmin = d3.min(data, function(d) {\n\t\t\t\t\treturn d3.min(d[options.y.key]);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t$log.debug('[Angular - D3] Data max for bars:', max);\n\n\t\t\tif(min === undefined || max === undefined || (min === 0 && max === 0)) {\n\t\t\t\tmin = 0;\n\t\t\t\tmax = options.y.scale === 'time'? new Date():100;\n\t\t\t} else if((min - max) === 0) {\n\t\t\t\tmin = min instanceof Date? 0:(min - Math.abs(min/2));\n\t\t\t\tmax = max instanceof Date? max:(max + Math.abs(max/2));\n\t\t\t}\n\n\t\t\tscope.y.domain([min, max]);\n\t\t\tif(min < max) {\n\t\t\t\tscope.y.nice();\n\t\t\t}\n\n\t\t\tif(scope.type === 'bar') {\n\t\t\t\tscope.yl.call(scope.yAxis);\n\t\t\t\tsvgHelpers.addSubdivideTicks(scope.yl, scope.y, scope.yAxis, options.y);\n\t\t\t}\n\n\t\t\tif(d3Helpers.isDefined(scope.zoom) && d3Helpers.isDefined(options.zoom) && options.zoom) {\n\t\t\t\t// scope.zoom.x(scope.x).y(scope.y);\n\t\t\t}\n\n\t\t\tvar yMaxPoints = d3.max(data.map(function(d){ return d[options.y.key].length; }));\n\t\t\tvar x0 = d3.scaleBand()\n\t\t\t\t.domain(d3.range(yMaxPoints))\n\t\t\t\t.rangeRound([0, scope.x.bandwidth()]);\n\n\t\t\tvar barsContainer = scope.svg.select('g.' + scope.classPrefix + '-bars');\n\t\t\tif(barsContainer.empty()) {\n\t\t\t\tbarsContainer = scope.svg.append('g')\n\t\t\t\t\t.attr('transform', 'translate(' + scope.xlLeftOffset + ',' + scope.ylTopOffset + ')')\n\t\t\t\t\t.attr('class', scope.classPrefix + '-bars')\n\t\t\t\t\t.attr('clip-path', 'url(#'+scope.idClip+')');\n\t\t\t}\n\n\t\t\tvar updateBars = function(bars, update) {\n\t\t\t\tif(d3Helpers.isDefined(options.bar.path)) {\n\t\t\t\t\tbars\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.duration(options.animations.time)\n\t\t\t\t\t\t.attrTween('transform', function(d, i, a) {\n\t\t\t\t\t\t\tvar iconHeight = 115;\n\t\t\t\t\t\t\tvar percentH = Math.abs((scope.y(d.y) - scope.y(min))/iconHeight);\n\t\t\t\t\t\t\tvar dy = 0;\n\t\t\t\t\t\t\tvar trans = 'translate(' + (scope.x(d.x) + x0(i) - 102*percentH/2 + x0.bandwidth()/2) + ', ' + dy + ')';\n\t\t\t\t\t\t\tvar inp = d3.interpolateString(a, trans);\n\t\t\t\t\t\t\treturn function(t) {\n\t\t\t\t\t\t\t\treturn inp(t);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\n\t\t\t\t\tif(update) {\n\t\t\t\t\t\tbars = bars.selectAll('path');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbars = bars.append('path')\n\t\t\t\t\t\t\t.attr('d', options.bar.path)\n\t\t\t\t\t\t\t.attr('class', 'a3bar-bar-path')\n\t\t\t\t\t\t\t.attr('fill-rule', 'evenodd')\n\t\t\t\t\t\t\t.attr('transform', 'scale(0)')\n\t\t\t\t\t\t\t.style('opacity', 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tbars\n\t\t\t\t\t\t.style('fill', function(d, i) {\n\t\t\t\t\t\t\tvar color = d3.rgb(colors(i));\n\t\t\t\t\t\t\treturn color;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.style('stroke', function(d, i) {\n\t\t\t\t\t\t\treturn d3.rgb(colors(i)).darker();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.style('stroke-width', 1)\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t\t\t.duration(options.animations.time)\n\t\t\t\t\t\t.attrTween('transform', function(d, i, a) {\n\t\t\t\t\t\t\td = d3.select(this.parentNode).data()[0];\n\t\t\t\t\t\t\tvar percentW = x0.bandwidth()/102;\n\t\t\t\t\t\t\tvar percentH = Math.abs((scope.y(d.y) - scope.y(min))/115);\n\t\t\t\t\t\t\treturn d3.interpolateString(a, 'scale(' + percentW + ', ' + percentH + ')');\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.style('opacity', 0.8);\n\t\t\t\t} else {\n\t\t\t\t\tbars\n\t\t\t\t\t\t.attr('width', x0.bandwidth())\n\t\t\t\t\t\t.attr('title', function(d) {\n\t\t\t\t\t\t\tvar format = d3.format('.3');\n\t\t\t\t\t\t\tif(d3Helpers.isDefined(options.y.tickFormat)) {\n\t\t\t\t\t\t\t\tformat = options.y.tickFormat;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn format(d.y);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('x', function(d, i) {\n\t\t\t\t\t\t\tvar x = scope.x(d.x) + x0(i);\n\t\t\t\t\t\t\treturn isNaN(x)? 0:x;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('y', function() {\n\t\t\t\t\t\t\tvar h = d3.select(this).attr('height');\n\t\t\t\t\t\t\tvar dy = options.y.direction === 'btt'? scope.y(0)-h:0;\n\t\t\t\t\t\t\treturn dy;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('height', function() {\n\t\t\t\t\t\t\tvar h = d3.select(this).attr('height');\n\t\t\t\t\t\t\treturn h? h:0;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t//.style('opacity', 0)\n\t\t\t\t\t\t.style('fill', function() {\n\t\t\t\t\t\t\tvar fill = d3.select(this).style('fill');\n\t\t\t\t\t\t\treturn fill === 'rgb(0, 0, 0)'?\n\t\t\t\t\t\t\t\td3.rgb(255,255,255):fill;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t\t\t.duration(options.animations.time)\n\t\t\t\t\t\t.attr('height', function(d) {\n\t\t\t\t\t\t\treturn Math.abs(scope.y(d.y) - scope.y(min));\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('y', function(d) {\n\t\t\t\t\t\t\tvar h = Math.abs(scope.y(d.y) - scope.y(min));\n\t\t\t\t\t\t\tvar dy = options.y.direction === 'btt'? scope.y(0)-h:0;\n\t\t\t\t\t\t\treturn dy;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t.attrTween('transform', function(d, i, a) {\n\t\t\t\t\t\t\tvar h = Math.abs(scope.y(d.y) - scope.y(min));\n\t\t\t\t\t\t\tvar dy = options.y.direction === 'btt'? (scope.y.range()[1] - h):0;\n\t\t\t\t\t\t\tvar inp = d3.interpolateTransformSvg(a, 'translate(0, ' + dy + ')');\n\t\t\t\t\t\t\treturn inp;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t*/\n\t\t\t\t\t\t.styleTween('fill', function(d, i, a) {\n\t\t\t\t\t\t\tvar color = d3.rgb(colors(i));\n\t\t\t\t\t\t\tvar inp;\n\t\t\t\t\t\t\tif(d3Helpers.isDefined(options.bar.colorInterpolator) && d3Helpers.isFunction(options.bar.colorInterpolator)) {\n\t\t\t\t\t\t\t\tinp = options.bar.colorInterpolator(color.brighter(), color.darker());\n\t\t\t\t\t\t\t\tcolor = inp(d.y/max);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// TODO Check subcolors.\n\t\t\t\t\t\t\tvar returnColor = d3Helpers.isDefined(options.bar.subcolors)? options.bar.subcolors[d.parentId-1]:color;\n\t\t\t\t\t\t\tinp = d3.interpolateRgb(a, returnColor);\n\t\t\t\t\t\t\treturn inp;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//.style('opacity', 1);\n\t\t\t\t}\n\t\t\t\tbars.select('title').remove();\n\t\t\t\tbars.append('title')\n\t\t\t\t\t.text(function(d) {\n\t\t\t\t\t\tvar format = d3.format('.3g');\n\t\t\t\t\t\tif(d3Helpers.isDefined(options.y.tickFormat)) {\n\t\t\t\t\t\t\tformat = options.y.tickFormat;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn format(d.y);\n\t\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar barGroups = barsContainer\n\t\t\t\t.selectAll('.' + scope.classPrefix + '-group-bar')\n\t\t\t\t.data(data, _idFunction);\n\t\t\t// barGroups.interrupt();\n\n\t\t\tbarGroups.each(function(d) {\n\t\t\t\tvar barGroup = d3.select(this);\n\t\t\t\tvar bars = barGroup\n\t\t\t\t\t.selectAll('.' + scope.classPrefix + '-bar')\n\t\t\t\t\t.data(function() {\n\t\t\t\t\t\tvar newData = mapFunction(d);\n\t\t\t\t\t\treturn newData;\n\t\t\t\t\t}, function(d) {\n\t\t\t\t\t\treturn d.id;\n\t\t\t\t\t});\n\n\n\t\t\t\tupdateBars(bars, true);\n\t\t\t\tbars\n\t\t\t\t\t.enter()\n\t\t\t\t\t.append(d3Helpers.isDefined(options.bar.path)? 'g':'rect')\n\t\t\t\t\t.attr('class', scope.classPrefix + '-bar');\n\t\t\t\tupdateBars(bars, true);\n\t\t\t\tbars.exit().remove();\n\t\t\t\tbars = barGroup\n\t\t\t\t\t.selectAll('.' + scope.classPrefix + '-bar');\n\t\t\t\tupdateBars(bars, true);\n\t\t\t});\n\n\n\t\t\tvar series = barGroups.enter()\n\t\t\t\t.append('g')\n\t\t\t\t.attr('class', scope.classPrefix + '-group-bar');\n\n\t\t\tvar bars = series.selectAll('.' + scope.classPrefix + '-bar')\n\t\t\t\t.data(mapFunction, function(d) {\n\t\t\t\t\treturn d.id;\n\t\t\t\t})\n\t\t\t\t// .interrupt()\n\t\t\t\t.enter()\n\t\t\t\t.append(d3Helpers.isDefined(options.bar.path)? 'g':'rect')\n\t\t\t\t.attr('class', scope.classPrefix + '-bar');\n\t\t\tupdateBars(bars);\n\n\t\t\t//bars.exit().remove();\n\t\t\tbarGroups.exit().remove();\n\n\t\t\tif(scope.type === 'oneAxisBar') {\n\t\t\t\tscope.svg.select('g.' + scope.classPrefix +'-helptext').remove();\n\n\t\t\t\tvar helpTextContainer = scope.svg.append('g')\n\t\t\t\t\t.attr('transform', 'translate(' + scope.xlLeftOffset + ',' +\n\t\t\t\t\t\t(scope.ylTopOffset - (options.x.position === 'bottom'? options.height*0.15:-options.height*0.85)) + ')')\n\t\t\t\t\t.attr('class', scope.classPrefix + '-helptext');\n\n\t\t\t\tvar textGroups = helpTextContainer.selectAll('.' + scope.classPrefix + '-values')\n\t\t\t\t\t.data(data, _idFunction)\n\t\t\t\t\t.interrupt();\n\n\t\t\t\tseries = textGroups.enter()\n\t\t\t\t\t.append('g')\n\t\t\t\t\t.attr('class', scope.classPrefix + '-values');\n\n\t\t\t\tif(options.axis.showValues) {\n\t\t\t\t\tseries.selectAll('.' + scope.classPrefix + '-val')\n\t\t\t\t\t\t.data(mapFunction, function(d) {\n\t\t\t\t\t\t\treturn d.id;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.interrupt()\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append('text')\n\t\t\t\t\t\t.attr('x', function(d, i) {\n\t\t\t\t\t\t\treturn scope.x(d.x) + x0(i) + x0.bandwidth()/2;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('dy', !options.axis.showPercent? '0.5em':0)\n\t\t\t\t\t\t.attr('class', scope.classPrefix + '-val')\n\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\t\t.style('fill', options.axis.valuesColor)\n\t\t\t\t\t\t.text(function(d) {\n\t\t\t\t\t\t\tvar format = d3.format('.3g');\n\t\t\t\t\t\t\treturn format(d.y);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif(options.axis.showPercent) {\n\t\t\t\t\tseries.selectAll('.' + scope.classPrefix + '-percent')\n\t\t\t\t\t\t.data(mapFunction, function(d) {\n\t\t\t\t\t\t\treturn d.id;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.interrupt()\n\t\t\t\t\t\t.enter()\n\t\t\t\t\t\t.append('text')\n\t\t\t\t\t\t.attr('x', function(d, i) {\n\t\t\t\t\t\t\treturn scope.x(d.x) + x0(i) + x0.bandwidth()/2;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.attr('y', options.height*0.065)\n\t\t\t\t\t\t.attr('dy', !options.axis.showValues? '-0.5em':0)\n\t\t\t\t\t\t.attr('class', scope.classPrefix + '-percent')\n\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\t\t.style('font-size', '0.85em')\n\t\t\t\t\t\t.style('font-weight', 'bold')\n\t\t\t\t\t\t.style('fill', options.axis.percentColor)\n\t\t\t\t\t\t.text(function(d, i) {\n\t\t\t\t\t\t\tvar format = d3.format('.3p');\n\t\t\t\t\t\t\treturn format(d.y/totals[i]);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsvgHelpers.updateStyles(scope, options);\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('pieHelpers', function ($log, d3Helpers, svgHelpers) {\n\n\tfunction _tweenPie($this, scope, options, b) {\n\t\tb.innerRadius = 0;\n\t\tvar start = null;\n\t\tswitch(options.pieAnimation) {\n\t\t\tcase 'inverse':\n\t\t\t\tstart = {startAngle: 2*Math.PI, endAngle: 2*Math.PI};\n\t\t\t\tbreak;\n\t\t\tcase 'crossfade':\n\t\t\t\tstart = {startAngle: 2*Math.PI, endAngle: 0};\n\t\t\t\tbreak;\n\t\t\tcase 'crossfade-inverse':\n\t\t\t\tstart = {startAngle: 0, endAngle: 2*Math.PI};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif(!d3Helpers.isDefined(options.pieAnimation) || options.pieAnimation === '') {\n\t\t\t\t\t$log.warn('[Angular - D3] The option \"pieAnimation\" is undefined or it has a invalid value. Setting to \"normal\"');\n\t\t\t\t\toptions.pieAnimation = 'normal';\n\t\t\t\t}\n\t\t\t\tstart = {startAngle: 0, endAngle: 0};\n\t\t\t\tbreak;\n\t\t}\n\t\tif($this._current) {\n\t\t\tstart = $this._current;\n\t\t}\n\t\tvar i = d3.interpolate(start, b);\n\t\t$this._current = i(0);\n\t\treturn function(t) {\n\t\t\treturn scope.arc(i(t));\n\t\t};\n\t}\n\n\t// Find the element in data0 that joins the highest preceding element in data1.\n\tfunction findPreceding(i, data0, data1, key) {\n\t\tvar m = data0.length;\n\t\twhile (--i >= 0) {\n\t\t\tvar k = key(data1[i]);\n\t\t\tfor (var j = 0; j < m; ++j) {\n\t\t\t\tif (key(data0[j]) === k) {\n\t\t\t\t\treturn data0[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Find the element in data0 that joins the lowest following element in data1.\n\tfunction findFollowing(i, data0, data1, key) {\n\t\tvar n = data1.length, m = data0.length;\n\t\twhile (++i < n) {\n\t\t\tvar k = key(data1[i]);\n\t\t\tfor (var j = 0; j < m; ++j) {\n\t\t\t\tif (key(data0[j]) === k) {\n\t\t\t\t\treturn data0[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction findNeighborArc(i, data0, data1, key) {\n    var d;\n\t\tvar obj;\n    if(d = findPreceding(i, data0, data1, key)) {\n      obj = angular.copy(d);\n      obj.startAngle = d.endAngle;\n      return obj;\n    } else if(d = findFollowing(i, data0, data1, key)) {\n      obj = angular.copy(d);\n      obj.endAngle = d.startAngle;\n      return obj;\n    }\n    return null;\n  }\n\n\tvar pathAnim = function(path, dir, options) {\n\t\tswitch(dir) {\n\t\t\tcase 0:\n\t\t\t\tpath\n\t\t\t\t\t.style('stroke', null)\n\t\t\t\t\t.transition('pie-animation')\n\t\t\t\t\t.duration(500)\n\t\t\t\t\t.ease(d3.easeBounce)\n\t\t\t\t\t.style('stroke-opacity', 0)\n\t\t\t\t\t.style('stroke-width', 0)\n\t\t\t\t\t.attr('d', d3.arc()\n\t\t\t\t\t\t.outerRadius(options.radius * 0.9)\n\t\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tpath\n\t\t\t\t\t.style('stroke', function() {\n\t\t\t\t\t\treturn d3.color(d3.select(this).attr('fill')).darker();\n\t\t\t\t\t})\n\t\t\t\t\t.style('stroke-opacity', 0)\n\t\t\t\t\t.style('stroke-width', 0)\n\t\t\t\t\t.transition('pie-animation')\n\t\t\t\t\t.style('stroke-opacity', 1)\n\t\t\t\t\t.style('stroke-width', 1)\n\t\t\t\t\t.attr('d', d3.arc()\n\t\t\t\t\t\t.outerRadius(options.radius * 0.95)\n\t\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tpath\n\t\t\t\t\t.style('stroke', function() {\n\t\t\t\t\t\treturn d3.color(d3.select(this).attr('fill')).darker();\n\t\t\t\t\t})\n\t\t\t\t\t.style('stroke-opacity', 0)\n\t\t\t\t\t.style('stroke-width', 0)\n\t\t\t\t\t.transition('pie-animation')\n\t\t\t\t\t.style('stroke-opacity', 1)\n\t\t\t\t\t.style('stroke-width', 1)\n\t\t\t\t\t.attr('d', d3.arc()\n\t\t\t\t\t\t.outerRadius(options.radius * 0.95)\n\t\t\t\t\t);\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\tvar midAngle = function(d) {\n\t\treturn d.startAngle + (d.endAngle - d.startAngle)/2;\n\t};\n\n\tvar _wrapLabels = function(scope, options) {\n\t\tscope.svg.selectAll('.' + scope.classPrefix + '-lines g text')\n\t\t\t.each(function() {\n\t\t\t\tvar rect = this.parentNode.getBoundingClientRect();\n\t\t\t\tif(rect.left < 0) {\n\t\t\t\t\tsvgHelpers.wrap(this, rect.right);\n\t\t\t\t} else if(rect.right > options.width) {\n\t\t\t\t\tsvgHelpers.wrap(this, options.width - rect.left);\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\treturn {\n\t\taddArc: function(scope, options) {\n\t\t\tvar w = options.width - options.margin.left - options.margin.right;\n\t\t\tif(options.legend.show && options.legend.type === 'vertical') {\n\t\t\t\tw -= options.legend.size;\n\t\t\t}\n\t\t\tvar h = options.height - options.margin.top - options.margin.bottom;\n\t\t\toptions.radius = Math.min(w, h) / 2;\n\t\t\tscope.arc = d3.arc()\n\t\t\t\t.outerRadius(options.radius * 0.9);\n\n\t\t\tscope.outerArc = d3.arc()\n\t\t\t\t.innerRadius(options.radius * 1)\n\t\t\t\t.outerRadius(options.radius * 1);\n\n\t\t\tscope.pie = d3.pie()\n\t\t\t\t.value(function(d) { return d[options.y.key]; })\n\t\t    .sort(null);\n\n\t\t\t// ===========================================================================================\n\t    // g elements to keep elements within svg modular\n\t\t\tscope.svg.append('g').attr('class', scope.classPrefix + '-slices');\n\t\t\tscope.svg.append('g').attr('class', scope.classPrefix + '-labelName');\n\t    scope.svg.append('g').attr('class', scope.classPrefix + '-lines');\n\t    // ===========================================================================================\n\t\t},\n\n\t\tupdateData: function(scope, options) {\n\t\t\t$log.debug('Update data');\n\t\t\t// var percentFormat = d3.format(',.2%');\n\t\t\tvar colors = d3Helpers.setColors(options.pie.colors);\n\t\t\tvar data = d3Helpers.getDataFromScope(scope, options);\n\t\t\tdata = data.filter(function(d) {\n\t\t\t\treturn d3Helpers.isDefined(d[options.y.key]) && !isNaN(d[options.y.key]);\n\t\t\t});\n\n\t\t\tif(d3Helpers.isUndefinedOrEmpty(data)) {\n\t\t\t\t$log.warn('[Angular - D3] No data for pie');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Key function for get data.\n\t\t\tvar key = function(d) {\n\t\t\t\tif(angular.isUndefined(d)) {\n\t\t\t\t\treturn d;\n\t\t\t\t}\n\t\t\t\tif(angular.isUndefined(d.data)) {\n\t\t\t\t\treturn d.data;\n\t\t\t\t}\n\t\t\t\treturn d.data[options.idKey];\n\t\t\t};\n\n\t\t\tvar arcTween = function() {\n\t\t\t\treturn _tweenPie(this, scope, options, d3.select(this).data()[0]);\n\t\t\t};\n\n\t\t\tvar removeTooltip = function() {\n\t\t\t\tvar lines = scope.svg.select('.a3pie-lines');\n\t\t\t\tlines\n\t\t\t\t\t.selectAll('g')\n\t\t\t\t\t.remove();\n\n\t\t\t\treturn lines;\n\t\t\t};\n\n\t\t\tvar onTooltip = function(d) {\n\t\t\t\tpathAnim(d3.select(this), 1, options);\n\t\t\t\tvar lines = removeTooltip();\n\t\t\t\tvar g = lines.append('g');\n\t\t\t\tvar polyline = g.append('polyline');\n\n\t\t\t\tpolyline\n\t\t\t\t\t.style('opacity', 0.3)\n\t\t\t\t\t.style('stroke', 'black')\n\t\t\t\t\t.style('stroke-width', '2px')\n\t\t\t\t\t.style('fill', 'none')\n\t\t\t\t\t.transition().duration(1000)\n\t\t\t\t\t.attrTween('points', function() {\n\t\t\t\t\t\tthis._current = this._current || d;\n\t\t\t\t\t\tvar interpolate = d3.interpolate(this._current, d);\n\t\t\t\t\t\tthis._current = interpolate(0);\n\n\t\t\t\t\t\treturn function(t) {\n\t\t\t\t\t\t\tvar d2 = interpolate(t);\n\t\t\t\t\t\t\tvar pos = scope.outerArc.centroid(d2);\n\t\t\t\t\t\t\tpos[0] = options.radius * 0.95 * (midAngle(d2) < Math.PI ? 1 : -1);\n\t\t\t\t\t\t\treturn [scope.arc.centroid(d2), scope.outerArc.centroid(d2), pos];\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\n\t\t\t\tvar text = g.append('text')\n\t\t\t\t\t.attr('dy', '.35em')\n\t\t\t\t\t.html(function() {\n\t\t\t\t\t\treturn d.data[options.x.key];\n\t\t\t\t\t});\n\n\t\t\t\ttext\n\t\t\t\t\t.attr('transform', function() {\n\t\t\t\t\t\tthis._current = this._current || d;\n\t\t\t\t\t\tvar pos = scope.outerArc.centroid(this._current);\n\t\t\t\t\t\tpos[0] = options.radius * (midAngle(this._current) < Math.PI ? 1 : -1);\n\t\t\t\t\t\treturn 'translate('+ pos +')';\n\t\t\t\t\t})\n\t\t\t\t\t.style('text-anchor', function(){\n\t\t\t\t\t\tthis._current = this._current || d;\n\t\t\t\t\t\treturn midAngle(this._current) < Math.PI ? 'start':'end';\n\t\t\t\t\t})\n\t\t\t\t\t.each(function() {\n\t\t\t\t\t\tsvgHelpers.wrap(this, options.tooltipSize);\n\t\t\t\t\t});\n\t\t\t};\n\n\t\t\t//scope.svg.selectAll('.' + scope.classPrefix + '-arc').remove();\n\n\t\t\t// ===========================================================================================\n\t\t\t// add and colour the pie slices\n\t\t\tscope.slices = scope.svg.selectAll('.' + scope.classPrefix + '-slices');\n\t\t\tvar path = scope.slices.selectAll('path');\n\t\t\tvar dataSlices = path.data();\n\t\t\tvar pieData = scope.pie(data);\n\n\t\t\tvar arcs = path.data(pieData, key);\n\n\t\t\tarcs\n\t\t\t\t.on('mouseout', null)\n\t\t\t\t.on('mouseover', null)\n\t\t\t\t.transition()\n\t\t\t\t.duration(options.animations.time)\n\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t.on('end', function() {\n\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\t\t\tpathAnim(d3.select(this), 1, options);\n\t\t\t\t\t\t\tonTooltip(d);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('mouseout', function() {\n\t\t\t\t\t\t\tremoveTooltip();\n\t\t\t\t\t\t\tpathAnim(d3.select(this), 0, options);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('click', onTooltip);\n\t\t\t\t})\n\t\t\t\t.attr('fill', function(d) {\n\t\t\t\t\tif(angular.isDefined(options.colorKey) && angular.isDefined(d.data[options.colorKey])) {\n\t\t\t\t\t\treturn d.data[options.colorKey];\n\t\t\t\t\t}\n\t\t\t\t\treturn colors(d.data[options.x.key]);\n\t\t\t\t})\n\t\t\t\t.attrTween('d', arcTween);\n\n\t\t\tarcs.enter()\n\t\t\t\t.append('path')\n\t\t\t\t.each(function(d, i) {\n\t\t\t\t\tvar narc = findNeighborArc(i, dataSlices, pieData, key);\n\t\t\t\t\tif(narc) {\n\t\t\t\t\t\tthis._current = narc;\n\t\t\t\t\t\tthis._previous = narc;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._current = d;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.attr('fill', function(d) {\n\t\t\t\t\tif(angular.isDefined(options.colorKey) && angular.isDefined(d.data[options.colorKey])) {\n\t\t\t\t\t\treturn d.data[options.colorKey];\n\t\t\t\t\t}\n\t\t\t\t\treturn colors(d.data[options.x.key]);\n\t\t\t\t})\n\t\t\t\t.transition('pie-enter')\n\t\t\t\t.duration(options.animations.time)\n\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t.on('end', function() {\n\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\t\t\tpathAnim(d3.select(this), 1, options);\n\t\t\t\t\t\t\tonTooltip(d);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('mouseout', function() {\n\t\t\t\t\t\t\tremoveTooltip();\n\t\t\t\t\t\t\tpathAnim(d3.select(this), 0, options);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('click', onTooltip);\n\t\t\t\t})\n\t\t\t\t.attrTween('d', arcTween);\n\n\t\t\tarcs\n\t\t\t\t.exit()\n\t\t\t\t.each(function() {\n\t\t\t\t\td3.select(this)\n\t\t\t\t\t.on('mouseout', null)\n\t\t\t\t\t.on('mouseover', null);\n\t\t\t\t})\n\t\t\t\t.transition()\n\t\t\t\t.duration(options.animations.time)\n\t\t\t\t.ease(options.animations.ease)\n\t\t\t\t.attrTween('d', function(d, idx) {\n\t\t\t\t\tvar previous = this._previous? this._previous:findNeighborArc(idx, pieData, dataSlices, key);\n\t\t\t\t\tvar i = d3.interpolateObject(d, previous);\n\t\t\t\t\treturn function(t) {\n\t\t\t\t\t\treturn scope.arc(i(t));\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t\t.remove();\n\n\t\t\t// ===========================================================================================\n\n\t\t\tthis.setStyles(scope, options);\n\n\t\t\tif(options.legend.show) {\n\t\t\t\tthis.createLegend(scope, options, colors);\n\t\t\t}\n\t\t},\n\n\t\tcreateLegend: function(scope, options, colors) {\n\t\t\tvar percentFormat = d3.format(',.2%');\n\t\t\tvar data = d3Helpers.getDataFromScope(scope, options);\n\n\t\t\tvar total = d3.sum(data, function(d) {\n\t\t\t\treturn d[options.y.key];\n\t\t\t});\n\n\t\t\t// Key function for get data.\n\t\t\tvar key = function(d) {\n\t\t\t\tif(angular.isUndefined(d)) {\n\t\t\t\t\treturn d;\n\t\t\t\t}\n\t\t\t\treturn d[options.idKey];\n\t\t\t};\n\n\n\t\t\tif(!scope.legend) {\n\t\t\t\tvar left;\n\t\t\t\tvar top;\n\t\t\t\tif(options.legend.type === 'vertical') {\n\t\t\t\t\tleft = options.radius + options.legend.gap;\n\t\t\t\t\ttop = -options.radius*0.9;\n\t\t\t\t} else {\n\t\t\t\t\tleft = -options.containerWidth/2 + options.margin.left;\n\t\t\t\t\ttop = options.radius + options.legend.gap;\n\t\t\t\t}\n\t\t\t\tscope.legend = scope.svg\n\t\t\t\t\t.append('g')\n\t\t\t\t\t.attr('class', 'legend')\n\t\t\t\t\t.attr('transform', 'translate(' + left  +', ' + top + ')');\n\t\t\t}\n\n\t\t\tvar items = scope.legend\n\t\t\t\t.selectAll('.legend-item')\n\t\t\t\t.data(data, key);\n\n\t\t\titems\n\t\t\t\t.selectAll('text')\n\t\t\t\t.html(function() {\n\t\t\t\t\tvar d = d3.select(this.parentNode).data()[0];\n\t\t\t\t\treturn d[options.x.key] + ' (' + percentFormat(d[options.y.key]/total) + ')';\n\t\t\t\t})\n\t\t\t\t.each(function() {\n\t\t\t\t\tif(options.legend.type === 'vertical') {\n\t\t\t\t\t\tsvgHelpers.wrap(this, options.legend.size - 20);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\titems\n\t\t\t\t.selectAll('rect')\n\t\t\t\t.attr('fill', function() {\n\t\t\t\t\tvar d = d3.select(this.parentNode).data()[0];\n\t\t\t\t\treturn colors(d[options.x.key]);\n\t\t\t\t});\n\n\t\t\tvar item = items.enter()\n\t\t\t\t.append('g')\n\t\t\t\t.attr('class', 'legend-item');\n\n\t\t\titem\n\t\t\t\t.append('rect')\n\t\t\t\t.attr('width', 18)\n\t\t\t\t.attr('height', 18)\n\t\t\t\t.attr('transform', 'translate(0, -13)')\n\t\t\t\t.attr('fill', function() {\n\t\t\t\t\tvar d = d3.select(this.parentNode).data()[0];\n\t\t\t\t\treturn colors(d[options.x.key]);\n\t\t\t\t});\n\n\t\t\titem\n\t\t\t\t.append('text')\n\t\t\t\t// .attr('x', '25px')\n\t\t\t\t.attr('y', 0)\n\t\t\t\t.attr('dy', '0')\n\t\t\t\t.attr('dx', '25px')\n\t\t\t\t.html(function() {\n\t\t\t\t\tvar d = d3.select(this.parentNode).data()[0];\n\t\t\t\t\treturn d[options.x.key] + ' (' + percentFormat(d[options.y.key]/total) + ')';\n\t\t\t\t})\n\t\t\t\t.each(function() {\n\t\t\t\t\tif(options.legend.type === 'vertical') {\n\t\t\t\t\t\tsvgHelpers.wrap(this, options.legend.size - 20);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\titems\n\t\t\t\t.exit()\n\t\t\t\t.remove();\n\n\t\t\tvar currentX = 0;\n\t\t\tvar currentY = 0, iy = 0;\n\t\t\tscope.legend\n\t\t\t\t.selectAll('.legend-item')\n\t\t\t\t.attr('transform', function() {\n\t\t\t\t\tvar oldY = Math.max(currentY, 25*iy);\n\t\t\t\t\tvar oldX = currentX;\n\n\t\t\t\t\tvar clientRect =\n\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t//.select('text')\n\t\t\t\t\t\t\t.node()\n\t\t\t\t\t\t\t.getBoundingClientRect();\n\n\t\t\t\t\tif(options.legend.type === 'vertical') {\n\t\t\t\t\t\tcurrentY += clientRect.height + 5;\n\t\t\t\t\t\tiy++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(currentX + clientRect.width > options.containerWidth) {\n\t\t\t\t\t\t\tcurrentX = 0;\n\t\t\t\t\t\t\toldX = 0;\n\t\t\t\t\t\t\tiy++;\n\t\t\t\t\t\t\toldY = Math.max(currentY, 25*iy);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrentX += clientRect.width + 10;\n\t\t\t\t\t}\n\t\t\t\t\treturn 'translate(' + oldX + ', ' + oldY + ')';\n\t\t\t\t});\n\n\t\t\tvar legendNode = scope.legend.node();\n\t\t\tvar svgBBox = scope.svg.node().getBBox();\n\t\t\t//var legendRect = legendNode.getBoundingClientRect();\n\n\t\t\t$log.debug('BBoxes:', svgBBox, legendNode.getBBox());\n\n\t\t\tif(scope.container) {\n\t\t\t\tvar svg = d3.select(scope.svg.node().parentNode);\n\t\t\t\tvar height = svgBBox.height + options.margin.bottom +\n\t\t\t\t\toptions.height/2 + svgBBox.y;\n\n\t\t\t\theight = Math.max(height, options.containerHeight);\n\t\t\t\td3.selectAll(scope.container).style('height', height + 'px');\n\t\t\t\tsvg.attr('height', height);\n\t\t\t}\n\t\t},\n\n\t\twrapLabels: _wrapLabels,\n\n\t\tsetStyles: function(scope, options) {\n\t\t\tscope.svg.selectAll('.' + scope.classPrefix + '-labelName text')\n\t\t\t\t.style('fill', options.axis.color)\n\t\t\t\t.style('font-weight', options.axis.fontWeight);\n\n\t\t\tscope.svg\n\t\t\t\t.style('font-family', options.fontFamily)\n\t\t\t\t.style('font-size', options.fontSize);\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('lineHelpers', function ($log, d3Helpers, svgHelpers) {\n\t/*\n\tvar _idFunction = function(d) {\n\t\treturn d.id;\n\t};\n\t*/\n\n\treturn {\n\t\taddAxis: function(scope, options) {\n\t\t\tsvgHelpers.addXAxis(scope, options);\n\t\t\tsvgHelpers.addYAxis(scope, options);\n\t\t\tsvgHelpers.addSubdivideTicks(scope.yl, scope.y, scope.yAxis, options.y);\n\t\t}\n\t};\n});\n\nangular.module('angular-d3-charts').factory('svgHelpers', function ($log, d3Helpers) {\n\treturn {\n\t\t/**\n\t\t * Add SVG element to DOM.\n\t\t *\n\t\t * @param {Object} scope Chart scope.\n\t\t * @param {Element} container Container from SVG.\n\t\t * @param {Object} options Chart options.\n\t\t *\n\t\t * @returns {SVGElement} SVG Element for Pie.\n\t\t */\n\t\taddSVG: function(scope, container, options) {\n\t\t\tvar w = options.width + options.margin.left + options.margin.right;\n\t\t\tw += (options.legend.show && options.legend.type === 'vertical')?\n\t\t\t\t(options.legend.size + options.legend.gap):0;\n\t\t\tvar h = options.height + options.margin.top + options.margin.bottom + (options.axis.show? 30:0);\n\n\t\t\toptions.containerWidth = w;\n\t\t\toptions.containerHeight = h;\n\t\t\tvar svg = d3.select(container)\n\t\t\t\t.style('width', w + 'px')\n\t\t\t\t.style('height', h + 'px')\n\t\t\t\t.append('svg')\n\t\t\t\t.attr('width', w)\n\t\t\t\t.attr('height', h)\n\t\t\t\t.append('g')\n\t\t\t\t.attr('transform', 'translate(' + options.margin.left + ',' + options.margin.top + ')')\n\t\t\t\t.style('cursor', 'pointer');\n\n\t\t\t// Mask for zoom and pan behavior.\n\t\t\tscope.idClip = 'clip-' + d3Helpers.getRandomString();\n\t\t\tsvg.append('clipPath')\n\t\t\t\t.attr('id', scope.idClip)\n\t\t\t\t.append('rect')\n\t\t\t\t.attr('width', options.width)\n\t\t\t\t.attr('height', options.height);\n\t\t\tscope.svg = svg;\n\t\t\treturn svg;\n\t\t},\n\n\t\t/**\n\t\t * Add Zoom Behaviour to chart.\n\t\t */\n\t\taddZoomBehaviour: function(scope, behavior) {\n\t\t\tif(!d3Helpers.isDefined(scope.x)) {\n\t\t\t\t$log.warn('[Angular - D3] x scale is not defined, unable set zoom behavior');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!d3Helpers.isDefined(scope.y)) {\n\t\t\t\t$log.warn('[Angular - D3] y scale is not defined, unable set zoom behavior');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscope.zoom = d3.zoom()\n\t\t\t\t// .x(scope.x)\n\t\t\t\t// .y(scope.y)\n\t\t\t\t.scaleExtent([0.5, 100])\n\t\t\t\t.on('zoom', behavior);\n\t\t},\n\n\n\t\t/**\n\t\t * Add X Axis to chart.\n\t\t */\n\t\taddXAxis: function(scope, options) {\n\t\t\tscope.xl = scope.svg.append('g')\n\t\t\t\t.attr('class', 'x axis');\n\n\t\t\tscope.xlLeftOffset = 0;\n\t\t\tif(options.axis.show && options.y.position === 'left') {\n\t\t\t\tscope.xlLeftOffset = 30;\n\t\t\t\tif(options.y.orient === 'axisRight') {\n\t\t\t\t\tscope.xlLeftOffset += 10;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(scope.type === 'oneAxisBar') {\n\t\t\t\tscope.xlLeftOffset = 0;\n\t\t\t}\n\n\t\t\tif(!d3Helpers.isDefined(options.x.position) || d3Helpers.isString(options.x.position)) {\n\t\t\t\tswitch(options.x.position) {\n\t\t\t\t\tcase 'top':\n\t\t\t\t\t\tscope.xl.attr('transform', 'translate(' + scope.xlLeftOffset + ', ' + (options.x.orient === 'axisBottom'? 0:20) + ')');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!d3Helpers.isDefined(options.x.position) || !d3Helpers.isString(options.x.position) ||\n\t\t\t\t\t\t\toptions.x.position !== 'bottom') {\n\t\t\t\t\t\t\t$log.warn('[Angular - D3] X Axis position must be a string. Setting default value \"bottom\"');\n\t\t\t\t\t\t\toptions.x.position = 'bottom';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscope.xl.attr('transform', 'translate(' + scope.xlLeftOffset + ', ' +\n\t\t\t\t\t\t\t(options.height + (options.x.orient === 'axisBottom'? 0:20))+ ')');\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if(d3Helpers.isNumber(options.x.position)) {\n\t\t\t\tscope.xl.attr('transform', 'translate(' + scope.xlLeftOffset + ', ' +\n\t\t\t\t\t(options.x.orient === 'axisBottom'? (options.x.position + 20):options.x.position) + ')');\n\t\t\t}\n\n\t\t\tscope.xl.call(scope.xAxis);\n\n\t\t\tif(d3Helpers.isDefined(options.x.label) && options.x.label !== false) {\n\t\t\t\tscope.xl.append('text')\n\t\t\t\t\t.attr('class', 'label')\n\t\t\t\t\t.attr('transform', 'translate(' + (options.width) + ')')\n\t\t\t\t\t.attr('dx', '0.8em')\n\t\t\t\t\t.attr('dy', options.x.orient === 'axisBottom'? '1.35em':0)\n\t\t\t\t\t.style('text-anchor', 'start')\n\t\t\t\t\t.style('font-size', '1.1em')\n\t\t\t\t\t.style('font-weight', 'bold')\n\t\t\t\t\t.text(options.x.label);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Add Y Axis to chart.\n\t\t */\n\t\taddYAxis: function(scope, options) {\n\t\t\tscope.yl = scope.svg.append('g')\n\t\t\t\t.attr('class', 'y axis');\n\n\t\t\tscope.ylTopOffset = 0;\n\t\t\tif(options.axis.show && options.x.position === 'top') {\n\t\t\t\tscope.ylTopOffset = 30;\n\t\t\t}\n\n\t\t\tif(!d3Helpers.isDefined(options.y.position) || d3Helpers.isString(options.y.position)) {\n\t\t\t\tswitch(options.y.position) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tscope.yl.attr('transform', 'translate(' + (options.width + (options.y.orient === 'axisLeft'? 20:0)) + ',' +\n\t\t\t\t\t\t\t\t(scope.ylTopOffset) + ')');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!d3Helpers.isDefined(options.y.position) || !d3Helpers.isString(options.y.position) ||\n\t\t\t\t\t\t\toptions.y.position !== 'left') {\n\t\t\t\t\t\t\t$log.warn('[Angular - D3] Y Axis position must be a string. Setting default value \"left\"');\n\t\t\t\t\t\t\toptions.y.position = 'left';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscope.yl.attr('transform', 'translate(' + (options.y.orient === 'axisLeft'? 20:0) + ',' +\n\t\t\t\t\t\t\t\t(scope.ylTopOffset) + ')');\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if(d3Helpers.isNumber(options.y.position)) {\n\t\t\t\tscope.yl.attr('transform', 'translate(' + (options.y.position - (options.y.orient === 'axisLeft'? 20:0)) + ',' +\n\t\t\t\t\t\t(scope.ylTopOffset) + ')');\n\t\t\t}\n\n\t\t\tscope.yl.call(scope.yAxis);\n\n\t\t\tif(d3Helpers.isDefined(options.y.label) && options.y.label !== false) {\n\t\t\t\tscope.yl.append('text')\n\t\t\t\t\t.attr('class', 'label')\n\t\t\t\t\t.attr('dy', options.y.position === 'right'? 4:(options.x.position === 'top'? 0:'-1em'))\n\t\t\t\t\t.attr('x', options.y.position === 'right'? '1.5em':'1em')\n\t\t\t\t\t.attr('y', options.x.position === 'top'? options.height:0)\n\t\t\t\t\t.style('text-anchor', 'start')\n\t\t\t\t\t.style('font-size', '1.1em')\n\t\t\t\t\t.style('font-weight', 'bold')\n\t\t\t\t\t.text(options.y.label);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Add Subdivide Ticks to chart.\n\t\t */\n\t\taddSubdivideTicks: function(g, scale, axis, options) {\n\t\t\tg.selectAll('.tick.minor')\n\t\t\t\t.classed('minor', false)\n\t\t\t\t.selectAll('text')\n\t\t\t\t.style('display', null)\n\t\t\t\t.style('stroke-width', 0);\n\t\t\tif(options.scale !== 'sqrt' && options.scale !== 'linear') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tg.selectAll('.tick')\n\t\t\t\t.data(scale.ticks(options.ticks), function(d) { return d; })\n\t\t\t\t.exit()\n\t\t\t\t.classed('minor', true)\n\t\t\t\t.selectAll('text')\n\t\t\t\t.style('display', 'none');\n\n\t\t\t/*\n\t\t\tswitch(axis.orient()) {\n\t\t\t\tcase 'left':\n\t\t\t\t\tg.selectAll('.tick.minor line')\n\t\t\t\t\t\t.attr('x2', -4);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bottom':\n\t\t\t\t\tg.selectAll('.tick.minor line')\n\t\t\t\t\t\t.attr('y2', 4);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'top':\n\t\t\t\t\tg.selectAll('.tick.minor line')\n\t\t\t\t\t\t.attr('y2', -4);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'right':\n\t\t\t\t\tg.selectAll('.tick.minor line')\n\t\t\t\t\t\t.attr('x2', 4);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t*/\n\t\t},\n\n\n\t\t/**\n\t\t * Refresh chart CSS styles.\n\t\t */\n\t\tupdateStyles: function(scope, options) {\n\t\t\tvar stroke = scope.type === 'bar'? options.axis.stroke:null;\n\n\t\t\tif(options.axis.show === true) {\n\t\t\t\tscope.svg.selectAll('.axis path')\n\t\t\t\t\t.style('stroke', stroke)\n\t\t\t\t\t.style('fill', 'none')\n\t\t\t\t\t.style('shape-rendering', 'crispEdges');\n\n\t\t\t\tscope.svg.selectAll('.axis .tick line')\n\t\t\t\t\t.style('stroke', stroke)\n\t\t\t\t\t.style('fill', 'none');\n\n\t\t\t\tscope.svg.selectAll('.axis .tick.minor')\n\t\t\t\t\t.style('stroke', stroke)\n\t\t\t\t\t.style('fill', 'none');\n\n\t\t\t\tscope.svg.selectAll('.axis text')\n\t\t\t\t\t.style('fill', options.axis.color)\n\t\t\t\t\t.style('font-weight', options.axis.fontWeight);\n\n\t\t\t\tscope.svg.selectAll('.axis .label')\n\t\t\t\t\t.style('fill', options.axis.label.color)\n\t\t\t\t\t.style('font-weight', options.axis.label.fontWeight);\n\t\t\t} else {\n\t\t\t\tscope.svg.selectAll('.axis')\n\t\t\t\t\t.style('display', 'none');\n\t\t\t}\n\n\t\t\tscope.svg.style('font-family', options.fontFamily);\n\t\t\tscope.svg.style('font-size', options.fontSize);\n\t\t},\n\n\t\t/**\n\t\t * Wrap Text Node on determinate width.\n\t\t *\n\t\t * @param {string} text Text to wrap.\n\t\t * @param {number} width Max width for text element.\n\t\t */\n\t\twrap: function(text, width) {\n\t    text = d3.select(text);\n\t\t\tvar words = text.text().split(/\\s+/).reverse(),\n\t        word,\n\t        line = [],\n\t        lineNumber = 0,\n\t        lineHeight = 1.1, // ems\n\t        y = text.attr('y'),\n\t        dy = parseFloat(text.attr('dy')),\n\t        dx = text.attr('dx');\n\n\t\t\tvar tspan =\n\t\t\t\ttext.text(null)\n\t\t\t\t\t.append('tspan')\n\t\t\t\t\t.attr('x', 0)\n\t\t\t\t\t.attr('y', y)\n\t\t\t\t\t.attr('dx', dx)\n\t\t\t\t\t.attr('dy', dy + 'em');\n\t    while(word = words.pop()) {\n\t      line.push(word);\n\t      tspan.text(line.join(' '));\n\t      if(tspan.node().getComputedTextLength() > width) {\n\t        line.pop();\n\t        tspan.text(line.join(' '));\n\t        line = [word];\n\t        tspan =\n\t\t\t\t\t\ttext.append('tspan')\n\t\t\t\t\t\t\t.attr('x', 0)\n\t\t\t\t\t\t\t.attr('y', y)\n\t\t\t\t\t\t\t.attr('dx', dx)\n\t\t\t\t\t\t\t.attr('dy', ++lineNumber * lineHeight + dy + 'em')\n\t\t\t\t\t\t\t.text(word);\n\t      }\n\t    }\n\t\t},\n\n\t\t/**\n\t\t * Get translation from an transform string.\n\t\t *\n\t\t * @param {string} transform Transform string.\n\t\t */\n\t\tgetTranslation: function(transform) {\n\t\t\t// Create a dummy g for calculation purposes only. This will never\n\t\t\t// be appended to the DOM and will be discarded once this function\n\t\t\t// returns.\n\t\t\tvar g = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n\n\t\t\t// Set the transform attribute to the provided string value.\n\t\t\tg.setAttributeNS(null, 'transform', transform);\n\n\t\t\t// consolidate the SVGTransformList containing all transformations\n\t\t\t// to a single SVGTransform of type SVG_TRANSFORM_MATRIX and get\n\t\t\t// its SVGMatrix.\n\t\t\tvar matrix = g.transform.baseVal.consolidate().matrix;\n\n\t\t\t// As per definition values e and f are the ones for the translation.\n\t\t\treturn [matrix.e, matrix.f];\n\t\t}\n\t};\n});\n\n}());\n//# sourceMappingURL=angular-d3-charts.js.map"]}